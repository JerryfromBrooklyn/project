import{j as o,m as he,X as wt,i as ct,V as Ba,k as $a,h as Vi,g as qi,l as Wa,A as Ye,n as Ie,B as Hi,U as Qe,o as Vt,p as Lt,G as Va,q as qa,S as Zi,F as Gi,r as Ki,f as qt,s as Ha,P as Za,D as Yi,t as Xi,u as Ht,c as Qi,v as Ga,w as Ji,x as Ka,y as Ya,z as Xa,H as Qa,b as Ja,J as es,K as ts,d as ea,I as ta,N as ns,O as na,a as tn,Q as is,R as as,W as ia,Y as ss,e as rs,_ as os}from"./ui-vendor-ClOqhC3C.js";import{e as aa,r,c as ls,d as Ne,a as et}from"./react-vendor-BLRlc2I9.js";import{s as se,u as Tt,c as me}from"./index-DN6WN8mT.js";import{R as cs,S as ps,L as sa,D as ra,C as Zt,I as gn,a as ds,b as Et,_ as Be,v as us}from"./aws-vendor-Bw-_yv59.js";var oa={exports:{}};(function(t,e){(function(i,a){t.exports=a(r)})(ls,function(n){return function(i){var a={};function s(l){if(a[l])return a[l].exports;var c=a[l]={i:l,l:!1,exports:{}};return i[l].call(c.exports,c,c.exports,s),c.l=!0,c.exports}return s.m=i,s.c=a,s.d=function(l,c,p){s.o(l,c)||Object.defineProperty(l,c,{enumerable:!0,get:p})},s.r=function(l){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},s.t=function(l,c){if(c&1&&(l=s(l)),c&8||c&4&&typeof l=="object"&&l&&l.__esModule)return l;var p=Object.create(null);if(s.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:l}),c&2&&typeof l!="string")for(var f in l)s.d(p,f,function(m){return l[m]}.bind(null,f));return p},s.n=function(l){var c=l&&l.__esModule?function(){return l.default}:function(){return l};return s.d(c,"a",c),c},s.o=function(l,c){return Object.prototype.hasOwnProperty.call(l,c)},s.p="",s(s.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(i,a,s){s.r(a);var l=s("react"),c=function(){var u=function(h,d){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,y){g.__proto__=y}||function(g,y){for(var E in y)y.hasOwnProperty(E)&&(g[E]=y[E])},u(h,d)};return function(h,d){u(h,d);function g(){this.constructor=h}h.prototype=d===null?Object.create(d):(g.prototype=d.prototype,new g)}}(),p=function(){return p=Object.assign||function(u){for(var h,d=1,g=arguments.length;d<g;d++){h=arguments[d];for(var y in h)Object.prototype.hasOwnProperty.call(h,y)&&(u[y]=h[y])}return u},p.apply(this,arguments)},f=function(u,h){var d={};for(var g in u)Object.prototype.hasOwnProperty.call(u,g)&&h.indexOf(g)<0&&(d[g]=u[g]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,g=Object.getOwnPropertySymbols(u);y<g.length;y++)h.indexOf(g[y])<0&&Object.prototype.propertyIsEnumerable.call(u,g[y])&&(d[g[y]]=u[g[y]]);return d};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(h){var d=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return d?new Promise(function(g,y){d.call(navigator,h,g,y)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function m(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var x=function(u){c(h,u);function h(d){var g=u.call(this,d)||this;return g.canvas=null,g.ctx=null,g.requestUserMediaId=0,g.unmounted=!1,g.state={hasUserMedia:!1},g}return h.prototype.componentDidMount=function(){var d=this,g=d.state,y=d.props;if(this.unmounted=!1,!m()){y.onUserMediaError("getUserMedia not supported");return}g.hasUserMedia||this.requestUserMedia(),y.children&&typeof y.children!="function"&&console.warn("children must be a function")},h.prototype.componentDidUpdate=function(d){var g=this.props;if(!m()){g.onUserMediaError("getUserMedia not supported");return}var y=JSON.stringify(d.audioConstraints)!==JSON.stringify(g.audioConstraints),E=JSON.stringify(d.videoConstraints)!==JSON.stringify(g.videoConstraints),j=d.minScreenshotWidth!==g.minScreenshotWidth,O=d.minScreenshotHeight!==g.minScreenshotHeight;(E||j||O)&&(this.canvas=null,this.ctx=null),(y||E)&&(this.stopAndCleanup(),this.requestUserMedia())},h.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},h.stopMediaStream=function(d){d&&(d.getVideoTracks&&d.getAudioTracks?(d.getVideoTracks().map(function(g){d.removeTrack(g),g.stop()}),d.getAudioTracks().map(function(g){d.removeTrack(g),g.stop()})):d.stop())},h.prototype.stopAndCleanup=function(){var d=this.state;d.hasUserMedia&&(h.stopMediaStream(this.stream),d.src&&window.URL.revokeObjectURL(d.src))},h.prototype.getScreenshot=function(d){var g=this,y=g.state,E=g.props;if(!y.hasUserMedia)return null;var j=this.getCanvas(d);return j&&j.toDataURL(E.screenshotFormat,E.screenshotQuality)},h.prototype.getCanvas=function(d){var g=this,y=g.state,E=g.props;if(!this.video||!y.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var j=this.video.videoWidth,O=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var v=j/O;j=E.minScreenshotWidth||this.video.clientWidth,O=j/v,E.minScreenshotHeight&&O<E.minScreenshotHeight&&(O=E.minScreenshotHeight,j=O*v)}this.canvas=document.createElement("canvas"),this.canvas.width=d?.width||j,this.canvas.height=d?.height||O,this.ctx=this.canvas.getContext("2d")}var b=this,L=b.ctx,k=b.canvas;return L&&k&&(k.width=d?.width||k.width,k.height=d?.height||k.height,E.mirrored&&(L.translate(k.width,0),L.scale(-1,1)),L.imageSmoothingEnabled=E.imageSmoothing,L.drawImage(this.video,0,0,d?.width||k.width,d?.height||k.height),E.mirrored&&(L.scale(-1,1),L.translate(-k.width,0))),k},h.prototype.requestUserMedia=function(){var d=this,g=this.props,y=function(O,v){var b={video:typeof v<"u"?v:!0};g.audio&&(b.audio=typeof O<"u"?O:!0),d.requestUserMediaId++;var L=d.requestUserMediaId;navigator.mediaDevices.getUserMedia(b).then(function(k){d.unmounted||L!==d.requestUserMediaId?h.stopMediaStream(k):d.handleUserMedia(null,k)}).catch(function(k){d.handleUserMedia(k)})};if("mediaDevices"in navigator)y(g.audioConstraints,g.videoConstraints);else{var E=function(O){return{optional:[{sourceId:O}]}},j=function(O){var v=O.deviceId;return typeof v=="string"?v:Array.isArray(v)&&v.length>0?v[0]:typeof v=="object"&&v.ideal?v.ideal:null};MediaStreamTrack.getSources(function(O){var v=null,b=null;O.forEach(function(D){D.kind==="audio"?v=D.id:D.kind==="video"&&(b=D.id)});var L=j(g.audioConstraints);L&&(v=L);var k=j(g.videoConstraints);k&&(b=k),y(E(v),E(b))})}},h.prototype.handleUserMedia=function(d,g){var y=this.props;if(d||!g){this.setState({hasUserMedia:!1}),y.onUserMediaError(d);return}this.stream=g;try{this.video&&(this.video.srcObject=g),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(g)})}y.onUserMedia(g)},h.prototype.render=function(){var d=this,g=this,y=g.state,E=g.props,j=E.audio;E.forceScreenshotSourceSize;var O=E.disablePictureInPicture;E.onUserMedia,E.onUserMediaError,E.screenshotFormat,E.screenshotQuality,E.minScreenshotWidth,E.minScreenshotHeight,E.audioConstraints,E.videoConstraints,E.imageSmoothing;var v=E.mirrored,b=E.style,L=b===void 0?{}:b,k=E.children,D=f(E,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),w=v?p(p({},L),{transform:(L.transform||"")+" scaleX(-1)"}):L,P={getScreenshot:this.getScreenshot.bind(this)};return l.createElement(l.Fragment,null,l.createElement("video",p({autoPlay:!0,disablePictureInPicture:O,src:y.src,muted:!j,playsInline:!0,ref:function(_){d.video=_},style:w},D)),k&&k(P))},h.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},h}(l.Component);a.default=x},react:function(i,a){i.exports=n}}).default})})(oa);var ms=oa.exports;const fs=aa(ms),la="us-east-1",ca="AKIA3ISBVSQ26AGWN3OT",pa="prsXgZ1WkI8dRgyTV4GymfyUiBQUifPbzXa13VOg",ot=80,bt="shmong-faces";new ps({region:la,credentials:{accessKeyId:ca,secretAccessKey:pa}});const ge=new cs({region:la,credentials:{accessKeyId:ca,secretAccessKey:pa}}),gs=async()=>{try{if(console.log("Checking for existing face collection..."),(await ge.send(new sa({}))).CollectionIds?.includes(bt))console.log("Face collection already exists");else{try{console.log("Attempting to delete existing collection if present..."),await ge.send(new ra({CollectionId:bt})),console.log("Existing collection deleted successfully")}catch{console.log("No existing collection found to delete")}console.log("Creating new face collection..."),await ge.send(new Zt({CollectionId:bt,Tags:{Environment:"production",Application:"shmong"}})),console.log("Face collection created successfully")}return!0}catch(t){throw console.error("Error initializing face collection:",t),t}};gs().catch(console.error);class Q{static async indexFace(e,n){try{console.group("Face Indexing Process"),console.log("üîç Starting face indexing..."),console.log("Step 1: Detecting faces in image...");const i=await this.detectFacesWithRetry(e);if(!i||i.length===0)return console.warn("‚ùå No faces detected in image"),console.groupEnd(),{success:!1,error:"No faces detected in image"};if(i.length>1)return console.warn("‚ùå Multiple faces detected in image"),console.groupEnd(),{success:!1,error:"Only one face can be registered at a time"};console.log("Step 2: Indexing face...");const a=new gn({CollectionId:this.COLLECTION_ID,Image:{Bytes:e},ExternalImageId:n,DetectionAttributes:["ALL"],MaxFaces:1,QualityFilter:"AUTO"}),s=await ge.send(a);if(!s.FaceRecords||s.FaceRecords.length===0)return console.warn("‚ùå No faces indexed"),console.groupEnd(),{success:!1,error:"Failed to index face"};const l=s.FaceRecords[0];return console.log("‚úÖ Face indexed successfully:",l.Face?.FaceId),console.log("Face attributes:",l.FaceDetail),this.addBackgroundTask({type:"PHOTO_MATCHING",userId:n,data:{faceId:l.Face?.FaceId}}),console.groupEnd(),{success:!0,faceId:l.Face?.FaceId,attributes:l.FaceDetail}}catch(i){return console.error("‚ùå Error indexing face:",i),console.groupEnd(),{success:!1,error:i.message||"Failed to index face"}}}static async startBackgroundProcessing(){setInterval(async()=>{!Q.isProcessing&&Q.backgroundTasks.length>0&&await Q.processBackgroundTasks()},Q.BACKGROUND_INTERVAL)}static async processBackgroundTasks(){if(Q.backgroundTasks.length!==0){Q.isProcessing=!0,console.log("Processing background tasks:",Q.backgroundTasks.length);try{const e=Q.backgroundTasks[0];switch(e.status="processing",e.updatedAt=new Date,e.type){case"FACE_REGISTRATION":await this.processFaceRegistration(e);break;case"PHOTO_MATCHING":await this.processPhotoMatching(e);break}Q.backgroundTasks.shift()}catch(e){console.error("Error processing background task:",e)}finally{Q.isProcessing=!1}}}static async processFaceRegistration(e){console.group("Processing Face Registration");try{const{imageBytes:n,userId:i}=e.data,a=new gn({CollectionId:Q.COLLECTION_ID,Image:{Bytes:n},ExternalImageId:i,DetectionAttributes:["ALL"],MaxFaces:1,QualityFilter:"AUTO"}),s=await ge.send(a);if(!s.FaceRecords?.length)throw new Error("Failed to add face to collection");this.addBackgroundTask({type:"PHOTO_MATCHING",userId:i,data:{faceId:s.FaceRecords[0].Face?.FaceId}}),e.status="completed"}catch(n){e.status="failed",e.error=n.message,console.error("Face registration failed:",n)}finally{console.groupEnd()}}static async processPhotoMatching(e){console.group("Processing Photo Matching");try{const{data:n}=await se.from("photos").select("*");if(!n?.length){console.log("No photos found to process"),e.status="completed";return}console.log(`Processing ${n.length} photos for face matches`);for(let i=0;i<n.length;i+=Q.BATCH_SIZE){const a=n.slice(i,i+Q.BATCH_SIZE);await Promise.all(a.map(async s=>{try{const{data:l}=await se.storage.from("photos").download(s.storage_path);if(!l)return;const c=await this.searchFaces(new Uint8Array(await l.arrayBuffer()));if(c.length>0){const p=s.matched_users||[],f=c.filter(x=>!p.some(u=>u.userId===x.userId)).map(x=>({userId:x.userId,confidence:x.confidence})),m=[...p,...f];await se.from("photos").update({matched_users:m}).eq("id",s.id),console.log(`Updated matches for photo ${s.id}:`,{existing:p.length,new:f.length,total:m.length})}}catch(l){console.error(`Error processing photo ${s.id}:`,l)}}))}e.status="completed"}catch(n){e.status="failed",e.error=n.message,console.error("Photo matching failed:",n)}finally{console.groupEnd()}}static addBackgroundTask(e){const n={id:crypto.randomUUID(),type:e.type,userId:e.userId,data:e.data||{},status:"pending",createdAt:new Date,updatedAt:new Date};Q.backgroundTasks.push(n),console.log("Added background task:",n.type)}static createCacheKey(e){return Array.from(e.slice(0,1e3)).reduce((n,i)=>n+i,0).toString(36)}static async searchFaces(e){try{console.group("Face Search Process"),console.log("üîç Starting face search process...");const n=await this.detectFacesWithRetry(e);if(!n||n.length===0)return console.warn("‚ùå No faces detected in image during search"),console.groupEnd(),[];console.log(`‚úÖ Detected ${n.length} faces in image`),console.log("Face details:",n);const i=this.createCacheKey(e);console.log("Generated cache key:",i);const a=Q.matchCache.get(i);if(a&&Date.now()-a.timestamp<Q.CACHE_TTL)return console.log("üîÑ Returning cached face matches:",a.result),console.groupEnd(),a.result;console.log("Step 2: Searching for face matches in collection...");const s=new ds({CollectionId:Q.COLLECTION_ID,Image:{Bytes:e},MaxFaces:5,FaceMatchThreshold:ot,QualityFilter:"NONE"}),l=await ge.send(s);if(!l.FaceMatches?.length)return console.warn("‚ùå No face matches found in collection"),console.groupEnd(),[];console.log(`‚úÖ Found ${l.FaceMatches.length} potential matches`),console.log("Raw matches:",l.FaceMatches),console.log("Step 3: Processing matches...");const c=l.FaceMatches.map(p=>{const f={userId:p.Face?.ExternalImageId||"",confidence:p.Similarity||0,faceId:p.Face?.FaceId||""};return console.log(`Match processed: User ${f.userId} with ${f.confidence.toFixed(2)}% confidence`),f}).filter(p=>{const f=p.confidence>=ot;return f||console.log(`Match filtered out: ${p.confidence.toFixed(2)}% < ${ot}% threshold`),f});return console.log(`‚úÖ Final results: ${c.length} valid matches above ${ot}% threshold`),console.log("Processed results:",c),Q.matchCache.set(i,{result:c,timestamp:Date.now()}),console.log("Cache updated with new results"),console.groupEnd(),c}catch(n){return console.error("‚ùå Error during face search:",n),console.groupEnd(),[]}}static async detectFacesWithRetry(e){let n=0,i;for(;n<Q.MAX_RETRIES;)try{console.log(`Attempt ${n+1} to detect faces...`);const a=new Et({Image:{Bytes:e},Attributes:["ALL"]}),s=await ge.send(a);return!s.FaceDetails||s.FaceDetails.length===0?(console.log("No faces detected in image"),[]):(console.log(`Successfully detected ${s.FaceDetails.length} faces`),s.FaceDetails)}catch(a){if(console.error(`Face detection attempt ${n+1} failed:`,a),i=a,n++,n<Q.MAX_RETRIES){const s=Q.RETRY_DELAY*n;console.log(`Waiting ${s}ms before retry...`),await new Promise(l=>setTimeout(l,s))}}throw i||new Error("Failed to detect faces after all retries")}static async initialize(){try{return console.group("Face Collection Initialization"),console.log("üîÑ Initializing face collection..."),(await ge.send(new sa({}))).CollectionIds?.includes(Q.COLLECTION_ID)?console.log("‚úÖ Face collection already exists"):(console.log("Creating new face collection..."),await ge.send(new Zt({CollectionId:Q.COLLECTION_ID,Tags:{Environment:"production",Application:"shmong"}})),console.log("‚úÖ Face collection created successfully")),console.groupEnd(),!0}catch(e){return console.error("‚ùå Error initializing face collection:",e),console.groupEnd(),!1}}static async resetCollection(){try{console.group("Face Collection Reset"),console.log("üîÑ Resetting face collection...");try{console.log("Deleting existing collection..."),await ge.send(new ra({CollectionId:Q.COLLECTION_ID})),console.log("‚úÖ Existing collection deleted")}catch{console.log("No existing collection to delete")}return console.log("Creating new collection..."),await ge.send(new Zt({CollectionId:Q.COLLECTION_ID,Tags:{Environment:"production",Application:"shmong"}})),console.log("‚úÖ New collection created"),console.log("‚úÖ Collection reset complete"),console.groupEnd(),!0}catch(e){return console.error("‚ùå Error resetting collection:",e),console.groupEnd(),!1}}}Object.defineProperty(Q,"COLLECTION_ID",{enumerable:!0,configurable:!0,writable:!0,value:bt});Object.defineProperty(Q,"MAX_RETRIES",{enumerable:!0,configurable:!0,writable:!0,value:1});Object.defineProperty(Q,"RETRY_DELAY",{enumerable:!0,configurable:!0,writable:!0,value:2e3});Object.defineProperty(Q,"BATCH_SIZE",{enumerable:!0,configurable:!0,writable:!0,value:20});Object.defineProperty(Q,"CACHE_TTL",{enumerable:!0,configurable:!0,writable:!0,value:30*60*1e3});Object.defineProperty(Q,"BACKGROUND_INTERVAL",{enumerable:!0,configurable:!0,writable:!0,value:1e4});Object.defineProperty(Q,"matchCache",{enumerable:!0,configurable:!0,writable:!0,value:new Map});Object.defineProperty(Q,"backgroundTasks",{enumerable:!0,configurable:!0,writable:!0,value:[]});Object.defineProperty(Q,"isProcessing",{enumerable:!0,configurable:!0,writable:!0,value:!1});Q.startBackgroundProcessing();Q.initialize().catch(console.error);const hs=({onSuccess:t,onClose:e})=>{const n=r.useRef(null),[i,a]=r.useState(!1),[s,l]=r.useState(null),[c,p]=r.useState(null),[f,m]=r.useState([]),[x,u]=r.useState(""),[h,d]=r.useState(!1),[g,y]=r.useState(!1),{user:E}=Tt();r.useEffect(()=>{(async()=>{try{console.log("Getting video devices...");const D=(await navigator.mediaDevices.enumerateDevices()).filter(w=>w.kind==="videoinput");console.log("Found video devices:",D),m(D),D.length>0&&u(D[0].deviceId)}catch(k){console.error("Error getting video devices:",k),l("Unable to access camera devices")}})()},[]),r.useEffect(()=>{if(!c&&n.current&&n.current.video){const k=setInterval(async()=>{y(!0);try{const D=n.current?.video;if(!D)return;const w=document.createElement("canvas");w.width=D.videoWidth||640,w.height=D.videoHeight||480;const P=w.getContext("2d");if(!P)return;P.drawImage(D,0,0);const _=await new Promise(X=>{try{w.toBlob(X,"image/jpeg",.9)}catch(q){console.error("Error creating blob:",q),X(null)}});if(!_){console.error("Failed to create blob from canvas");return}const N=await _.arrayBuffer(),V=new Uint8Array(N);console.log("Detecting faces in webcam frame...");const A=new Et({Image:{Bytes:V},Attributes:["ALL"]}),z=await ge.send(A),Z=!!(z.FaceDetails&&z.FaceDetails.length>0);console.log("Face detection result:",Z?"Face detected":"No face detected"),d(Z)}catch(D){console.error("Error checking for face:",D),d(!1)}finally{y(!1)}},1e3);return()=>clearInterval(k)}},[c]);const j=r.useCallback(()=>{if(!h){console.log("No face detected, cannot capture"),l("Please position your face in the frame");return}console.log("Capturing image...");const L=n.current?.getScreenshot();L?(console.log("Image captured successfully"),p(L),l(null)):(console.error("Failed to capture image"),l("Failed to capture image"))},[h]),O=()=>{console.log("Retaking photo..."),p(null),l(null),d(!1)},v=L=>{console.log("Changing camera device to:",L.target.value),u(L.target.value),p(null),l(null),d(!1)},b=async()=>{if(!(!c||!E)){a(!0),l(null);try{console.log("Starting face registration process...");const k=await(await fetch(c)).blob(),D=await k.arrayBuffer(),w=new Uint8Array(D);console.log("Detecting face attributes...");const P=new Et({Image:{Bytes:w},Attributes:["ALL"]}),_=await ge.send(P);if(!_.FaceDetails?.length)throw new Error("No face detected in the image");const N=_.FaceDetails[0];console.log("Face attributes detected successfully"),console.log("Uploading image to storage...");const V=`${E.id}/${Date.now()}.jpg`,{error:A}=await se.storage.from("face-data").upload(V,k,{cacheControl:"3600",upsert:!0,contentType:"image/jpeg"});if(A)throw A;console.log("Image uploaded successfully");const{data:{publicUrl:z}}=se.storage.from("face-data").getPublicUrl(V);if(!z)throw new Error("Failed to retrieve public URL");console.log("Saving face data...");const{error:Z}=await se.from("face_data").upsert({user_id:E.id,face_data:{image_path:V,public_url:z,attributes:{age:{low:N.AgeRange?.Low||0,high:N.AgeRange?.High||0},smile:{value:N.Smile?.Value||!1,confidence:N.Smile?.Confidence||0},eyeglasses:{value:N.Eyeglasses?.Value||!1,confidence:N.Eyeglasses?.Confidence||0},sunglasses:{value:N.Sunglasses?.Value||!1,confidence:N.Sunglasses?.Confidence||0},gender:{value:N.Gender?.Value||"",confidence:N.Gender?.Confidence||0},eyesOpen:{value:N.EyesOpen?.Value||!1,confidence:N.EyesOpen?.Confidence||0},mouthOpen:{value:N.MouthOpen?.Value||!1,confidence:N.MouthOpen?.Confidence||0},quality:{brightness:N.Quality?.Brightness||0,sharpness:N.Quality?.Sharpness||0},emotions:N.Emotions?.map(q=>({type:q.Type,confidence:q.Confidence}))||[],landmarks:N.Landmarks,pose:N.Pose,beard:{value:N.Beard?.Value||!1,confidence:N.Beard?.Confidence||0},mustache:{value:N.Mustache?.Value||!1,confidence:N.Mustache?.Confidence||0},overallConfidence:N.Confidence}}});if(Z)throw Z;console.log("Face data saved successfully"),console.log("Indexing face...");const X=await Q.indexFace(w,E.id);if(!X.success)throw new Error(X.error||"Failed to index face");console.log("Face indexed successfully"),console.log("Face registration complete!"),t()}catch(L){console.error("Face registration error:",L),l(L.message||"Failed to register face")}finally{a(!1)}}};return o.jsx(he.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:o.jsx("div",{className:"bg-white rounded-apple-2xl shadow-apple-lg overflow-hidden max-w-lg w-full",children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-semibold text-apple-gray-900",children:"Face Registration"}),o.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-apple-gray-100 text-apple-gray-500",children:o.jsx(wt,{className:"w-5 h-5"})})]}),s&&o.jsxs("div",{className:"mb-6 p-4 bg-red-50 text-red-600 rounded-apple flex items-center",children:[o.jsx(ct,{className:"w-5 h-5 mr-2"}),s]}),f.length>1&&o.jsxs("div",{className:"mb-4",children:[o.jsxs("label",{className:"ios-label flex items-center",children:[o.jsx(Ba,{className:"w-4 h-4 mr-2"}),"Camera"]}),o.jsx("select",{value:x,onChange:v,className:"ios-input",children:f.map(L=>o.jsx("option",{value:L.deviceId,children:L.label||`Camera ${f.indexOf(L)+1}`},L.deviceId))})]}),o.jsx("div",{className:"relative aspect-video overflow-hidden rounded-apple-xl bg-black mb-6",children:c?o.jsx("img",{src:c,alt:"Captured face",className:"w-full h-full object-cover"}):o.jsxs(o.Fragment,{children:[o.jsx(fs,{ref:n,screenshotFormat:"image/jpeg",className:"w-full h-full object-cover",videoConstraints:{width:1280,height:720,deviceId:x,facingMode:"user"}}),o.jsx("div",{className:me("absolute inset-0 border-4 transition-colors duration-300",h?"border-apple-green-500":"border-white/20")}),!g&&!h&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/25",children:o.jsxs("div",{className:"text-white text-center",children:[o.jsx(ct,{className:"w-8 h-8 mx-auto mb-2"}),o.jsx("p",{children:"No face detected"})]})})]})}),o.jsx("div",{className:"flex gap-3",children:c?o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:O,className:"ios-button-secondary flex items-center",children:[o.jsx($a,{className:"w-5 h-5 mr-2"}),"Retake"]}),o.jsx("button",{onClick:b,disabled:i,className:me("ios-button-primary flex-1",i&&"opacity-50 cursor-not-allowed"),children:i?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),"Registering..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Vi,{className:"w-5 h-5 mr-2"}),"Confirm & Register"]})})]}):o.jsxs("button",{onClick:j,disabled:!h,className:me("ios-button-primary flex-1",!h&&"opacity-50 cursor-not-allowed"),children:[o.jsx(qi,{className:"w-5 h-5 mr-2"}),h?"Capture Photo":"Position Your Face"]})})]})})})};var da={exports:{}},vs="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",xs=vs,ys=xs;function ua(){}function ma(){}ma.resetWarningCache=ua;var bs=function(){function t(i,a,s,l,c,p){if(p!==ys){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:ma,resetWarningCache:ua};return n.PropTypes=n,n};da.exports=bs();var ws=da.exports;const le=aa(ws),Ls=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function Je(t,e,n){const i=Es(t),{webkitRelativePath:a}=t,s=typeof e=="string"?e:typeof a=="string"&&a.length>0?a:`./${t.name}`;return typeof i.path!="string"&&hn(i,"path",s),hn(i,"relativePath",s),i}function Es(t){const{name:e}=t;if(e&&e.lastIndexOf(".")!==-1&&!t.type){const i=e.split(".").pop().toLowerCase(),a=Ls.get(i);a&&Object.defineProperty(t,"type",{value:a,writable:!1,configurable:!1,enumerable:!0})}return t}function hn(t,e,n){Object.defineProperty(t,e,{value:n,writable:!1,configurable:!1,enumerable:!0})}const Cs=[".DS_Store","Thumbs.db"];function js(t){return Be(this,void 0,void 0,function*(){return Ct(t)&&ks(t.dataTransfer)?Ps(t.dataTransfer,t.type):Ms(t)?Ss(t):Array.isArray(t)&&t.every(e=>"getFile"in e&&typeof e.getFile=="function")?Os(t):[]})}function ks(t){return Ct(t)}function Ms(t){return Ct(t)&&Ct(t.target)}function Ct(t){return typeof t=="object"&&t!==null}function Ss(t){return Gt(t.target.files).map(e=>Je(e))}function Os(t){return Be(this,void 0,void 0,function*(){return(yield Promise.all(t.map(n=>n.getFile()))).map(n=>Je(n))})}function Ps(t,e){return Be(this,void 0,void 0,function*(){if(t.items){const n=Gt(t.items).filter(a=>a.kind==="file");if(e!=="drop")return n;const i=yield Promise.all(n.map(Ds));return vn(fa(i))}return vn(Gt(t.files).map(n=>Je(n)))})}function vn(t){return t.filter(e=>Cs.indexOf(e.name)===-1)}function Gt(t){if(t===null)return[];const e=[];for(let n=0;n<t.length;n++){const i=t[n];e.push(i)}return e}function Ds(t){if(typeof t.webkitGetAsEntry!="function")return xn(t);const e=t.webkitGetAsEntry();return e&&e.isDirectory?ga(e):xn(t,e)}function fa(t){return t.reduce((e,n)=>[...e,...Array.isArray(n)?fa(n):[n]],[])}function xn(t,e){return Be(this,void 0,void 0,function*(){var n;if(globalThis.isSecureContext&&typeof t.getAsFileSystemHandle=="function"){const s=yield t.getAsFileSystemHandle();if(s===null)throw new Error(`${t} is not a File`);if(s!==void 0){const l=yield s.getFile();return l.handle=s,Je(l)}}const i=t.getAsFile();if(!i)throw new Error(`${t} is not a File`);return Je(i,(n=e?.fullPath)!==null&&n!==void 0?n:void 0)})}function Ns(t){return Be(this,void 0,void 0,function*(){return t.isDirectory?ga(t):_s(t)})}function ga(t){const e=t.createReader();return new Promise((n,i)=>{const a=[];function s(){e.readEntries(l=>Be(this,void 0,void 0,function*(){if(l.length){const c=Promise.all(l.map(Ns));a.push(c),s()}else try{const c=yield Promise.all(a);n(c)}catch(c){i(c)}}),l=>{i(l)})}s()})}function _s(t){return Be(this,void 0,void 0,function*(){return new Promise((e,n)=>{t.file(i=>{const a=Je(i,t.fullPath);e(a)},i=>{n(i)})})})}var At=function(t,e){if(t&&e){var n=Array.isArray(e)?e:e.split(",");if(n.length===0)return!0;var i=t.name||"",a=(t.type||"").toLowerCase(),s=a.replace(/\/.*$/,"");return n.some(function(l){var c=l.trim().toLowerCase();return c.charAt(0)==="."?i.toLowerCase().endsWith(c):c.endsWith("/*")?s===c.replace(/\/.*$/,""):a===c})}return!0};function yn(t){return Ts(t)||Rs(t)||va(t)||Is()}function Is(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rs(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ts(t){if(Array.isArray(t))return Kt(t)}function bn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function wn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?bn(Object(n),!0).forEach(function(i){ha(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function ha(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pt(t,e){return Fs(t)||zs(t,e)||va(t,e)||As()}function As(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function va(t,e){if(t){if(typeof t=="string")return Kt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kt(t,e)}}function Kt(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function zs(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],a=!0,s=!1,l,c;try{for(n=n.call(t);!(a=(l=n.next()).done)&&(i.push(l.value),!(e&&i.length===e));a=!0);}catch(p){s=!0,c=p}finally{try{!a&&n.return!=null&&n.return()}finally{if(s)throw c}}return i}}function Fs(t){if(Array.isArray(t))return t}var Us=typeof At=="function"?At:At.default,Bs="file-invalid-type",$s="file-too-large",Ws="file-too-small",Vs="too-many-files",qs=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=e.split(","),i=n.length>1?"one of ".concat(n.join(", ")):n[0];return{code:Bs,message:"File type must be ".concat(i)}},Ln=function(e){return{code:$s,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},En=function(e){return{code:Ws,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},Hs={code:Vs,message:"Too many files"};function xa(t,e){var n=t.type==="application/x-moz-file"||Us(t,e);return[n,n?null:qs(e)]}function ya(t,e,n){if(Fe(t.size))if(Fe(e)&&Fe(n)){if(t.size>n)return[!1,Ln(n)];if(t.size<e)return[!1,En(e)]}else{if(Fe(e)&&t.size<e)return[!1,En(e)];if(Fe(n)&&t.size>n)return[!1,Ln(n)]}return[!0,null]}function Fe(t){return t!=null}function Zs(t){var e=t.files,n=t.accept,i=t.minSize,a=t.maxSize,s=t.multiple,l=t.maxFiles,c=t.validator;return!s&&e.length>1||s&&l>=1&&e.length>l?!1:e.every(function(p){var f=xa(p,n),m=pt(f,1),x=m[0],u=ya(p,i,a),h=pt(u,1),d=h[0],g=c?c(p):null;return x&&d&&!g})}function jt(t){return typeof t.isPropagationStopped=="function"?t.isPropagationStopped():typeof t.cancelBubble<"u"?t.cancelBubble:!1}function vt(t){return t.dataTransfer?Array.prototype.some.call(t.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!t.target&&!!t.target.files}function Cn(t){t.preventDefault()}function Gs(t){return t.indexOf("MSIE")!==-1||t.indexOf("Trident/")!==-1}function Ks(t){return t.indexOf("Edge/")!==-1}function Ys(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return Gs(t)||Ks(t)}function Le(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(i){for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];return e.some(function(c){return!jt(i)&&c&&c.apply(void 0,[i].concat(s)),jt(i)})}}function Xs(){return"showOpenFilePicker"in window}function Qs(t){if(Fe(t)){var e=Object.entries(t).filter(function(n){var i=pt(n,2),a=i[0],s=i[1],l=!0;return ba(a)||(console.warn('Skipped "'.concat(a,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),l=!1),(!Array.isArray(s)||!s.every(wa))&&(console.warn('Skipped "'.concat(a,'" because an invalid file extension was provided.')),l=!1),l}).reduce(function(n,i){var a=pt(i,2),s=a[0],l=a[1];return wn(wn({},n),{},ha({},s,l))},{});return[{description:"Files",accept:e}]}return t}function Js(t){if(Fe(t))return Object.entries(t).reduce(function(e,n){var i=pt(n,2),a=i[0],s=i[1];return[].concat(yn(e),[a],yn(s))},[]).filter(function(e){return ba(e)||wa(e)}).join(",")}function er(t){return t instanceof DOMException&&(t.name==="AbortError"||t.code===t.ABORT_ERR)}function tr(t){return t instanceof DOMException&&(t.name==="SecurityError"||t.code===t.SECURITY_ERR)}function ba(t){return t==="audio/*"||t==="video/*"||t==="image/*"||t==="text/*"||t==="application/*"||/\w+\/[-+.\w]+/g.test(t)}function wa(t){return/^.*\.[\w]+$/.test(t)}var nr=["children"],ir=["open"],ar=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],sr=["refKey","onChange","onClick"];function rr(t){return cr(t)||lr(t)||La(t)||or()}function or(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lr(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function cr(t){if(Array.isArray(t))return Yt(t)}function zt(t,e){return ur(t)||dr(t,e)||La(t,e)||pr()}function pr(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function La(t,e){if(t){if(typeof t=="string")return Yt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yt(t,e)}}function Yt(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function dr(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],a=!0,s=!1,l,c;try{for(n=n.call(t);!(a=(l=n.next()).done)&&(i.push(l.value),!(e&&i.length===e));a=!0);}catch(p){s=!0,c=p}finally{try{!a&&n.return!=null&&n.return()}finally{if(s)throw c}}return i}}function ur(t){if(Array.isArray(t))return t}function jn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function de(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?jn(Object(n),!0).forEach(function(i){Xt(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jn(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Xt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kt(t,e){if(t==null)return{};var n=mr(t,e),i,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)i=s[a],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function mr(t,e){if(t==null)return{};var n={},i=Object.keys(t),a,s;for(s=0;s<i.length;s++)a=i[s],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}var nn=r.forwardRef(function(t,e){var n=t.children,i=kt(t,nr),a=Ca(i),s=a.open,l=kt(a,ir);return r.useImperativeHandle(e,function(){return{open:s}},[s]),Ne.createElement(r.Fragment,null,n(de(de({},l),{},{open:s})))});nn.displayName="Dropzone";var Ea={disabled:!1,getFilesFromEvent:js,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};nn.defaultProps=Ea;nn.propTypes={children:le.func,accept:le.objectOf(le.arrayOf(le.string)),multiple:le.bool,preventDropOnDocument:le.bool,noClick:le.bool,noKeyboard:le.bool,noDrag:le.bool,noDragEventsBubbling:le.bool,minSize:le.number,maxSize:le.number,maxFiles:le.number,disabled:le.bool,getFilesFromEvent:le.func,onFileDialogCancel:le.func,onFileDialogOpen:le.func,useFsAccessApi:le.bool,autoFocus:le.bool,onDragEnter:le.func,onDragLeave:le.func,onDragOver:le.func,onDrop:le.func,onDropAccepted:le.func,onDropRejected:le.func,onError:le.func,validator:le.func};var Qt={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Ca(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=de(de({},Ea),t),n=e.accept,i=e.disabled,a=e.getFilesFromEvent,s=e.maxSize,l=e.minSize,c=e.multiple,p=e.maxFiles,f=e.onDragEnter,m=e.onDragLeave,x=e.onDragOver,u=e.onDrop,h=e.onDropAccepted,d=e.onDropRejected,g=e.onFileDialogCancel,y=e.onFileDialogOpen,E=e.useFsAccessApi,j=e.autoFocus,O=e.preventDropOnDocument,v=e.noClick,b=e.noKeyboard,L=e.noDrag,k=e.noDragEventsBubbling,D=e.onError,w=e.validator,P=r.useMemo(function(){return Js(n)},[n]),_=r.useMemo(function(){return Qs(n)},[n]),N=r.useMemo(function(){return typeof y=="function"?y:kn},[y]),V=r.useMemo(function(){return typeof g=="function"?g:kn},[g]),A=r.useRef(null),z=r.useRef(null),Z=r.useReducer(fr,Qt),X=zt(Z,2),q=X[0],H=X[1],J=q.isFocused,ie=q.isFileDialogActive,ne=r.useRef(typeof window<"u"&&window.isSecureContext&&E&&Xs()),B=function(){!ne.current&&ie&&setTimeout(function(){if(z.current){var W=z.current.files;W.length||(H({type:"closeDialog"}),V())}},300)};r.useEffect(function(){return window.addEventListener("focus",B,!1),function(){window.removeEventListener("focus",B,!1)}},[z,ie,V,ne]);var S=r.useRef([]),C=function(W){A.current&&A.current.contains(W.target)||(W.preventDefault(),S.current=[])};r.useEffect(function(){return O&&(document.addEventListener("dragover",Cn,!1),document.addEventListener("drop",C,!1)),function(){O&&(document.removeEventListener("dragover",Cn),document.removeEventListener("drop",C))}},[A,O]),r.useEffect(function(){return!i&&j&&A.current&&A.current.focus(),function(){}},[A,j,i]);var R=r.useCallback(function(I){D?D(I):console.error(I)},[D]),$=r.useCallback(function(I){I.preventDefault(),I.persist(),Te(I),S.current=[].concat(rr(S.current),[I.target]),vt(I)&&Promise.resolve(a(I)).then(function(W){if(!(jt(I)&&!k)){var ce=W.length,pe=ce>0&&Zs({files:W,accept:P,minSize:l,maxSize:s,multiple:c,maxFiles:p,validator:w}),fe=ce>0&&!pe;H({isDragAccept:pe,isDragReject:fe,isDragActive:!0,type:"setDraggedFiles"}),f&&f(I)}}).catch(function(W){return R(W)})},[a,f,R,k,P,l,s,c,p,w]),F=r.useCallback(function(I){I.preventDefault(),I.persist(),Te(I);var W=vt(I);if(W&&I.dataTransfer)try{I.dataTransfer.dropEffect="copy"}catch{}return W&&x&&x(I),!1},[x,k]),G=r.useCallback(function(I){I.preventDefault(),I.persist(),Te(I);var W=S.current.filter(function(pe){return A.current&&A.current.contains(pe)}),ce=W.indexOf(I.target);ce!==-1&&W.splice(ce,1),S.current=W,!(W.length>0)&&(H({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),vt(I)&&m&&m(I))},[A,m,k]),T=r.useCallback(function(I,W){var ce=[],pe=[];I.forEach(function(fe){var we=xa(fe,P),Ce=zt(we,2),ke=Ce[0],qe=Ce[1],Me=ya(fe,l,s),Ae=zt(Me,2),Se=Ae[0],He=Ae[1],Oe=w?w(fe):null;if(ke&&Se&&!Oe)ce.push(fe);else{var Ze=[qe,He];Oe&&(Ze=Ze.concat(Oe)),pe.push({file:fe,errors:Ze.filter(function(Ge){return Ge})})}}),(!c&&ce.length>1||c&&p>=1&&ce.length>p)&&(ce.forEach(function(fe){pe.push({file:fe,errors:[Hs]})}),ce.splice(0)),H({acceptedFiles:ce,fileRejections:pe,isDragReject:pe.length>0,type:"setFiles"}),u&&u(ce,pe,W),pe.length>0&&d&&d(pe,W),ce.length>0&&h&&h(ce,W)},[H,c,P,l,s,p,u,h,d,w]),U=r.useCallback(function(I){I.preventDefault(),I.persist(),Te(I),S.current=[],vt(I)&&Promise.resolve(a(I)).then(function(W){jt(I)&&!k||T(W,I)}).catch(function(W){return R(W)}),H({type:"reset"})},[a,T,R,k]),re=r.useCallback(function(){if(ne.current){H({type:"openDialog"}),N();var I={multiple:c,types:_};window.showOpenFilePicker(I).then(function(W){return a(W)}).then(function(W){T(W,null),H({type:"closeDialog"})}).catch(function(W){er(W)?(V(W),H({type:"closeDialog"})):tr(W)?(ne.current=!1,z.current?(z.current.value=null,z.current.click()):R(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):R(W)});return}z.current&&(H({type:"openDialog"}),N(),z.current.value=null,z.current.click())},[H,N,V,E,T,R,_,c]),xe=r.useCallback(function(I){!A.current||!A.current.isEqualNode(I.target)||(I.key===" "||I.key==="Enter"||I.keyCode===32||I.keyCode===13)&&(I.preventDefault(),re())},[A,re]),je=r.useCallback(function(){H({type:"focus"})},[]),oe=r.useCallback(function(){H({type:"blur"})},[]),nt=r.useCallback(function(){v||(Ys()?setTimeout(re,0):re())},[v,re]),be=function(W){return i?null:W},$e=function(W){return b?null:be(W)},Ee=function(W){return L?null:be(W)},Te=function(W){k&&W.stopPropagation()},We=r.useMemo(function(){return function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},W=I.refKey,ce=W===void 0?"ref":W,pe=I.role,fe=I.onKeyDown,we=I.onFocus,Ce=I.onBlur,ke=I.onClick,qe=I.onDragEnter,Me=I.onDragOver,Ae=I.onDragLeave,Se=I.onDrop,He=kt(I,ar);return de(de(Xt({onKeyDown:$e(Le(fe,xe)),onFocus:$e(Le(we,je)),onBlur:$e(Le(Ce,oe)),onClick:be(Le(ke,nt)),onDragEnter:Ee(Le(qe,$)),onDragOver:Ee(Le(Me,F)),onDragLeave:Ee(Le(Ae,G)),onDrop:Ee(Le(Se,U)),role:typeof pe=="string"&&pe!==""?pe:"presentation"},ce,A),!i&&!b?{tabIndex:0}:{}),He)}},[A,xe,je,oe,nt,$,F,G,U,b,L,i]),mt=r.useCallback(function(I){I.stopPropagation()},[]),Ve=r.useMemo(function(){return function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},W=I.refKey,ce=W===void 0?"ref":W,pe=I.onChange,fe=I.onClick,we=kt(I,sr),Ce=Xt({accept:P,multiple:c,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:be(Le(pe,U)),onClick:be(Le(fe,mt)),tabIndex:-1},ce,z);return de(de({},Ce),we)}},[z,n,c,U,i]);return de(de({},q),{},{isFocused:J&&!i,getRootProps:We,getInputProps:Ve,rootRef:A,inputRef:z,open:be(re)})}function fr(t,e){switch(e.type){case"focus":return de(de({},t),{},{isFocused:!0});case"blur":return de(de({},t),{},{isFocused:!1});case"openDialog":return de(de({},Qt),{},{isFileDialogActive:!0});case"closeDialog":return de(de({},t),{},{isFileDialogActive:!1});case"setDraggedFiles":return de(de({},t),{},{isDragActive:e.isDragActive,isDragAccept:e.isDragAccept,isDragReject:e.isDragReject});case"setFiles":return de(de({},t),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections,isDragReject:e.isDragReject});case"reset":return de({},Qt);default:return t}}function kn(){}class Re{static async uploadPhoto(e,n,i,a){try{const s=us(),l=e.name.split(".").pop(),c=i?`photos/${i}/${s}.${l}`:`photos/${s}.${l}`,p=(await se.auth.getUser()).data.user?.id;if(!p)throw new Error("User not found");const{data:f,error:m}=await this.getUserStorageUsage(p);if(m)throw m;if(!f)throw new Error("Could not get storage data");if(f.total_size+e.size>f.quota_limit)throw new Error("Storage quota exceeded");let x;for(let w=0;w<this.MAX_RETRIES;w++){try{const{error:P}=await se.storage.from("photos").upload(c,e,{cacheControl:"3600",upsert:!1});if(!P){x=null;break}x=P}catch(P){x=P}w<this.MAX_RETRIES-1&&await new Promise(P=>setTimeout(P,this.RETRY_DELAY*(w+1)))}if(x)throw x;const{data:{publicUrl:u}}=se.storage.from("photos").getPublicUrl(c),h=await e.arrayBuffer(),d=new Uint8Array(h);console.log("Searching for faces in uploaded photo...");const g=await this.detectFaces(d);console.log("Detected faces:",g);const y=g.map(w=>({userId:"",confidence:0,attributes:{age:{low:w.AgeRange?.Low||0,high:w.AgeRange?.High||0},smile:{value:w.Smile?.Value||!1,confidence:w.Smile?.Confidence||0},eyeglasses:{value:w.Eyeglasses?.Value||!1,confidence:w.Eyeglasses?.Confidence||0},sunglasses:{value:w.Sunglasses?.Value||!1,confidence:w.Sunglasses?.Confidence||0},gender:{value:w.Gender?.Value||"",confidence:w.Gender?.Confidence||0},eyesOpen:{value:w.EyesOpen?.Value||!1,confidence:w.EyesOpen?.Confidence||0},mouthOpen:{value:w.MouthOpen?.Value||!1,confidence:w.MouthOpen?.Confidence||0},quality:{brightness:w.Quality?.Brightness||0,sharpness:w.Quality?.Sharpness||0},emotions:w.Emotions?.map(P=>({type:P.Type,confidence:P.Confidence}))||[],landmarks:w.Landmarks,pose:w.Pose,beard:{value:w.Beard?.Value||!1,confidence:w.Beard?.Confidence||0},mustache:{value:w.Mustache?.Value||!1,confidence:w.Mustache?.Confidence||0},overallConfidence:w.Confidence}}));if(y.length===0){console.log("No faces detected in photo");const w={id:s,url:u,eventId:n,uploadedBy:p,created_at:new Date().toISOString(),folderPath:i,folderName:i?.split("/").pop(),fileSize:e.size,fileType:e.type,faces:[],title:a?.title||e.name,description:a?.description,location:a?.location,venue:a?.venue,tags:a?.tags,date_taken:a?.date_taken||new Date().toISOString(),event_details:a?.event_details,matched_users:[]};let P;for(let _=0;_<this.MAX_RETRIES;_++){try{const{error:N}=await se.from("photos").insert({id:s,storage_path:c,public_url:u,event_id:n,folder_path:i,folder_name:i?.split("/").pop(),file_size:e.size,file_type:e.type,uploaded_by:p,title:a?.title||e.name,description:a?.description,location:a?.location,venue:a?.venue,tags:a?.tags,date_taken:a?.date_taken||new Date().toISOString(),event_details:a?.event_details,faces:[],matched_users:[]});if(!N){P=null;break}P=N}catch(N){P=N}_<this.MAX_RETRIES-1&&await new Promise(N=>setTimeout(N,this.RETRY_DELAY*(_+1)))}if(P)throw P;return{success:!0,url:u,photoId:s,photoMetadata:w}}const E=await Q.searchFaces(d);console.log("Face matches:",E);const j=E.filter(w=>w.confidence>=ot);console.log("High confidence matches:",j);const{data:O,error:v}=await se.from("users").select(`
          id,
          full_name,
          avatar_url,
          user_profiles (
            metadata
          )
        `).in("id",j.map(w=>w.userId));if(v)throw v;console.log("Matched users:",O),j.forEach(w=>{const P=y.findIndex(_=>!_.userId);P!==-1&&(y[P].userId=w.userId,y[P].confidence=w.confidence)});const b=j.map(w=>{const P=O?.find(_=>_.id===w.userId);return{userId:w.userId,fullName:P?.full_name||P?.user_profiles?.[0]?.metadata?.full_name||"Unknown User",avatarUrl:P?.avatar_url||P?.user_profiles?.[0]?.metadata?.avatar_url,confidence:w.confidence}});console.log("Final faces array:",y),console.log("Final matched_users array:",b);const L={id:s,url:u,eventId:n,uploadedBy:p,created_at:new Date().toISOString(),folderPath:i,folderName:i?.split("/").pop(),fileSize:e.size,fileType:e.type,faces:y,title:a?.title||e.name,description:a?.description,location:a?.location,venue:a?.venue,tags:a?.tags,date_taken:a?.date_taken||new Date().toISOString(),event_details:a?.event_details,matched_users:b};let k;for(let w=0;w<this.MAX_RETRIES;w++){try{const{error:P}=await se.from("photos").insert({id:s,storage_path:c,public_url:u,event_id:n,folder_path:i,folder_name:i?.split("/").pop(),file_size:e.size,file_type:e.type,uploaded_by:p,title:a?.title||e.name,description:a?.description,location:a?.location,venue:a?.venue,tags:a?.tags,date_taken:a?.date_taken||new Date().toISOString(),event_details:a?.event_details,faces:y,matched_users:b});if(!P){k=null;break}k=P}catch(P){k=P}w<this.MAX_RETRIES-1&&await new Promise(P=>setTimeout(P,this.RETRY_DELAY*(w+1)))}if(k)throw k;const{error:D}=await se.from("user_storage").upsert({user_id:p,total_size:(f.total_size||0)+e.size,updated_at:new Date().toISOString()});if(D)throw D;return{success:!0,url:u,photoId:s,photoMetadata:L}}catch(s){return console.error("Error uploading photo:",s),{success:!1,error:s.message}}}static async updatePhotoMetadata(e,n){try{let i=0,a;for(;i<this.MAX_RETRIES;){try{const{error:s}=await se.from("photos").update({title:n.title,description:n.description,location:n.location,venue:n.venue,tags:n.tags,date_taken:n.date_taken,event_details:n.event_details}).eq("id",e);if(!s)return!0;a=s}catch(s){a=s}i++,i<this.MAX_RETRIES&&await new Promise(s=>setTimeout(s,this.RETRY_DELAY*i))}throw a}catch(i){return console.error("Error updating photo metadata:",i),!1}}static async batchUpdatePhotos(e,n){try{let i=0,a;for(;i<this.MAX_RETRIES;){try{const{error:s}=await se.from("photos").update({location:n.location,venue:n.venue,tags:n.tags,date_taken:n.date_taken,event_details:n.event_details}).in("id",e);if(!s)return!0;a=s}catch(s){a=s}i++,i<this.MAX_RETRIES&&await new Promise(s=>setTimeout(s,this.RETRY_DELAY*i))}throw a}catch(i){return console.error("Error batch updating photos:",i),!1}}static async renameFolder(e,n){try{let i=0,a;for(;i<this.MAX_RETRIES;){try{const{error:s}=await se.from("photos").update({folder_name:n,folder_path:e.split("/").slice(0,-1).concat(n).join("/")}).eq("folder_path",e);if(!s)return!0;a=s}catch(s){a=s}i++,i<this.MAX_RETRIES&&await new Promise(s=>setTimeout(s,this.RETRY_DELAY*i))}throw a}catch(i){return console.error("Error renaming folder:",i),!1}}static async getUserStorageUsage(e){try{const{data:n,error:i}=await se.from("user_storage").select("total_size, quota_limit").eq("user_id",e).maybeSingle();if(!n){const{data:a,error:s}=await se.from("user_storage").upsert([{user_id:e,total_size:0,quota_limit:10737418240}]).select("total_size, quota_limit").single();if(s)throw s;return{data:a}}return{data:n}}catch(n){return console.error("Error getting/creating storage usage:",n),{error:n}}}static async detectFaces(e){try{let n=0,i,a;for(;n<this.MAX_RETRIES;)try{const s=new Et({Image:{Bytes:e},Attributes:["ALL"]});return i=await ge.send(s),i.FaceDetails||[]}catch(s){a=s,n++,n<this.MAX_RETRIES&&await new Promise(l=>setTimeout(l,this.RETRY_DELAY*n))}throw a}catch(n){throw console.error("Error detecting faces:",n),n}}static async getPhotosForEvent(e){try{let n=0,i,a;for(;n<this.MAX_RETRIES;){try{const{data:s,error:l}=await se.from("photos").select(`
              *,
              users (
                id,
                full_name,
                avatar_url,
                user_profiles (
                  metadata
                )
              )
            `).eq("event_id",e).order("created_at",{ascending:!1});if(!l){i=s;break}a=l}catch(s){a=s}n++,n<this.MAX_RETRIES&&await new Promise(s=>setTimeout(s,this.RETRY_DELAY*n))}if(a)throw a;return(i||[]).map(s=>({id:s.id,url:s.public_url,eventId:s.event_id,uploadedBy:s.uploaded_by,created_at:s.created_at,folderPath:s.folder_path,folderName:s.folder_name,fileSize:s.file_size,fileType:s.file_type,faces:s.faces||[],title:s.title,description:s.description,location:s.location,venue:s.venue,tags:s.tags,date_taken:s.date_taken,event_details:s.event_details,matched_users:s.matched_users||[]}))}catch(n){throw console.error("Error fetching event photos:",n),n}}static async getPhotosForUser(e){try{let n=0,i,a;for(;n<this.MAX_RETRIES;){try{const{data:s,error:l}=await se.from("photos").select(`
              *,
              users (
                id,
                full_name,
                avatar_url,
                user_profiles (
                  metadata
                )
              )
            `).or(`uploaded_by.eq.${e},faces->0->>userId.eq.${e}`).order("created_at",{ascending:!1});if(!l){i=s;break}a=l}catch(s){a=s}n++,n<this.MAX_RETRIES&&await new Promise(s=>setTimeout(s,this.RETRY_DELAY*n))}if(a)throw a;return(i||[]).map(s=>({id:s.id,url:s.public_url,eventId:s.event_id,uploadedBy:s.uploaded_by,created_at:s.created_at,folderPath:s.folder_path,folderName:s.folder_name,fileSize:s.file_size,fileType:s.file_type,faces:s.faces||[],title:s.title,description:s.description,location:s.location,venue:s.venue,tags:s.tags,date_taken:s.date_taken,event_details:s.event_details,matched_users:s.matched_users||[]}))}catch(n){throw console.error("Error fetching user photos:",n),n}}static async updatePhotoPermissions(e,n){try{let i=0,a;for(;i<this.MAX_RETRIES;){try{const{error:s}=await se.from("photo_permissions").upsert(n.map(l=>({photo_id:e,user_id:l.userId,access_level:l.access})));if(!s)return;a=s}catch(s){a=s}i++,i<this.MAX_RETRIES&&await new Promise(s=>setTimeout(s,this.RETRY_DELAY*i))}throw a}catch(i){throw console.error("Error updating photo permissions:",i),i}}static async deletePhoto(e){try{const{data:n,error:i}=await se.from("photos").select("storage_path, file_size").eq("id",e).single();if(i)throw i;let a=0,s;for(;a<this.MAX_RETRIES;){try{const{error:l}=await se.storage.from("photos").remove([n.storage_path]);if(!l){s=null;break}s=l}catch(l){s=l}a++,a<this.MAX_RETRIES&&await new Promise(l=>setTimeout(l,this.RETRY_DELAY*a))}if(s)throw s;for(a=0;a<this.MAX_RETRIES;){try{const{error:l}=await se.from("photos").delete().eq("id",e);if(!l)return;s=l}catch(l){s=l}a++,a<this.MAX_RETRIES&&await new Promise(l=>setTimeout(l,this.RETRY_DELAY*a))}throw s}catch(n){throw console.error("Error deleting photo:",n),n}}static async downloadPhoto(e){try{let n=0,i,a;for(;n<this.MAX_RETRIES;){try{const{data:l,error:c}=await se.from("photos").select("storage_path").eq("id",e).single();if(!c){i=l;break}a=c}catch(l){a=l}n++,n<this.MAX_RETRIES&&await new Promise(l=>setTimeout(l,this.RETRY_DELAY*n))}if(a)throw a;n=0;let s;for(;n<this.MAX_RETRIES;){try{const{data:l,error:c}=await se.storage.from("photos").download(i.storage_path);if(!c){s=l;break}a=c}catch(l){a=l}n++,n<this.MAX_RETRIES&&await new Promise(l=>setTimeout(l,this.RETRY_DELAY*n))}if(a)throw a;return URL.createObjectURL(s)}catch(n){throw console.error("Error downloading photo:",n),n}}}Object.defineProperty(Re,"MAX_RETRIES",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(Re,"RETRY_DELAY",{enumerable:!0,configurable:!0,writable:!0,value:1e3});function dt(t){"@babel/helpers - typeof";return dt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dt(t)}function gr(t,e){if(dt(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(dt(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hr(t){var e=gr(t,"string");return dt(e)=="symbol"?e:e+""}function M(t,e,n){return(e=hr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ja(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ft,Mn;function vr(){if(Mn)return Ft;Mn=1;var t=function(n,i,a,s,l,c,p,f){if(!n){var m;if(i===void 0)m=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var x=[a,s,l,c,p,f],u=0;m=new Error(i.replace(/%s/g,function(){return x[u++]})),m.name="Invariant Violation"}throw m.framesToPop=1,m}};return Ft=t,Ft}var xr=vr(),ue=ja(xr),Y=r.createContext(null);function yr(){ue(!!r.useContext,"useGoogleMap is React hook and requires React version 16.8+");var t=r.useContext(Y);return ue(!!t,"useGoogleMap needs a GoogleMap available up in the tree"),t}function br(t,e,n){return Object.keys(t).reduce(function(a,s){return e(a,t[s],s)},n)}function wr(t,e){Object.keys(t).forEach(n=>e(t[n],n))}function Lr(t,e,n,i){var a={},s=(l,c)=>{var p=n[c];p!==e[c]&&(a[c]=p,l(i,p))};return wr(t,s),a}function Er(t,e,n){var i=br(n,function(s,l,c){return typeof t[c]=="function"&&s.push(google.maps.event.addListener(e,l,t[c])),s},[]);return i}function Cr(t){google.maps.event.removeListener(t)}function te(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t.forEach(Cr)}function ee(t){var{updaterMap:e,eventMap:n,prevProps:i,nextProps:a,instance:s}=t,l=Er(a,s,n);return Lr(e,i,a,s),l}var Sn={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},On={extraMapTypes(t,e){e.forEach(function(i,a){t.mapTypes.set(String(a),i)})},center(t,e){t.setCenter(e)},clickableIcons(t,e){t.setClickableIcons(e)},heading(t,e){t.setHeading(e)},mapTypeId(t,e){t.setMapTypeId(e)},options(t,e){t.setOptions(e)},streetView(t,e){t.setStreetView(e)},tilt(t,e){t.setTilt(e)},zoom(t,e){t.setZoom(e)}};function jr(t){var{children:e,options:n,id:i,mapContainerStyle:a,mapContainerClassName:s,center:l,onClick:c,onDblClick:p,onDrag:f,onDragEnd:m,onDragStart:x,onMouseMove:u,onMouseOut:h,onMouseOver:d,onMouseDown:g,onMouseUp:y,onRightClick:E,onCenterChanged:j,onLoad:O,onUnmount:v}=t,[b,L]=r.useState(null),k=r.useRef(null),[D,w]=r.useState(null),[P,_]=r.useState(null),[N,V]=r.useState(null),[A,z]=r.useState(null),[Z,X]=r.useState(null),[q,H]=r.useState(null),[J,ie]=r.useState(null),[ne,B]=r.useState(null),[S,C]=r.useState(null),[R,$]=r.useState(null),[F,G]=r.useState(null),[T,U]=r.useState(null);return r.useEffect(()=>{n&&b!==null&&b.setOptions(n)},[b,n]),r.useEffect(()=>{b!==null&&typeof l<"u"&&b.setCenter(l)},[b,l]),r.useEffect(()=>{b&&p&&(P!==null&&google.maps.event.removeListener(P),_(google.maps.event.addListener(b,"dblclick",p)))},[p]),r.useEffect(()=>{b&&m&&(N!==null&&google.maps.event.removeListener(N),V(google.maps.event.addListener(b,"dragend",m)))},[m]),r.useEffect(()=>{b&&x&&(A!==null&&google.maps.event.removeListener(A),z(google.maps.event.addListener(b,"dragstart",x)))},[x]),r.useEffect(()=>{b&&g&&(Z!==null&&google.maps.event.removeListener(Z),X(google.maps.event.addListener(b,"mousedown",g)))},[g]),r.useEffect(()=>{b&&u&&(q!==null&&google.maps.event.removeListener(q),H(google.maps.event.addListener(b,"mousemove",u)))},[u]),r.useEffect(()=>{b&&h&&(J!==null&&google.maps.event.removeListener(J),ie(google.maps.event.addListener(b,"mouseout",h)))},[h]),r.useEffect(()=>{b&&d&&(ne!==null&&google.maps.event.removeListener(ne),B(google.maps.event.addListener(b,"mouseover",d)))},[d]),r.useEffect(()=>{b&&y&&(S!==null&&google.maps.event.removeListener(S),C(google.maps.event.addListener(b,"mouseup",y)))},[y]),r.useEffect(()=>{b&&E&&(R!==null&&google.maps.event.removeListener(R),$(google.maps.event.addListener(b,"rightclick",E)))},[E]),r.useEffect(()=>{b&&c&&(F!==null&&google.maps.event.removeListener(F),G(google.maps.event.addListener(b,"click",c)))},[c]),r.useEffect(()=>{b&&f&&(T!==null&&google.maps.event.removeListener(T),U(google.maps.event.addListener(b,"drag",f)))},[f]),r.useEffect(()=>{b&&j&&(D!==null&&google.maps.event.removeListener(D),w(google.maps.event.addListener(b,"center_changed",j)))},[c]),r.useEffect(()=>{var re=k.current===null?null:new google.maps.Map(k.current,n);return L(re),re!==null&&O&&O(re),()=>{re!==null&&v&&v(re)}},[]),o.jsx("div",{id:i,ref:k,style:a,className:s,children:o.jsx(Y.Provider,{value:b,children:b!==null?e:null})})}r.memo(jr);class kr extends r.PureComponent{constructor(){super(...arguments),M(this,"state",{map:null}),M(this,"registeredEvents",[]),M(this,"mapRef",null),M(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),M(this,"panTo",e=>{var n=this.getInstance();n&&n.panTo(e)}),M(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),M(this,"getRef",e=>{this.mapRef=e})}componentDidMount(){var e=this.getInstance();this.registeredEvents=ee({updaterMap:On,eventMap:Sn,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{map:e}},this.setMapCallback)}componentDidUpdate(e){this.state.map!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:On,eventMap:Sn,prevProps:e,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),te(this.registeredEvents))}render(){return o.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:o.jsx(Y.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function Pn(t,e,n,i,a,s,l){try{var c=t[s](l),p=c.value}catch(f){return void n(f)}c.done?e(p):Promise.resolve(p).then(i,a)}function ka(t){return function(){var e=this,n=arguments;return new Promise(function(i,a){var s=t.apply(e,n);function l(p){Pn(s,i,a,l,c,"next",p)}function c(p){Pn(s,i,a,l,c,"throw",p)}l(void 0)})}}function Ma(t){var{googleMapsApiKey:e,googleMapsClientId:n,version:i="weekly",language:a,region:s,libraries:l,channel:c,mapIds:p,authReferrerPolicy:f}=t,m=[];return ue(e&&n||!(e&&n),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),e?m.push("key=".concat(e)):n&&m.push("client=".concat(n)),i&&m.push("v=".concat(i)),a&&m.push("language=".concat(a)),s&&m.push("region=".concat(s)),l&&l.length&&m.push("libraries=".concat(l.sort().join(","))),c&&m.push("channel=".concat(c)),p&&p.length&&m.push("map_ids=".concat(p.join(","))),f&&m.push("auth_referrer_policy=".concat(f)),m.push("loading=async"),m.push("callback=initMap"),"https://maps.googleapis.com/maps/api/js?".concat(m.join("&"))}var _e=typeof document<"u";function Sa(t){var{url:e,id:n,nonce:i}=t;return _e?new Promise(function(s,l){var c=document.getElementById(n),p=window;if(c){var f=c.getAttribute("data-state");if(c.src===e&&f!=="error"){if(f==="ready")return s(n);var m=p.initMap,x=c.onerror;p.initMap=function(){m&&m(),s(n)},c.onerror=function(h){x&&x(h),l(h)};return}else c.remove()}var u=document.createElement("script");u.type="text/javascript",u.src=e,u.id=n,u.async=!0,u.nonce=i||"",u.onerror=function(d){u.setAttribute("data-state","error"),l(d)},p.initMap=function(){u.setAttribute("data-state","ready"),s(n)},document.head.appendChild(u)}).catch(a=>{throw console.error("injectScript error: ",a),a}):Promise.reject(new Error("document is undefined"))}function Dn(t){var e=t.href;return e&&(e.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||e.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:t.tagName.toLowerCase()==="style"&&t.styleSheet&&t.styleSheet.cssText&&t.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(t.styleSheet.cssText="",!0):t.tagName.toLowerCase()==="style"&&t.innerHTML&&t.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(t.innerHTML="",!0):t.tagName.toLowerCase()==="style"&&!t.styleSheet&&!t.innerHTML}function an(){var t=document.getElementsByTagName("head")[0];if(t){var e=t.insertBefore.bind(t);t.insertBefore=function(a,s){return Dn(a)||Reflect.apply(e,t,[a,s]),a};var n=t.appendChild.bind(t);t.appendChild=function(a){return Dn(a)||Reflect.apply(n,t,[a]),a}}}var at=!1;function Oa(){return o.jsx("div",{children:"Loading..."})}var ut={id:"script-loader",version:"weekly"};class Mr extends r.PureComponent{constructor(){super(...arguments),M(this,"check",null),M(this,"state",{loaded:!1}),M(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),M(this,"isCleaningUp",ka(function*(){function e(n){if(!at)n();else if(_e)var i=window.setInterval(function(){at||(window.clearInterval(i),n())},1)}return new Promise(e)})),M(this,"cleanup",()=>{at=!0;var e=document.getElementById(this.props.id);e&&e.parentNode&&e.parentNode.removeChild(e),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(i){return typeof i.src=="string"&&i.src.includes("maps.googleapis")}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(i){return i.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(i){return i.innerText!==void 0&&i.innerText.length>0&&i.innerText.includes(".gm-")}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)})}),M(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&an(),ue(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var e={id:this.props.id,nonce:this.props.nonce,url:Ma(this.props)};Sa(e).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(n=>{this.props.onError&&this.props.onError(n),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})}),M(this,"getRef",e=>{this.check=e})}componentDidMount(){if(_e){if(window.google&&window.google.maps&&!at){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(n){console.error("Error at injecting script after cleaning up: ",n)})}}componentDidUpdate(e){this.props.libraries!==e.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),_e&&e.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(_e){this.cleanup();var e=()=>{this.check||(delete window.google,at=!1)};window.setTimeout(e,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return o.jsxs(o.Fragment,{children:[o.jsx("div",{ref:this.getRef}),this.state.loaded?this.props.children:this.props.loadingElement||o.jsx(Oa,{})]})}}M(Mr,"defaultProps",ut);function Sr(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.includes(i))continue;n[i]=t[i]}return n}function sn(t,e){if(t==null)return{};var n,i,a=Sr(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],e.includes(n)||{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}var Nn;function Or(t){var{id:e=ut.id,version:n=ut.version,nonce:i,googleMapsApiKey:a,googleMapsClientId:s,language:l,region:c,libraries:p,preventGoogleFontsLoading:f,channel:m,mapIds:x,authReferrerPolicy:u}=t,h=r.useRef(!1),[d,g]=r.useState(!1),[y,E]=r.useState(void 0);r.useEffect(function(){return h.current=!0,()=>{h.current=!1}},[]),r.useEffect(function(){_e&&f&&an()},[f]),r.useEffect(function(){d&&ue(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[d]);var j=Ma({version:n,googleMapsApiKey:a,googleMapsClientId:s,language:l,region:c,libraries:p,channel:m,mapIds:x,authReferrerPolicy:u});r.useEffect(function(){if(!_e)return;function b(){h.current&&(g(!0),Nn=j)}if(window.google&&window.google.maps&&Nn===j){b();return}Sa({id:e,url:j,nonce:i}).then(b).catch(function(k){h.current&&E(k),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(a||"-",") or Client ID (").concat(s||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(k)})},[e,j,i]);var O=r.useRef(void 0);return r.useEffect(function(){O.current&&p!==O.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),O.current=p},[p]),{isLoaded:d,loadError:y,url:j}}var Pr=["loadingElement","onLoad","onError","onUnmount","children"],Dr=o.jsx(Oa,{});function Nr(t){var{loadingElement:e,onLoad:n,onError:i,onUnmount:a,children:s}=t,l=sn(t,Pr),{isLoaded:c,loadError:p}=Or(l);return r.useEffect(function(){c&&typeof n=="function"&&n()},[c,n]),r.useEffect(function(){p&&typeof i=="function"&&i(p)},[p,i]),r.useEffect(function(){return()=>{a&&a()}},[a]),c?s:e||Dr}r.memo(Nr);function _r(t,e,n,i){function a(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function c(m){try{f(i.next(m))}catch(x){l(x)}}function p(m){try{f(i.throw(m))}catch(x){l(x)}}function f(m){m.done?s(m.value):a(m.value).then(c,p)}f((i=i.apply(t,[])).next())})}function Ir(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Rr=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var i,a,s;if(Array.isArray(e)){if(i=e.length,i!=n.length)return!1;for(a=i;a--!==0;)if(!t(e[a],n[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),i=s.length,i!==Object.keys(n).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[a]))return!1;for(a=i;a--!==0;){var l=s[a];if(!t(e[l],n[l]))return!1}return!0}return e!==e&&n!==n},Tr=Ir(Rr),_n="__googleMapsScriptId",Ke;(function(t){t[t.INITIALIZED=0]="INITIALIZED",t[t.LOADING=1]="LOADING",t[t.SUCCESS=2]="SUCCESS",t[t.FAILURE=3]="FAILURE"})(Ke||(Ke={}));class Ue{constructor(e){var{apiKey:n,authReferrerPolicy:i,channel:a,client:s,id:l=_n,language:c,libraries:p=[],mapIds:f,nonce:m,region:x,retries:u=3,url:h="https://maps.googleapis.com/maps/api/js",version:d}=e;if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=n,this.authReferrerPolicy=i,this.channel=a,this.client=s,this.id=l||_n,this.language=c,this.libraries=p,this.mapIds=f,this.nonce=m,this.region=x,this.retries=u,this.url=h,this.version=d,Ue.instance){if(!Tr(this.options,Ue.instance.options))throw new Error("Loader must not be called again with different options. ".concat(JSON.stringify(this.options)," !== ").concat(JSON.stringify(Ue.instance.options)));return Ue.instance}Ue.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?Ke.FAILURE:this.done?Ke.SUCCESS:this.loading?Ke.LOADING:Ke.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){var e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+="&key=".concat(this.apiKey)),this.channel&&(e+="&channel=".concat(this.channel)),this.client&&(e+="&client=".concat(this.client)),this.libraries.length>0&&(e+="&libraries=".concat(this.libraries.join(","))),this.language&&(e+="&language=".concat(this.language)),this.region&&(e+="&region=".concat(this.region)),this.version&&(e+="&v=".concat(this.version)),this.mapIds&&(e+="&map_ids=".concat(this.mapIds.join(","))),this.authReferrerPolicy&&(e+="&auth_referrer_policy=".concat(this.authReferrerPolicy)),e}deleteScript(){var e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,n)=>{this.loadCallback(i=>{i?n(i.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,n;if(document.getElementById(this.id)){this.callback();return}var i={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(i).forEach(s=>!i[s]&&delete i[s]),!((n=(e=window?.google)===null||e===void 0?void 0:e.maps)===null||n===void 0)&&n.importLibrary||(s=>{var l,c,p,f="The Google Maps JavaScript API",m="google",x="importLibrary",u="__ib__",h=document,d=window;d=d[m]||(d[m]={});var g=d.maps||(d.maps={}),y=new Set,E=new URLSearchParams,j=()=>l||(l=new Promise((O,v)=>_r(this,void 0,void 0,function*(){var b;yield c=h.createElement("script"),c.id=this.id,E.set("libraries",[...y]+"");for(p in s)E.set(p.replace(/[A-Z]/g,L=>"_"+L[0].toLowerCase()),s[p]);E.set("callback",m+".maps."+u),c.src=this.url+"?"+E,g[u]=O,c.onerror=()=>l=v(Error(f+" could not load.")),c.nonce=this.nonce||((b=h.querySelector("script[nonce]"))===null||b===void 0?void 0:b.nonce)||"",h.head.append(c)})));g[x]?console.warn(f+" only loads once. Ignoring:",s):g[x]=function(O){for(var v=arguments.length,b=new Array(v>1?v-1:0),L=1;L<v;L++)b[L-1]=arguments[L];return y.add(O)&&j().then(()=>g[x](O,...b))}})(i);var a=this.libraries.map(s=>this.importLibrary(s));a.length||a.push(this.importLibrary("core")),Promise.all(a).then(()=>this.callback(),s=>{var l=new ErrorEvent("error",{error:s});this.loadErrorCallback(l)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){var n=this.errors.length*Math.pow(2,this.errors.length);console.error("Failed to load Google Maps script, retrying in ".concat(n," ms.")),setTimeout(()=>{this.deleteScript(),this.setScript()},n)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}var Ar=["maps"];function zr(t){var{id:e=ut.id,version:n=ut.version,nonce:i,googleMapsApiKey:a,language:s,region:l,libraries:c=Ar,preventGoogleFontsLoading:p,mapIds:f,authReferrerPolicy:m}=t,x=r.useRef(!1),[u,h]=r.useState(!1),[d,g]=r.useState(void 0);r.useEffect(function(){return x.current=!0,()=>{x.current=!1}},[]);var y=r.useMemo(()=>new Ue({id:e,apiKey:a,version:n,libraries:c,language:s||"en",region:l||"US",mapIds:f||[],nonce:i||"",authReferrerPolicy:m||"origin"}),[e,a,n,c,s,l,f,i,m]);r.useEffect(function(){u||y.load().then(()=>{x.current&&h(!0)}).catch(O=>{g(O)})},[]),r.useEffect(()=>{_e&&p&&an()},[p]);var E=r.useRef();return r.useEffect(()=>{E.current&&c!==E.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),E.current=c},[c]),{isLoaded:u,loadError:d}}function In(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Mt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?In(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):In(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var Rn={},Tn={options(t,e){t.setOptions(e)}};function Fr(t){var{options:e,onLoad:n,onUnmount:i}=t,a=r.useContext(Y),[s,l]=r.useState(null);return r.useEffect(()=>{s!==null&&s.setMap(a)},[a]),r.useEffect(()=>{e&&s!==null&&s.setOptions(e)},[s,e]),r.useEffect(()=>{var c=new google.maps.TrafficLayer(Mt(Mt({},e),{},{map:a}));return l(c),n&&n(c),()=>{s!==null&&(i&&i(s),s.setMap(null))}},[]),null}r.memo(Fr);class Ur extends r.PureComponent{constructor(){super(...arguments),M(this,"state",{trafficLayer:null}),M(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),M(this,"registeredEvents",[])}componentDidMount(){var e=new google.maps.TrafficLayer(Mt(Mt({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:Tn,eventMap:Rn,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{trafficLayer:e}},this.setTrafficLayerCallback)}componentDidUpdate(e){this.state.trafficLayer!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Tn,eventMap:Rn,prevProps:e,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),te(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}M(Ur,"contextType",Y);function Br(t){var{onLoad:e,onUnmount:n}=t,i=r.useContext(Y),[a,s]=r.useState(null);return r.useEffect(()=>{a!==null&&a.setMap(i)},[i]),r.useEffect(()=>{var l=new google.maps.BicyclingLayer;return s(l),l.setMap(i),e&&e(l),()=>{l!==null&&(n&&n(l),l.setMap(null))}},[]),null}r.memo(Br);class $r extends r.PureComponent{constructor(){super(...arguments),M(this,"state",{bicyclingLayer:null}),M(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var e=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:e}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}M($r,"contextType",Y);function Wr(t){var{onLoad:e,onUnmount:n}=t,i=r.useContext(Y),[a,s]=r.useState(null);return r.useEffect(()=>{a!==null&&a.setMap(i)},[i]),r.useEffect(()=>{var l=new google.maps.TransitLayer;return s(l),l.setMap(i),e&&e(l),()=>{a!==null&&(n&&n(a),a.setMap(null))}},[]),null}r.memo(Wr);class Vr extends r.PureComponent{constructor(){super(...arguments),M(this,"state",{transitLayer:null}),M(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var e=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:e}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}M(Vr,"contextType",Y);function An(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function St(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?An(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):An(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var zn={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},Fn={drawingMode(t,e){t.setDrawingMode(e)},options(t,e){t.setOptions(e)}};function qr(t){var{options:e,drawingMode:n,onCircleComplete:i,onMarkerComplete:a,onOverlayComplete:s,onPolygonComplete:l,onPolylineComplete:c,onRectangleComplete:p,onLoad:f,onUnmount:m}=t,x=r.useContext(Y),[u,h]=r.useState(null),[d,g]=r.useState(null),[y,E]=r.useState(null),[j,O]=r.useState(null),[v,b]=r.useState(null),[L,k]=r.useState(null),[D,w]=r.useState(null);return r.useEffect(()=>{u!==null&&u.setMap(x)},[x]),r.useEffect(()=>{e&&u!==null&&u.setOptions(e)},[u,e]),r.useEffect(()=>{u!==null&&u.setDrawingMode(n??null)},[u,n]),r.useEffect(()=>{u&&i&&(d!==null&&google.maps.event.removeListener(d),g(google.maps.event.addListener(u,"circlecomplete",i)))},[u,i]),r.useEffect(()=>{u&&a&&(y!==null&&google.maps.event.removeListener(y),E(google.maps.event.addListener(u,"markercomplete",a)))},[u,a]),r.useEffect(()=>{u&&s&&(j!==null&&google.maps.event.removeListener(j),O(google.maps.event.addListener(u,"overlaycomplete",s)))},[u,s]),r.useEffect(()=>{u&&l&&(v!==null&&google.maps.event.removeListener(v),b(google.maps.event.addListener(u,"polygoncomplete",l)))},[u,l]),r.useEffect(()=>{u&&c&&(L!==null&&google.maps.event.removeListener(L),k(google.maps.event.addListener(u,"polylinecomplete",c)))},[u,c]),r.useEffect(()=>{u&&p&&(D!==null&&google.maps.event.removeListener(D),w(google.maps.event.addListener(u,"rectanglecomplete",p)))},[u,p]),r.useEffect(()=>{ue(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var P=new google.maps.drawing.DrawingManager(St(St({},e),{},{map:x}));return n&&P.setDrawingMode(n),i&&g(google.maps.event.addListener(P,"circlecomplete",i)),a&&E(google.maps.event.addListener(P,"markercomplete",a)),s&&O(google.maps.event.addListener(P,"overlaycomplete",s)),l&&b(google.maps.event.addListener(P,"polygoncomplete",l)),c&&k(google.maps.event.addListener(P,"polylinecomplete",c)),p&&w(google.maps.event.addListener(P,"rectanglecomplete",p)),h(P),f&&f(P),()=>{u!==null&&(d&&google.maps.event.removeListener(d),y&&google.maps.event.removeListener(y),j&&google.maps.event.removeListener(j),v&&google.maps.event.removeListener(v),L&&google.maps.event.removeListener(L),D&&google.maps.event.removeListener(D),m&&m(u),u.setMap(null))}},[]),null}r.memo(qr);class Hr extends r.PureComponent{constructor(e){super(e),M(this,"registeredEvents",[]),M(this,"state",{drawingManager:null}),M(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),ue(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var e=new google.maps.drawing.DrawingManager(St(St({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:Fn,eventMap:zn,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{drawingManager:e}},this.setDrawingManagerCallback)}componentDidUpdate(e){this.state.drawingManager!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Fn,eventMap:zn,prevProps:e,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),te(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}M(Hr,"contextType",Y);function Un(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Xe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Un(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Un(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var Bn={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},$n={animation(t,e){t.setAnimation(e)},clickable(t,e){t.setClickable(e)},cursor(t,e){t.setCursor(e)},draggable(t,e){t.setDraggable(e)},icon(t,e){t.setIcon(e)},label(t,e){t.setLabel(e)},map(t,e){t.setMap(e)},opacity(t,e){t.setOpacity(e)},options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},shape(t,e){t.setShape(e)},title(t,e){t.setTitle(e)},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Ot={};function Zr(t){var{position:e,options:n,clusterer:i,noClustererRedraw:a,children:s,draggable:l,visible:c,animation:p,clickable:f,cursor:m,icon:x,label:u,opacity:h,shape:d,title:g,zIndex:y,onClick:E,onDblClick:j,onDrag:O,onDragEnd:v,onDragStart:b,onMouseOut:L,onMouseOver:k,onMouseUp:D,onMouseDown:w,onRightClick:P,onClickableChanged:_,onCursorChanged:N,onAnimationChanged:V,onDraggableChanged:A,onFlatChanged:z,onIconChanged:Z,onPositionChanged:X,onShapeChanged:q,onTitleChanged:H,onVisibleChanged:J,onZindexChanged:ie,onLoad:ne,onUnmount:B}=t,S=r.useContext(Y),[C,R]=r.useState(null),[$,F]=r.useState(null),[G,T]=r.useState(null),[U,re]=r.useState(null),[xe,je]=r.useState(null),[oe,nt]=r.useState(null),[be,$e]=r.useState(null),[Ee,Te]=r.useState(null),[We,mt]=r.useState(null),[Ve,I]=r.useState(null),[W,ce]=r.useState(null),[pe,fe]=r.useState(null),[we,Ce]=r.useState(null),[ke,qe]=r.useState(null),[Me,Ae]=r.useState(null),[Se,He]=r.useState(null),[Oe,Ze]=r.useState(null),[Ge,cn]=r.useState(null),[pn,dn]=r.useState(null),[ft,un]=r.useState(null),[gt,mn]=r.useState(null),[ht,fn]=r.useState(null);r.useEffect(()=>{C!==null&&C.setMap(S)},[S]),r.useEffect(()=>{typeof n<"u"&&C!==null&&C.setOptions(n)},[C,n]),r.useEffect(()=>{typeof l<"u"&&C!==null&&C.setDraggable(l)},[C,l]),r.useEffect(()=>{e&&C!==null&&C.setPosition(e)},[C,e]),r.useEffect(()=>{typeof c<"u"&&C!==null&&C.setVisible(c)},[C,c]),r.useEffect(()=>{C?.setAnimation(p)},[C,p]),r.useEffect(()=>{C&&f!==void 0&&C.setClickable(f)},[C,f]),r.useEffect(()=>{C&&m!==void 0&&C.setCursor(m)},[C,m]),r.useEffect(()=>{C&&x!==void 0&&C.setIcon(x)},[C,x]),r.useEffect(()=>{C&&u!==void 0&&C.setLabel(u)},[C,u]),r.useEffect(()=>{C&&h!==void 0&&C.setOpacity(h)},[C,h]),r.useEffect(()=>{C&&d!==void 0&&C.setShape(d)},[C,d]),r.useEffect(()=>{C&&g!==void 0&&C.setTitle(g)},[C,g]),r.useEffect(()=>{C&&y!==void 0&&C.setZIndex(y)},[C,y]),r.useEffect(()=>{C&&j&&($!==null&&google.maps.event.removeListener($),F(google.maps.event.addListener(C,"dblclick",j)))},[j]),r.useEffect(()=>{C&&v&&(G!==null&&google.maps.event.removeListener(G),T(google.maps.event.addListener(C,"dragend",v)))},[v]),r.useEffect(()=>{C&&b&&(U!==null&&google.maps.event.removeListener(U),re(google.maps.event.addListener(C,"dragstart",b)))},[b]),r.useEffect(()=>{C&&w&&(xe!==null&&google.maps.event.removeListener(xe),je(google.maps.event.addListener(C,"mousedown",w)))},[w]),r.useEffect(()=>{C&&L&&(oe!==null&&google.maps.event.removeListener(oe),nt(google.maps.event.addListener(C,"mouseout",L)))},[L]),r.useEffect(()=>{C&&k&&(be!==null&&google.maps.event.removeListener(be),$e(google.maps.event.addListener(C,"mouseover",k)))},[k]),r.useEffect(()=>{C&&D&&(Ee!==null&&google.maps.event.removeListener(Ee),Te(google.maps.event.addListener(C,"mouseup",D)))},[D]),r.useEffect(()=>{C&&P&&(We!==null&&google.maps.event.removeListener(We),mt(google.maps.event.addListener(C,"rightclick",P)))},[P]),r.useEffect(()=>{C&&E&&(Ve!==null&&google.maps.event.removeListener(Ve),I(google.maps.event.addListener(C,"click",E)))},[E]),r.useEffect(()=>{C&&O&&(W!==null&&google.maps.event.removeListener(W),ce(google.maps.event.addListener(C,"drag",O)))},[O]),r.useEffect(()=>{C&&_&&(pe!==null&&google.maps.event.removeListener(pe),fe(google.maps.event.addListener(C,"clickable_changed",_)))},[_]),r.useEffect(()=>{C&&N&&(we!==null&&google.maps.event.removeListener(we),Ce(google.maps.event.addListener(C,"cursor_changed",N)))},[N]),r.useEffect(()=>{C&&V&&(ke!==null&&google.maps.event.removeListener(ke),qe(google.maps.event.addListener(C,"animation_changed",V)))},[V]),r.useEffect(()=>{C&&A&&(Me!==null&&google.maps.event.removeListener(Me),Ae(google.maps.event.addListener(C,"draggable_changed",A)))},[A]),r.useEffect(()=>{C&&z&&(Se!==null&&google.maps.event.removeListener(Se),He(google.maps.event.addListener(C,"flat_changed",z)))},[z]),r.useEffect(()=>{C&&Z&&(Oe!==null&&google.maps.event.removeListener(Oe),Ze(google.maps.event.addListener(C,"icon_changed",Z)))},[Z]),r.useEffect(()=>{C&&X&&(Ge!==null&&google.maps.event.removeListener(Ge),cn(google.maps.event.addListener(C,"position_changed",X)))},[X]),r.useEffect(()=>{C&&q&&(pn!==null&&google.maps.event.removeListener(pn),dn(google.maps.event.addListener(C,"shape_changed",q)))},[q]),r.useEffect(()=>{C&&H&&(ft!==null&&google.maps.event.removeListener(ft),un(google.maps.event.addListener(C,"title_changed",H)))},[H]),r.useEffect(()=>{C&&J&&(gt!==null&&google.maps.event.removeListener(gt),mn(google.maps.event.addListener(C,"visible_changed",J)))},[J]),r.useEffect(()=>{C&&ie&&(ht!==null&&google.maps.event.removeListener(ht),fn(google.maps.event.addListener(C,"zindex_changed",ie)))},[ie]),r.useEffect(()=>{var it=Xe(Xe(Xe({},n||Ot),i?Ot:{map:S}),{},{position:e}),K=new google.maps.Marker(it);return i?i.addMarker(K,!!a):K.setMap(S),e&&K.setPosition(e),typeof c<"u"&&K.setVisible(c),typeof l<"u"&&K.setDraggable(l),typeof f<"u"&&K.setClickable(f),typeof m=="string"&&K.setCursor(m),x&&K.setIcon(x),typeof u<"u"&&K.setLabel(u),typeof h<"u"&&K.setOpacity(h),d&&K.setShape(d),typeof g=="string"&&K.setTitle(g),typeof y=="number"&&K.setZIndex(y),j&&F(google.maps.event.addListener(K,"dblclick",j)),v&&T(google.maps.event.addListener(K,"dragend",v)),b&&re(google.maps.event.addListener(K,"dragstart",b)),w&&je(google.maps.event.addListener(K,"mousedown",w)),L&&nt(google.maps.event.addListener(K,"mouseout",L)),k&&$e(google.maps.event.addListener(K,"mouseover",k)),D&&Te(google.maps.event.addListener(K,"mouseup",D)),P&&mt(google.maps.event.addListener(K,"rightclick",P)),E&&I(google.maps.event.addListener(K,"click",E)),O&&ce(google.maps.event.addListener(K,"drag",O)),_&&fe(google.maps.event.addListener(K,"clickable_changed",_)),N&&Ce(google.maps.event.addListener(K,"cursor_changed",N)),V&&qe(google.maps.event.addListener(K,"animation_changed",V)),A&&Ae(google.maps.event.addListener(K,"draggable_changed",A)),z&&He(google.maps.event.addListener(K,"flat_changed",z)),Z&&Ze(google.maps.event.addListener(K,"icon_changed",Z)),X&&cn(google.maps.event.addListener(K,"position_changed",X)),q&&dn(google.maps.event.addListener(K,"shape_changed",q)),H&&un(google.maps.event.addListener(K,"title_changed",H)),J&&mn(google.maps.event.addListener(K,"visible_changed",J)),ie&&fn(google.maps.event.addListener(K,"zindex_changed",ie)),R(K),ne&&ne(K),()=>{$!==null&&google.maps.event.removeListener($),G!==null&&google.maps.event.removeListener(G),U!==null&&google.maps.event.removeListener(U),xe!==null&&google.maps.event.removeListener(xe),oe!==null&&google.maps.event.removeListener(oe),be!==null&&google.maps.event.removeListener(be),Ee!==null&&google.maps.event.removeListener(Ee),We!==null&&google.maps.event.removeListener(We),Ve!==null&&google.maps.event.removeListener(Ve),pe!==null&&google.maps.event.removeListener(pe),we!==null&&google.maps.event.removeListener(we),ke!==null&&google.maps.event.removeListener(ke),Me!==null&&google.maps.event.removeListener(Me),Se!==null&&google.maps.event.removeListener(Se),Oe!==null&&google.maps.event.removeListener(Oe),Ge!==null&&google.maps.event.removeListener(Ge),ft!==null&&google.maps.event.removeListener(ft),gt!==null&&google.maps.event.removeListener(gt),ht!==null&&google.maps.event.removeListener(ht),B&&B(K),i?i.removeMarker(K,!!a):K&&K.setMap(null)}},[]);var Ua=r.useMemo(()=>s?r.Children.map(s,it=>{if(!r.isValidElement(it))return it;var K=it;return r.cloneElement(K,{anchor:C})}):null,[s,C]);return o.jsx(o.Fragment,{children:Ua})||null}r.memo(Zr);class Pa extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[])}componentDidMount(){var e=this;return ka(function*(){var n=Xe(Xe(Xe({},e.props.options||Ot),e.props.clusterer?Ot:{map:e.context}),{},{position:e.props.position});e.marker=new google.maps.Marker(n),e.props.clusterer?e.props.clusterer.addMarker(e.marker,!!e.props.noClustererRedraw):e.marker.setMap(e.context),e.registeredEvents=ee({updaterMap:$n,eventMap:Bn,prevProps:{},nextProps:e.props,instance:e.marker}),e.props.onLoad&&e.props.onLoad(e.marker)})()}componentDidUpdate(e){this.marker&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:$n,eventMap:Bn,prevProps:e,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),te(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var e=this.props.children?r.Children.map(this.props.children,n=>{if(!r.isValidElement(n))return n;var i=n;return r.cloneElement(i,{anchor:this.marker})}):null;return e||null}}M(Pa,"contextType",Y);var Gr=function(){function t(e,n){e.getClusterer().extend(t,google.maps.OverlayView),this.cluster=e,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=n,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(e.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return t.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},t.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},t.prototype.onClick=function(e){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var n=this.cluster.getClusterer();if(google.maps.event.trigger(n,"click",this.cluster),google.maps.event.trigger(n,"clusterclick",this.cluster),n.getZoomOnClick()){var i=n.getMaxZoom(),a=this.cluster.getBounds(),s=n.getMap();s!==null&&"fitBounds"in s&&s.fitBounds(a),this.timeOut=window.setTimeout(function(){var l=n.getMap();if(l!==null){"fitBounds"in l&&l.fitBounds(a);var c=l.getZoom()||0;i!==null&&c>i&&l.setZoom(i+1)}},100)}e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}},t.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},t.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},t.prototype.onAdd=function(){var e;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(e=this.getPanes())===null||e===void 0||e.overlayMouseTarget.appendChild(this.div);var n=this.getMap();n!==null&&(this.boundsChangedListener=google.maps.event.addListener(n,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},t.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var e=this.getPosFromLatLng(this.center);this.div.style.top=e!==null?"".concat(e.y,"px"):"0",this.div.style.left=e!==null?"".concat(e.x,"px"):"0"}},t.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},t.prototype.show=function(){var e,n,i,a,s,l;if(this.div&&this.center){var c=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,p=this.backgroundPosition.split(" "),f=parseInt(((e=p[0])===null||e===void 0?void 0:e.replace(/^\s+|\s+$/g,""))||"0",10),m=parseInt(((n=p[1])===null||n===void 0?void 0:n.replace(/^\s+|\s+$/g,""))||"0",10),x=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(x!==null?"".concat(x.y,"px"):"0","; left: ").concat(x!==null?"".concat(x.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var u=document.createElement("img");u.alt=c,u.src=this.url,u.width=this.width,u.height=this.height,u.setAttribute("style","position: absolute; top: ".concat(m,"px; left: ").concat(f,"px")),this.cluster.getClusterer().enableRetinaIcons||(u.style.clip="rect(-".concat(m,"px, -").concat(f+this.width,"px, -").concat(m+this.height,", -").concat(f,")"));var h=document.createElement("div");h.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((i=this.sums)===null||i===void 0)&&i.text&&(h.innerText="".concat((a=this.sums)===null||a===void 0?void 0:a.text)),!((s=this.sums)===null||s===void 0)&&s.html&&(h.innerHTML="".concat((l=this.sums)===null||l===void 0?void 0:l.html)),this.div.innerHTML="",this.div.appendChild(u),this.div.appendChild(h),this.div.title=c,this.div.style.display=""}this.visible=!0},t.prototype.useStyle=function(e){this.sums=e;var n=this.cluster.getClusterer().getStyles(),i=n[Math.min(n.length-1,Math.max(0,e.index-1))];i&&(this.url=i.url,this.height=i.height,this.width=i.width,i.className&&(this.className="".concat(this.clusterClassName," ").concat(i.className)),this.anchorText=i.anchorText||[0,0],this.anchorIcon=i.anchorIcon||[this.height/2,this.width/2],this.textColor=i.textColor||"black",this.textSize=i.textSize||11,this.textDecoration=i.textDecoration||"none",this.fontWeight=i.fontWeight||"bold",this.fontStyle=i.fontStyle||"normal",this.fontFamily=i.fontFamily||"Arial,sans-serif",this.backgroundPosition=i.backgroundPosition||"0 0")},t.prototype.setCenter=function(e){this.center=e},t.prototype.getPosFromLatLng=function(e){var n=this.getProjection().fromLatLngToDivPixel(e);return n!==null&&(n.x-=this.anchorIcon[1],n.y-=this.anchorIcon[0]),n},t}(),Kr=function(){function t(e){this.markerClusterer=e,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new Gr(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return t.prototype.getSize=function(){return this.markers.length},t.prototype.getMarkers=function(){return this.markers},t.prototype.getCenter=function(){return this.center},t.prototype.getMap=function(){return this.map},t.prototype.getClusterer=function(){return this.markerClusterer},t.prototype.getBounds=function(){for(var e=new google.maps.LatLngBounds(this.center,this.center),n=this.getMarkers(),i=0,a=n;i<a.length;i++){var s=a[i],l=s.getPosition();l&&e.extend(l)}return e},t.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},t.prototype.addMarker=function(e){var n;if(this.isMarkerAlreadyAdded(e))return!1;if(this.center){if(this.averageCenter){var i=e.getPosition();if(i){var a=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(a-1)+i.lat())/a,(this.center.lng()*(a-1)+i.lng())/a),this.calculateBounds()}}}else{var i=e.getPosition();i&&(this.center=i,this.calculateBounds())}e.isAdded=!0,this.markers.push(e);var s=this.markers.length,l=this.markerClusterer.getMaxZoom(),c=(n=this.map)===null||n===void 0?void 0:n.getZoom();if(l!==null&&typeof c<"u"&&c>l)e.getMap()!==this.map&&e.setMap(this.map);else if(s<this.minClusterSize)e.getMap()!==this.map&&e.setMap(this.map);else if(s===this.minClusterSize)for(var p=0,f=this.markers;p<f.length;p++){var m=f[p];m.setMap(null)}else e.setMap(null);return!0},t.prototype.isMarkerInClusterBounds=function(e){if(this.bounds!==null){var n=e.getPosition();if(n)return this.bounds.contains(n)}return!1},t.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},t.prototype.updateIcon=function(){var e,n=this.markers.length,i=this.markerClusterer.getMaxZoom(),a=(e=this.map)===null||e===void 0?void 0:e.getZoom();if(i!==null&&typeof a<"u"&&a>i){this.clusterIcon.hide();return}if(n<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},t.prototype.isMarkerAlreadyAdded=function(e){if(this.markers.includes)return this.markers.includes(e);for(var n=0;n<this.markers.length;n++)if(e===this.markers[n])return!0;return!1},t}();function Yr(t,e){var n=t.length,i=n.toString().length,a=Math.min(i,e);return{text:n.toString(),index:a,title:""}}var Xr=2e3,Qr=500,Jr="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",eo="png",to=[53,56,66,78,90],no="cluster",Da=function(){function t(e,n,i){n===void 0&&(n=[]),i===void 0&&(i={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(t,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=i.gridSize||60,this.minClusterSize=i.minimumClusterSize||2,this.maxZoom=i.maxZoom||null,this.styles=i.styles||[],this.title=i.title||"",this.zoomOnClick=!0,i.zoomOnClick!==void 0&&(this.zoomOnClick=i.zoomOnClick),this.averageCenter=!1,i.averageCenter!==void 0&&(this.averageCenter=i.averageCenter),this.ignoreHidden=!1,i.ignoreHidden!==void 0&&(this.ignoreHidden=i.ignoreHidden),this.enableRetinaIcons=!1,i.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=i.enableRetinaIcons),this.imagePath=i.imagePath||Jr,this.imageExtension=i.imageExtension||eo,this.imageSizes=i.imageSizes||to,this.calculator=i.calculator||Yr,this.batchSize=i.batchSize||Xr,this.batchSizeIE=i.batchSizeIE||Qr,this.clusterClass=i.clusterClass||no,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(n,!0),this.setMap(e)}return t.prototype.onZoomChanged=function(){var e,n;this.resetViewport(!1),(((e=this.getMap())===null||e===void 0?void 0:e.getZoom())===(this.get("minZoom")||0)||((n=this.getMap())===null||n===void 0?void 0:n.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},t.prototype.onIdle=function(){this.redraw()},t.prototype.onAdd=function(){var e=this.getMap();this.activeMap=e,this.ready=!0,this.repaint(),e!==null&&(this.listeners=[google.maps.event.addListener(e,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(e,"idle",this.onIdle)])},t.prototype.onRemove=function(){for(var e=0,n=this.markers;e<n.length;e++){var i=n[e];i.getMap()!==this.activeMap&&i.setMap(this.activeMap)}for(var a=0,s=this.clusters;a<s.length;a++){var l=s[a];l.remove()}this.clusters=[];for(var c=0,p=this.listeners;c<p.length;c++){var f=p[c];google.maps.event.removeListener(f)}this.listeners=[],this.activeMap=null,this.ready=!1},t.prototype.draw=function(){},t.prototype.getMap=function(){return null},t.prototype.getPanes=function(){return null},t.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},t.prototype.setMap=function(){},t.prototype.addListener=function(){return{remove:function(){}}},t.prototype.bindTo=function(){},t.prototype.get=function(){},t.prototype.notify=function(){},t.prototype.set=function(){},t.prototype.setValues=function(){},t.prototype.unbind=function(){},t.prototype.unbindAll=function(){},t.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var e=0;e<this.imageSizes.length;e++)this.styles.push({url:"".concat(this.imagePath+(e+1),".").concat(this.imageExtension),height:this.imageSizes[e]||0,width:this.imageSizes[e]||0})},t.prototype.fitMapToMarkers=function(){for(var e=this.getMarkers(),n=new google.maps.LatLngBounds,i=0,a=e;i<a.length;i++){var s=a[i],l=s.getPosition();l&&n.extend(l)}var c=this.getMap();c!==null&&"fitBounds"in c&&c.fitBounds(n)},t.prototype.getGridSize=function(){return this.gridSize},t.prototype.setGridSize=function(e){this.gridSize=e},t.prototype.getMinimumClusterSize=function(){return this.minClusterSize},t.prototype.setMinimumClusterSize=function(e){this.minClusterSize=e},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.setMaxZoom=function(e){this.maxZoom=e},t.prototype.getStyles=function(){return this.styles},t.prototype.setStyles=function(e){this.styles=e},t.prototype.getTitle=function(){return this.title},t.prototype.setTitle=function(e){this.title=e},t.prototype.getZoomOnClick=function(){return this.zoomOnClick},t.prototype.setZoomOnClick=function(e){this.zoomOnClick=e},t.prototype.getAverageCenter=function(){return this.averageCenter},t.prototype.setAverageCenter=function(e){this.averageCenter=e},t.prototype.getIgnoreHidden=function(){return this.ignoreHidden},t.prototype.setIgnoreHidden=function(e){this.ignoreHidden=e},t.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},t.prototype.setEnableRetinaIcons=function(e){this.enableRetinaIcons=e},t.prototype.getImageExtension=function(){return this.imageExtension},t.prototype.setImageExtension=function(e){this.imageExtension=e},t.prototype.getImagePath=function(){return this.imagePath},t.prototype.setImagePath=function(e){this.imagePath=e},t.prototype.getImageSizes=function(){return this.imageSizes},t.prototype.setImageSizes=function(e){this.imageSizes=e},t.prototype.getCalculator=function(){return this.calculator},t.prototype.setCalculator=function(e){this.calculator=e},t.prototype.getBatchSizeIE=function(){return this.batchSizeIE},t.prototype.setBatchSizeIE=function(e){this.batchSizeIE=e},t.prototype.getClusterClass=function(){return this.clusterClass},t.prototype.setClusterClass=function(e){this.clusterClass=e},t.prototype.getMarkers=function(){return this.markers},t.prototype.getTotalMarkers=function(){return this.markers.length},t.prototype.getClusters=function(){return this.clusters},t.prototype.getTotalClusters=function(){return this.clusters.length},t.prototype.addMarker=function(e,n){this.pushMarkerTo(e),n||this.redraw()},t.prototype.addMarkers=function(e,n){for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=e[i];a&&this.pushMarkerTo(a)}n||this.redraw()},t.prototype.pushMarkerTo=function(e){var n=this;e.getDraggable()&&google.maps.event.addListener(e,"dragend",function(){n.ready&&(e.isAdded=!1,n.repaint())}),e.isAdded=!1,this.markers.push(e)},t.prototype.removeMarker_=function(e){var n=-1;if(this.markers.indexOf)n=this.markers.indexOf(e);else for(var i=0;i<this.markers.length;i++)if(e===this.markers[i]){n=i;break}return n===-1?!1:(e.setMap(null),this.markers.splice(n,1),!0)},t.prototype.removeMarker=function(e,n){var i=this.removeMarker_(e);return!n&&i&&this.repaint(),i},t.prototype.removeMarkers=function(e,n){for(var i=!1,a=0,s=e;a<s.length;a++){var l=s[a];i=i||this.removeMarker_(l)}return!n&&i&&this.repaint(),i},t.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},t.prototype.repaint=function(){var e=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var i=0,a=e;i<a.length;i++){var s=a[i];s.remove()}},0)},t.prototype.getExtendedBounds=function(e){var n=this.getProjection(),i=n.fromLatLngToDivPixel(new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()));i!==null&&(i.x+=this.gridSize,i.y-=this.gridSize);var a=n.fromLatLngToDivPixel(new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()));if(a!==null&&(a.x-=this.gridSize,a.y+=this.gridSize),i!==null){var s=n.fromDivPixelToLatLng(i);s!==null&&e.extend(s)}if(a!==null){var l=n.fromDivPixelToLatLng(a);l!==null&&e.extend(l)}return e},t.prototype.redraw=function(){this.createClusters(0)},t.prototype.resetViewport=function(e){for(var n=0,i=this.clusters;n<i.length;n++){var a=i[n];a.remove()}this.clusters=[];for(var s=0,l=this.markers;s<l.length;s++){var c=l[s];c.isAdded=!1,e&&c.setMap(null)}},t.prototype.distanceBetweenPoints=function(e,n){var i=6371,a=(n.lat()-e.lat())*Math.PI/180,s=(n.lng()-e.lng())*Math.PI/180,l=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(n.lat()*Math.PI/180)*Math.sin(s/2)*Math.sin(s/2);return i*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},t.prototype.isMarkerInBounds=function(e,n){var i=e.getPosition();return i?n.contains(i):!1},t.prototype.addToClosestCluster=function(e){for(var n,i=4e4,a=null,s=0,l=this.clusters;s<l.length;s++){var c=l[s];n=c;var p=n.getCenter(),f=e.getPosition();if(p&&f){var m=this.distanceBetweenPoints(p,f);m<i&&(i=m,a=n)}}a&&a.isMarkerInClusterBounds(e)?a.addMarker(e):(n=new Kr(this),n.addMarker(e),this.clusters.push(n))},t.prototype.createClusters=function(e){var n=this;if(this.ready){e===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var i=this.getMap(),a=i!==null&&("getBounds"in i)?i.getBounds():null,s=i?.getZoom()||0,l=s>3?new google.maps.LatLngBounds(a?.getSouthWest(),a?.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),c=this.getExtendedBounds(l),p=Math.min(e+this.batchSize,this.markers.length),f=e;f<p;f++){var m=this.markers[f];m&&!m.isAdded&&this.isMarkerInBounds(m,c)&&(!this.ignoreHidden||this.ignoreHidden&&m.getVisible())&&this.addToClosestCluster(m)}if(p<this.markers.length)this.timerRefStatic=window.setTimeout(function(){n.createClusters(p)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var x=0,u=this.clusters;x<u.length;x++){var h=u[x];h.updateIcon()}}}},t.prototype.extend=function(e,n){return function(a){for(var s in a.prototype){var l=s;this.prototype[l]=a.prototype[l]}return this}.apply(e,[n])},t}();function Wn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function io(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Wn(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wn(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var ye={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},ae={averageCenter(t,e){t.setAverageCenter(e)},batchSizeIE(t,e){t.setBatchSizeIE(e)},calculator(t,e){t.setCalculator(e)},clusterClass(t,e){t.setClusterClass(e)},enableRetinaIcons(t,e){t.setEnableRetinaIcons(e)},gridSize(t,e){t.setGridSize(e)},ignoreHidden(t,e){t.setIgnoreHidden(e)},imageExtension(t,e){t.setImageExtension(e)},imagePath(t,e){t.setImagePath(e)},imageSizes(t,e){t.setImageSizes(e)},maxZoom(t,e){t.setMaxZoom(e)},minimumClusterSize(t,e){t.setMinimumClusterSize(e)},styles(t,e){t.setStyles(e)},title(t,e){t.setTitle(e)},zoomOnClick(t,e){t.setZoomOnClick(e)}},ao={};function so(t){var{children:e,options:n,averageCenter:i,batchSizeIE:a,calculator:s,clusterClass:l,enableRetinaIcons:c,gridSize:p,ignoreHidden:f,imageExtension:m,imagePath:x,imageSizes:u,maxZoom:h,minimumClusterSize:d,styles:g,title:y,zoomOnClick:E,onClick:j,onClusteringBegin:O,onClusteringEnd:v,onMouseOver:b,onMouseOut:L,onLoad:k,onUnmount:D}=t,[w,P]=r.useState(null),_=r.useContext(Y),[N,V]=r.useState(null),[A,z]=r.useState(null),[Z,X]=r.useState(null),[q,H]=r.useState(null),[J,ie]=r.useState(null);return r.useEffect(()=>{w&&L&&(q!==null&&google.maps.event.removeListener(q),H(google.maps.event.addListener(w,ye.onMouseOut,L)))},[L]),r.useEffect(()=>{w&&b&&(J!==null&&google.maps.event.removeListener(J),ie(google.maps.event.addListener(w,ye.onMouseOver,b)))},[b]),r.useEffect(()=>{w&&j&&(N!==null&&google.maps.event.removeListener(N),V(google.maps.event.addListener(w,ye.onClick,j)))},[j]),r.useEffect(()=>{w&&O&&(A!==null&&google.maps.event.removeListener(A),z(google.maps.event.addListener(w,ye.onClusteringBegin,O)))},[O]),r.useEffect(()=>{w&&v&&(Z!==null&&google.maps.event.removeListener(Z),z(google.maps.event.addListener(w,ye.onClusteringEnd,v)))},[v]),r.useEffect(()=>{typeof i<"u"&&w!==null&&ae.averageCenter(w,i)},[w,i]),r.useEffect(()=>{typeof a<"u"&&w!==null&&ae.batchSizeIE(w,a)},[w,a]),r.useEffect(()=>{typeof s<"u"&&w!==null&&ae.calculator(w,s)},[w,s]),r.useEffect(()=>{typeof l<"u"&&w!==null&&ae.clusterClass(w,l)},[w,l]),r.useEffect(()=>{typeof c<"u"&&w!==null&&ae.enableRetinaIcons(w,c)},[w,c]),r.useEffect(()=>{typeof p<"u"&&w!==null&&ae.gridSize(w,p)},[w,p]),r.useEffect(()=>{typeof f<"u"&&w!==null&&ae.ignoreHidden(w,f)},[w,f]),r.useEffect(()=>{typeof m<"u"&&w!==null&&ae.imageExtension(w,m)},[w,m]),r.useEffect(()=>{typeof x<"u"&&w!==null&&ae.imagePath(w,x)},[w,x]),r.useEffect(()=>{typeof u<"u"&&w!==null&&ae.imageSizes(w,u)},[w,u]),r.useEffect(()=>{typeof h<"u"&&w!==null&&ae.maxZoom(w,h)},[w,h]),r.useEffect(()=>{typeof d<"u"&&w!==null&&ae.minimumClusterSize(w,d)},[w,d]),r.useEffect(()=>{typeof g<"u"&&w!==null&&ae.styles(w,g)},[w,g]),r.useEffect(()=>{typeof y<"u"&&w!==null&&ae.title(w,y)},[w,y]),r.useEffect(()=>{typeof E<"u"&&w!==null&&ae.zoomOnClick(w,E)},[w,E]),r.useEffect(()=>{if(_){var ne=io({},n||ao),B=new Da(_,[],ne);return i&&ae.averageCenter(B,i),a&&ae.batchSizeIE(B,a),s&&ae.calculator(B,s),l&&ae.clusterClass(B,l),c&&ae.enableRetinaIcons(B,c),p&&ae.gridSize(B,p),f&&ae.ignoreHidden(B,f),m&&ae.imageExtension(B,m),x&&ae.imagePath(B,x),u&&ae.imageSizes(B,u),h&&ae.maxZoom(B,h),d&&ae.minimumClusterSize(B,d),g&&ae.styles(B,g),y&&ae.title(B,y),E&&ae.zoomOnClick(B,E),L&&H(google.maps.event.addListener(B,ye.onMouseOut,L)),b&&ie(google.maps.event.addListener(B,ye.onMouseOver,b)),j&&V(google.maps.event.addListener(B,ye.onClick,j)),O&&z(google.maps.event.addListener(B,ye.onClusteringBegin,O)),v&&X(google.maps.event.addListener(B,ye.onClusteringEnd,v)),P(B),k&&k(B),()=>{q!==null&&google.maps.event.removeListener(q),J!==null&&google.maps.event.removeListener(J),N!==null&&google.maps.event.removeListener(N),A!==null&&google.maps.event.removeListener(A),Z!==null&&google.maps.event.removeListener(Z),D&&D(B)}}},[]),w!==null&&e(w)||null}r.memo(so);class ro extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{markerClusterer:null}),M(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var e=new Da(this.context,[],this.props.options);this.registeredEvents=ee({updaterMap:ae,eventMap:ye,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({markerClusterer:e}),this.setClustererCallback)}}componentDidUpdate(e){this.state.markerClusterer&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:ae,eventMap:ye,prevProps:e,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),te(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}M(ro,"contextType",Y);function Vn(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}var Na=function(){function t(e){e===void 0&&(e={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(t,google.maps.OverlayView),this.content=e.content||"",this.disableAutoPan=e.disableAutoPan||!1,this.maxWidth=e.maxWidth||0,this.pixelOffset=e.pixelOffset||new google.maps.Size(0,0),this.position=e.position||new google.maps.LatLng(0,0),this.zIndex=e.zIndex||null,this.boxClass=e.boxClass||"infoBox",this.boxStyle=e.boxStyle||{},this.closeBoxMargin=e.closeBoxMargin||"2px",this.closeBoxURL=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",e.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=e.infoBoxClearance||new google.maps.Size(1,1),typeof e.visible>"u"&&(typeof e.isHidden>"u"?e.visible=!0:e.visible=!e.isHidden),this.isHidden=!e.visible,this.alignBottom=e.alignBottom||!1,this.pane=e.pane||"floatPane",this.enableEventPropagation=e.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return t.prototype.createInfoBoxDiv=function(){var e=this,n=function(m){m.returnValue=!1,m.preventDefault&&m.preventDefault(),e.enableEventPropagation||Vn(m)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var i=this.getPanes();if(i!==null&&i[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var a=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-a.left-a.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var s=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],l=0,c=s;l<c.length;l++){var p=c[l];this.eventListeners.push(google.maps.event.addListener(this.div,p,Vn))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){e.div&&(e.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",n),google.maps.event.trigger(this,"domready")}},t.prototype.getCloseBoxImg=function(){var e="";return this.closeBoxURL!==""&&(e='<img alt=""',e+=' aria-hidden="true"',e+=" src='"+this.closeBoxURL+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin+";",e+="'>"),e},t.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},t.prototype.closeClickHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},t.prototype.getCloseClickHandler=function(){return this.closeClickHandler},t.prototype.panBox=function(e){if(this.div&&!e){var n=this.getMap();if(n instanceof google.maps.Map){var i=0,a=0,s=n.getBounds();s&&!s.contains(this.position)&&n.setCenter(this.position);var l=n.getDiv(),c=l.offsetWidth,p=l.offsetHeight,f=this.pixelOffset.width,m=this.pixelOffset.height,x=this.div.offsetWidth,u=this.div.offsetHeight,h=this.infoBoxClearance.width,d=this.infoBoxClearance.height,g=this.getProjection(),y=g.fromLatLngToContainerPixel(this.position);y!==null&&(y.x<-f+h?i=y.x+f-h:y.x+x+f+h>c&&(i=y.x+x+f+h-c),this.alignBottom?y.y<-m+d+u?a=y.y+m-d-u:y.y+m+d>p&&(a=y.y+m+d-p):y.y<-m+d?a=y.y+m-d:y.y+u+m+d>p&&(a=y.y+u+m+d-p)),i===0&&a===0||n.panBy(i,a)}}},t.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var e=this.boxStyle;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this.div.style[n]=e[n]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var i=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+i*100+')"',this.div.style.filter="alpha(opacity="+i*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},t.prototype.getBoxWidths=function(){var e={top:0,bottom:0,left:0,right:0};if(!this.div)return e;if(document.defaultView){var n=this.div.ownerDocument,i=n&&n.defaultView?n.defaultView.getComputedStyle(this.div,""):null;i&&(e.top=parseInt(i.borderTopWidth||"",10)||0,e.bottom=parseInt(i.borderBottomWidth||"",10)||0,e.left=parseInt(i.borderLeftWidth||"",10)||0,e.right=parseInt(i.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var a=this.div.currentStyle;a&&(e.top=parseInt(a.borderTopWidth||"",10)||0,e.bottom=parseInt(a.borderBottomWidth||"",10)||0,e.left=parseInt(a.borderLeftWidth||"",10)||0,e.right=parseInt(a.borderRightWidth||"",10)||0)}return e},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},t.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var e=this.getProjection(),n=e.fromLatLngToDivPixel(this.position);n!==null&&(this.div.style.left=n.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(n.y+this.pixelOffset.height)+"px":this.div.style.top=n.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},t.prototype.setOptions=function(e){e===void 0&&(e={}),typeof e.boxClass<"u"&&(this.boxClass=e.boxClass,this.setBoxStyle()),typeof e.boxStyle<"u"&&(this.boxStyle=e.boxStyle,this.setBoxStyle()),typeof e.content<"u"&&this.setContent(e.content),typeof e.disableAutoPan<"u"&&(this.disableAutoPan=e.disableAutoPan),typeof e.maxWidth<"u"&&(this.maxWidth=e.maxWidth),typeof e.pixelOffset<"u"&&(this.pixelOffset=e.pixelOffset),typeof e.alignBottom<"u"&&(this.alignBottom=e.alignBottom),typeof e.position<"u"&&this.setPosition(e.position),typeof e.zIndex<"u"&&this.setZIndex(e.zIndex),typeof e.closeBoxMargin<"u"&&(this.closeBoxMargin=e.closeBoxMargin),typeof e.closeBoxURL<"u"&&(this.closeBoxURL=e.closeBoxURL),typeof e.infoBoxClearance<"u"&&(this.infoBoxClearance=e.infoBoxClearance),typeof e.isHidden<"u"&&(this.isHidden=e.isHidden),typeof e.visible<"u"&&(this.isHidden=!e.visible),typeof e.enableEventPropagation<"u"&&(this.enableEventPropagation=e.enableEventPropagation),this.div&&this.draw()},t.prototype.setContent=function(e){this.content=e,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},t.prototype.setPosition=function(e){this.position=e,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},t.prototype.setVisible=function(e){this.isHidden=!e,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},t.prototype.setZIndex=function(e){this.zIndex=e,this.div&&(this.div.style.zIndex=e+""),google.maps.event.trigger(this,"zindex_changed")},t.prototype.getContent=function(){return this.content},t.prototype.getPosition=function(){return this.position},t.prototype.getZIndex=function(){return this.zIndex},t.prototype.getVisible=function(){var e=this.getMap();return typeof e>"u"||e===null?!1:!this.isHidden},t.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},t.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},t.prototype.open=function(e,n){var i=this;n&&(this.position=n.getPosition(),this.moveListener=google.maps.event.addListener(n,"position_changed",function(){var a=n.getPosition();i.setPosition(a)}),this.mapListener=google.maps.event.addListener(n,"map_changed",function(){i.setMap(n.map)})),this.setMap(e),this.div&&this.panBox()},t.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var e=0,n=this.eventListeners;e<n.length;e++){var i=n[e];google.maps.event.removeListener(i)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},t.prototype.extend=function(e,n){return function(a){for(var s in a.prototype)Object.prototype.hasOwnProperty.call(this,s)||(this.prototype[s]=a.prototype[s]);return this}.apply(e,[n])},t}(),oo=["position"],lo=["position"];function qn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Pt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?qn(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qn(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var Hn={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},Zn={options(t,e){t.setOptions(e)},position(t,e){e instanceof google.maps.LatLng?t.setPosition(e):t.setPosition(new google.maps.LatLng(e.lat,e.lng))},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},co={};function po(t){var{children:e,anchor:n,options:i,position:a,zIndex:s,onCloseClick:l,onDomReady:c,onContentChanged:p,onPositionChanged:f,onZindexChanged:m,onLoad:x,onUnmount:u}=t,h=r.useContext(Y),[d,g]=r.useState(null),[y,E]=r.useState(null),[j,O]=r.useState(null),[v,b]=r.useState(null),[L,k]=r.useState(null),[D,w]=r.useState(null),P=r.useRef(null);return r.useEffect(()=>{h&&d!==null&&(d.close(),n?d.open(h,n):d.getPosition()&&d.open(h))},[h,d,n]),r.useEffect(()=>{i&&d!==null&&d.setOptions(i)},[d,i]),r.useEffect(()=>{if(a&&d!==null){var _=a instanceof google.maps.LatLng?a:new google.maps.LatLng(a.lat,a.lng);d.setPosition(_)}},[a]),r.useEffect(()=>{typeof s=="number"&&d!==null&&d.setZIndex(s)},[s]),r.useEffect(()=>{d&&l&&(y!==null&&google.maps.event.removeListener(y),E(google.maps.event.addListener(d,"closeclick",l)))},[l]),r.useEffect(()=>{d&&c&&(j!==null&&google.maps.event.removeListener(j),O(google.maps.event.addListener(d,"domready",c)))},[c]),r.useEffect(()=>{d&&p&&(v!==null&&google.maps.event.removeListener(v),b(google.maps.event.addListener(d,"content_changed",p)))},[p]),r.useEffect(()=>{d&&f&&(L!==null&&google.maps.event.removeListener(L),k(google.maps.event.addListener(d,"position_changed",f)))},[f]),r.useEffect(()=>{d&&m&&(D!==null&&google.maps.event.removeListener(D),w(google.maps.event.addListener(d,"zindex_changed",m)))},[m]),r.useEffect(()=>{if(h){var _=i||co,{position:N}=_,V=sn(_,oo),A;N&&!(N instanceof google.maps.LatLng)&&(A=new google.maps.LatLng(N.lat,N.lng));var z=new Na(Pt(Pt({},V),A?{position:A}:{}));P.current=document.createElement("div"),g(z),l&&E(google.maps.event.addListener(z,"closeclick",l)),c&&O(google.maps.event.addListener(z,"domready",c)),p&&b(google.maps.event.addListener(z,"content_changed",p)),f&&k(google.maps.event.addListener(z,"position_changed",f)),m&&w(google.maps.event.addListener(z,"zindex_changed",m)),z.setContent(P.current),n?z.open(h,n):z.getPosition()?z.open(h):ue(!1,"You must provide either an anchor or a position prop for <InfoBox>."),x&&x(z)}return()=>{d!==null&&(y&&google.maps.event.removeListener(y),v&&google.maps.event.removeListener(v),j&&google.maps.event.removeListener(j),L&&google.maps.event.removeListener(L),D&&google.maps.event.removeListener(D),u&&u(d),d.close())}},[]),P.current?et.createPortal(r.Children.only(e),P.current):null}r.memo(po);class uo extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"containerElement",null),M(this,"state",{infoBox:null}),M(this,"open",(e,n)=>{n?this.context!==null&&e.open(this.context,n):e.getPosition()?this.context!==null&&e.open(this.context):ue(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),M(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var e=this.props.options||{},{position:n}=e,i=sn(e,lo),a;n&&!(n instanceof google.maps.LatLng)&&(a=new google.maps.LatLng(n.lat,n.lng));var s=new Na(Pt(Pt({},i),a?{position:a}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=ee({updaterMap:Zn,eventMap:Hn,prevProps:{},nextProps:this.props,instance:s}),this.setState({infoBox:s},this.setInfoBoxCallback)}componentDidUpdate(e){var{infoBox:n}=this.state;n!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Zn,eventMap:Hn,prevProps:e,nextProps:this.props,instance:n}))}componentWillUnmount(){var{onUnmount:e}=this.props,{infoBox:n}=this.state;n!==null&&(e&&e(n),te(this.registeredEvents),n.close())}render(){return this.containerElement?et.createPortal(r.Children.only(this.props.children),this.containerElement):null}}M(uo,"contextType",Y);var Ut,Gn;function mo(){return Gn||(Gn=1,Ut=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var i,a,s;if(Array.isArray(e)){if(i=e.length,i!=n.length)return!1;for(a=i;a--!==0;)if(!t(e[a],n[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),i=s.length,i!==Object.keys(n).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[a]))return!1;for(a=i;a--!==0;){var l=s[a];if(!t(e[l],n[l]))return!1}return!0}return e!==e&&n!==n}),Ut}var fo=mo(),Kn=ja(fo),Yn=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Bt=1,st=8;class rn{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[n,i]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");var a=i>>4;if(a!==Bt)throw new Error("Got v".concat(a," data when expected v").concat(Bt,"."));var s=Yn[i&15];if(!s)throw new Error("Unrecognized array type.");var[l]=new Uint16Array(e,2,1),[c]=new Uint32Array(e,4,1);return new rn(c,l,s,e)}constructor(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,a=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;var s=Yn.indexOf(this.ArrayType),l=e*2*this.ArrayType.BYTES_PER_ELEMENT,c=e*this.IndexArrayType.BYTES_PER_ELEMENT,p=(8-c%8)%8;if(s<0)throw new Error("Unexpected typed array class: ".concat(i,"."));a&&a instanceof ArrayBuffer?(this.data=a,this.ids=new this.IndexArrayType(this.data,st,e),this.coords=new this.ArrayType(this.data,st+c+p,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(st+l+c+p),this.ids=new this.IndexArrayType(this.data,st,e),this.coords=new this.ArrayType(this.data,st+c+p,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(Bt<<4)+s]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){var i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=n,i}finish(){var e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return Jt(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,i,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:s,coords:l,nodeSize:c}=this,p=[0,s.length-1,0],f=[];p.length;){var m=p.pop()||0,x=p.pop()||0,u=p.pop()||0;if(x-u<=c){for(var h=u;h<=x;h++){var d=l[2*h],g=l[2*h+1];d>=e&&d<=i&&g>=n&&g<=a&&f.push(s[h])}continue}var y=u+x>>1,E=l[2*y],j=l[2*y+1];E>=e&&E<=i&&j>=n&&j<=a&&f.push(s[y]),(m===0?e<=E:n<=j)&&(p.push(u),p.push(y-1),p.push(1-m)),(m===0?i>=E:a>=j)&&(p.push(y+1),p.push(x),p.push(1-m))}return f}within(e,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:a,coords:s,nodeSize:l}=this,c=[0,a.length-1,0],p=[],f=i*i;c.length;){var m=c.pop()||0,x=c.pop()||0,u=c.pop()||0;if(x-u<=l){for(var h=u;h<=x;h++)Xn(s[2*h],s[2*h+1],e,n)<=f&&p.push(a[h]);continue}var d=u+x>>1,g=s[2*d],y=s[2*d+1];Xn(g,y,e,n)<=f&&p.push(a[d]),(m===0?e-i<=g:n-i<=y)&&(c.push(u),c.push(d-1),c.push(1-m)),(m===0?e+i>=g:n+i>=y)&&(c.push(d+1),c.push(x),c.push(1-m))}return p}}function Jt(t,e,n,i,a,s){if(!(a-i<=n)){var l=i+a>>1;_a(t,e,l,i,a,s),Jt(t,e,n,i,l-1,1-s),Jt(t,e,n,l+1,a,1-s)}}function _a(t,e,n,i,a,s){for(;a>i;){if(a-i>600){var l=a-i+1,c=n-i+1,p=Math.log(l),f=.5*Math.exp(2*p/3),m=.5*Math.sqrt(p*f*(l-f)/l)*(c-l/2<0?-1:1),x=Math.max(i,Math.floor(n-c*f/l+m)),u=Math.min(a,Math.floor(n+(l-c)*f/l+m));_a(t,e,n,x,u,s)}var h=e[2*n+s],d=i,g=a;for(rt(t,e,i,n),e[2*a+s]>h&&rt(t,e,i,a);d<g;){for(rt(t,e,d,g),d++,g--;e[2*d+s]<h;)d++;for(;e[2*g+s]>h;)g--}e[2*i+s]===h?rt(t,e,i,g):(g++,rt(t,e,g,a)),g<=n&&(i=g+1),n<=g&&(a=g-1)}}function rt(t,e,n,i){$t(t,n,i),$t(e,2*n,2*i),$t(e,2*n+1,2*i+1)}function $t(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function Xn(t,e,n,i){var a=t-n,s=e-i;return a*a+s*s}var go={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},Qn=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),ze=2,De=3,Wt=4,Pe=5,Ia=6;class ho{constructor(e){this.options=Object.assign(Object.create(go),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){var{log:n,minZoom:i,maxZoom:a}=this.options;n&&console.time("total time");var s="prepare ".concat(e.length," points");n&&console.time(s),this.points=e;for(var l=[],c=0;c<e.length;c++){var p=e[c];if(p.geometry){var[f,m]=p.geometry.coordinates,x=Qn(xt(f)),u=Qn(yt(m));l.push(x,u,1/0,c,-1,1),this.options.reduce&&l.push(0)}}var h=this.trees[a+1]=this._createTree(l);n&&console.timeEnd(s);for(var d=a;d>=i;d--){var g=+Date.now();h=this.trees[d]=this._createTree(this._cluster(h,d)),n&&console.log("z%d: %d clusters in %dms",d,h.numItems,+Date.now()-g)}return n&&console.timeEnd("total time"),this}getClusters(e,n){var i=((e[0]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[1])),s=e[2]===180?180:((e[2]+180)%360+360)%360-180,l=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)i=-180,s=180;else if(i>s){var c=this.getClusters([i,a,180,l],n),p=this.getClusters([-180,a,s,l],n);return c.concat(p)}var f=this.trees[this._limitZoom(n)],m=f.range(xt(i),yt(l),xt(s),yt(a)),x=f.data,u=[];for(var h of m){var d=this.stride*h;u.push(x[d+Pe]>1?Jn(x,d,this.clusterProps):this.points[x[d+De]])}return u}getChildren(e){var n=this._getOriginId(e),i=this._getOriginZoom(e),a="No cluster with the specified id.",s=this.trees[i];if(!s)throw new Error(a);var l=s.data;if(n*this.stride>=l.length)throw new Error(a);var c=this.options.radius/(this.options.extent*Math.pow(2,i-1)),p=l[n*this.stride],f=l[n*this.stride+1],m=s.within(p,f,c),x=[];for(var u of m){var h=u*this.stride;l[h+Wt]===e&&x.push(l[h+Pe]>1?Jn(l,h,this.clusterProps):this.points[l[h+De]])}if(x.length===0)throw new Error(a);return x}getLeaves(e,n,i){n=n||10,i=i||0;var a=[];return this._appendLeaves(a,e,n,i,0),a}getTile(e,n,i){var a=this.trees[this._limitZoom(e)],s=Math.pow(2,e),{extent:l,radius:c}=this.options,p=c/l,f=(i-p)/s,m=(i+1+p)/s,x={features:[]};return this._addTileFeatures(a.range((n-p)/s,f,(n+1+p)/s,m),a.data,n,i,s,x),n===0&&this._addTileFeatures(a.range(1-p/s,f,1,m),a.data,s,i,s,x),n===s-1&&this._addTileFeatures(a.range(0,f,p/s,m),a.data,-1,i,s,x),x.features.length?x:null}getClusterExpansionZoom(e){for(var n=this._getOriginZoom(e)-1;n<=this.options.maxZoom;){var i=this.getChildren(e);if(n++,i.length!==1)break;e=i[0].properties.cluster_id}return n}_appendLeaves(e,n,i,a,s){var l=this.getChildren(n);for(var c of l){var p=c.properties;if(p&&p.cluster?s+p.point_count<=a?s+=p.point_count:s=this._appendLeaves(e,p.cluster_id,i,a,s):s<a?s++:e.push(c),e.length===i)break}return s}_createTree(e){for(var n=new rn(e.length/this.stride|0,this.options.nodeSize,Float32Array),i=0;i<e.length;i+=this.stride)n.add(e[i],e[i+1]);return n.finish(),n.data=e,n}_addTileFeatures(e,n,i,a,s,l){for(var c of e){var p=c*this.stride,f=n[p+Pe]>1,m=void 0,x=void 0,u=void 0;if(f)m=Ra(n,p,this.clusterProps),x=n[p],u=n[p+1];else{var h=this.points[n[p+De]];m=h.properties;var[d,g]=h.geometry.coordinates;x=xt(d),u=yt(g)}var y={type:1,geometry:[[Math.round(this.options.extent*(x*s-i)),Math.round(this.options.extent*(u*s-a))]],tags:m},E=void 0;f||this.options.generateId?E=n[p+De]:E=this.points[n[p+De]].id,E!==void 0&&(y.id=E),l.features.push(y)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,n){for(var{radius:i,extent:a,reduce:s,minPoints:l}=this.options,c=i/(a*Math.pow(2,n)),p=e.data,f=[],m=this.stride,x=0;x<p.length;x+=m)if(!(p[x+ze]<=n)){p[x+ze]=n;var u=p[x],h=p[x+1],d=e.within(p[x],p[x+1],c),g=p[x+Pe],y=g;for(var E of d){var j=E*m;p[j+ze]>n&&(y+=p[j+Pe])}if(y>g&&y>=l){var O=u*g,v=h*g,b=void 0,L=-1,k=((x/m|0)<<5)+(n+1)+this.points.length;for(var D of d){var w=D*m;if(!(p[w+ze]<=n)){p[w+ze]=n;var P=p[w+Pe];O+=p[w]*P,v+=p[w+1]*P,p[w+Wt]=k,s&&(b||(b=this._map(p,x,!0),L=this.clusterProps.length,this.clusterProps.push(b)),s(b,this._map(p,w)))}}p[x+Wt]=k,f.push(O/y,v/y,1/0,k,-1,y),s&&f.push(L)}else{for(var _=0;_<m;_++)f.push(p[x+_]);if(y>1)for(var N of d){var V=N*m;if(!(p[V+ze]<=n)){p[V+ze]=n;for(var A=0;A<m;A++)f.push(p[V+A])}}}}return f}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,n,i){if(e[n+Pe]>1){var a=this.clusterProps[e[n+Ia]];return i?Object.assign({},a):a}var s=this.points[e[n+De]].properties,l=this.options.map(s);return i&&l===s?Object.assign({},l):l}}function Jn(t,e,n){return{type:"Feature",id:t[e+De],properties:Ra(t,e,n),geometry:{type:"Point",coordinates:[vo(t[e]),xo(t[e+1])]}}}function Ra(t,e,n){var i=t[e+Pe],a=i>=1e4?"".concat(Math.round(i/1e3),"k"):i>=1e3?"".concat(Math.round(i/100)/10,"k"):i,s=t[e+Ia],l=s===-1?{}:Object.assign({},n[s]);return Object.assign(l,{cluster:!0,cluster_id:t[e+De],point_count:i,point_count_abbreviated:a})}function xt(t){return t/360+.5}function yt(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function vo(t){return(t-.5)*360}function xo(t){var e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function yo(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(t);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(t,i[a])&&(n[i[a]]=t[i[a]]);return n}class ve{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,n){this.isAdvancedMarker(e)?e.map=n:e.setMap(n)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class en{constructor(e){var{markers:n,position:i}=e;this.markers=n,i&&(i instanceof google.maps.LatLng?this._position=i:this._position=new google.maps.LatLng(i))}get bounds(){if(!(this.markers.length===0&&!this._position)){var e=new google.maps.LatLngBounds(this._position,this._position);for(var n of this.markers)e.extend(ve.getPosition(n));return e}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>ve.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(ve.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class bo{constructor(e){var{maxZoom:n=16}=e;this.maxZoom=n}noop(e){var{markers:n}=e;return wo(n)}}var wo=t=>{var e=t.map(n=>new en({position:ve.getPosition(n),markers:[n]}));return e};class Lo extends bo{constructor(e){var{maxZoom:n,radius:i=60}=e,a=yo(e,["maxZoom","radius"]);super({maxZoom:n}),this.state={zoom:-1},this.superCluster=new ho(Object.assign({maxZoom:this.maxZoom,radius:i},a))}calculate(e){var n=!1,i={zoom:e.map.getZoom()};if(!Kn(e.markers,this.markers)){n=!0,this.markers=[...e.markers];var a=this.markers.map(s=>{var l=ve.getPosition(s),c=[l.lng(),l.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:c},properties:{marker:s}}});this.superCluster.load(a)}return n||(this.state.zoom<=this.maxZoom||i.zoom<=this.maxZoom)&&(n=!Kn(this.state,i)),this.state=i,n&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:n}}cluster(e){var{map:n}=e;return this.superCluster.getClusters([-180,-90,180,90],Math.round(n.getZoom())).map(i=>this.transformCluster(i))}transformCluster(e){var{geometry:{coordinates:[n,i]},properties:a}=e;if(a.cluster)return new en({markers:this.superCluster.getLeaves(a.cluster_id,1/0).map(l=>l.properties.marker),position:{lat:i,lng:n}});var s=a.marker;return new en({markers:[s],position:ve.getPosition(s)})}}class Eo{constructor(e,n){this.markers={sum:e.length};var i=n.map(s=>s.count),a=i.reduce((s,l)=>s+l,0);this.clusters={count:n.length,markers:{mean:a/n.length,sum:a,min:Math.min(...i),max:Math.max(...i)}}}}class Co{render(e,n,i){var{count:a,position:s}=e,l=a>Math.max(10,n.clusters.markers.mean)?"#ff0000":"#0000ff",c='<svg fill="'.concat(l,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(a,`</text>
</svg>`),p="Cluster of ".concat(a," markers"),f=Number(google.maps.Marker.MAX_ZINDEX)+a;if(ve.isAdvancedMarkerAvailable(i)){var m=new DOMParser,x=m.parseFromString(c,"image/svg+xml").documentElement;x.setAttribute("transform","translate(0 25)");var u={map:i,position:s,zIndex:f,title:p,content:x};return new google.maps.marker.AdvancedMarkerElement(u)}var h={position:s,zIndex:f,title:p,icon:{url:"data:image/svg+xml;base64,".concat(btoa(c)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(h)}}function jo(t,e){for(var n in e.prototype)t.prototype[n]=e.prototype[n]}class on{constructor(){jo(on,google.maps.OverlayView)}}var lt;(function(t){t.CLUSTERING_BEGIN="clusteringbegin",t.CLUSTERING_END="clusteringend",t.CLUSTER_CLICK="click"})(lt||(lt={}));var ko=(t,e,n)=>{n.fitBounds(e.bounds)};class Mo extends on{constructor(e){var{map:n,markers:i=[],algorithmOptions:a={},algorithm:s=new Lo(a),renderer:l=new Co,onClusterClick:c=ko}=e;super(),this.markers=[...i],this.clusters=[],this.algorithm=s,this.renderer=l,this.onClusterClick=c,n&&this.setMap(n)}addMarker(e,n){this.markers.includes(e)||(this.markers.push(e),n||this.render())}addMarkers(e,n){e.forEach(i=>{this.addMarker(i,!0)}),n||this.render()}removeMarker(e,n){var i=this.markers.indexOf(e);return i===-1?!1:(ve.setMap(e,null),this.markers.splice(i,1),n||this.render(),!0)}removeMarkers(e,n){var i=!1;return e.forEach(a=>{i=this.removeMarker(a,!0)||i}),i&&!n&&this.render(),i}clearMarkers(e){this.markers.length=0,e||this.render()}render(){var e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,lt.CLUSTERING_BEGIN,this);var{clusters:n,changed:i}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(i||i==null){var a=new Set;for(var s of n)s.markers.length==1&&a.add(s.markers[0]);var l=[];for(var c of this.clusters)c.marker!=null&&(c.markers.length==1?a.has(c.marker)||ve.setMap(c.marker,null):l.push(c.marker));this.clusters=n,this.renderClusters(),requestAnimationFrame(()=>l.forEach(p=>ve.setMap(p,null)))}google.maps.event.trigger(this,lt.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>ve.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){var e=new Eo(this.markers,this.clusters),n=this.getMap();this.clusters.forEach(i=>{i.markers.length===1?i.marker=i.markers[0]:(i.marker=this.renderer.render(i,e,n),i.markers.forEach(a=>ve.setMap(a,null)),this.onClusterClick&&i.marker.addListener("click",a=>{google.maps.event.trigger(this,lt.CLUSTER_CLICK,i),this.onClusterClick(a,i,n)})),ve.setMap(i.marker,n)})}}function ei(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function ti(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ei(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ei(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function So(t){var e=yr(),[n,i]=r.useState(null);return r.useEffect(()=>{if(e&&n===null){var a=new Mo(ti(ti({},t),{},{map:e}));i(a)}},[e]),n}function Oo(t){var{children:e,options:n}=t,i=So(n);return i!==null?e(i):null}r.memo(Oo);var ni={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},ii={options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},zIndex(t,e){t.setZIndex(e)}};function Po(t){var{children:e,anchor:n,options:i,position:a,zIndex:s,onCloseClick:l,onDomReady:c,onContentChanged:p,onPositionChanged:f,onZindexChanged:m,onLoad:x,onUnmount:u}=t,h=r.useContext(Y),[d,g]=r.useState(null),[y,E]=r.useState(null),[j,O]=r.useState(null),[v,b]=r.useState(null),[L,k]=r.useState(null),[D,w]=r.useState(null),P=r.useRef(null);return r.useEffect(()=>{d!==null&&(d.close(),n?d.open(h,n):d.getPosition()&&d.open(h))},[h,d,n]),r.useEffect(()=>{i&&d!==null&&d.setOptions(i)},[d,i]),r.useEffect(()=>{a&&d!==null&&d.setPosition(a)},[a]),r.useEffect(()=>{typeof s=="number"&&d!==null&&d.setZIndex(s)},[s]),r.useEffect(()=>{d&&l&&(y!==null&&google.maps.event.removeListener(y),E(google.maps.event.addListener(d,"closeclick",l)))},[l]),r.useEffect(()=>{d&&c&&(j!==null&&google.maps.event.removeListener(j),O(google.maps.event.addListener(d,"domready",c)))},[c]),r.useEffect(()=>{d&&p&&(v!==null&&google.maps.event.removeListener(v),b(google.maps.event.addListener(d,"content_changed",p)))},[p]),r.useEffect(()=>{d&&f&&(L!==null&&google.maps.event.removeListener(L),k(google.maps.event.addListener(d,"position_changed",f)))},[f]),r.useEffect(()=>{d&&m&&(D!==null&&google.maps.event.removeListener(D),w(google.maps.event.addListener(d,"zindex_changed",m)))},[m]),r.useEffect(()=>{var _=new google.maps.InfoWindow(i);return g(_),P.current=document.createElement("div"),l&&E(google.maps.event.addListener(_,"closeclick",l)),c&&O(google.maps.event.addListener(_,"domready",c)),p&&b(google.maps.event.addListener(_,"content_changed",p)),f&&k(google.maps.event.addListener(_,"position_changed",f)),m&&w(google.maps.event.addListener(_,"zindex_changed",m)),_.setContent(P.current),a&&_.setPosition(a),s&&_.setZIndex(s),n?_.open(h,n):_.getPosition()?_.open(h):ue(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),x&&x(_),()=>{y&&google.maps.event.removeListener(y),v&&google.maps.event.removeListener(v),j&&google.maps.event.removeListener(j),L&&google.maps.event.removeListener(L),D&&google.maps.event.removeListener(D),u&&u(_),_.close()}},[]),P.current?et.createPortal(r.Children.only(e),P.current):null}r.memo(Po);class Do extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"containerElement",null),M(this,"state",{infoWindow:null}),M(this,"open",(e,n)=>{n?e.open(this.context,n):e.getPosition()?e.open(this.context):ue(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),M(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var e=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=ee({updaterMap:ii,eventMap:ni,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({infoWindow:e}),this.setInfoWindowCallback)}componentDidUpdate(e){this.state.infoWindow!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:ii,eventMap:ni,prevProps:e,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&(te(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?et.createPortal(r.Children.only(this.props.children),this.containerElement):null}}M(Do,"contextType",Y);function ai(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Dt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ai(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ai(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var si={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},ri={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},visible(t,e){t.setVisible(e)}},No={};function _o(t){var{options:e,draggable:n,editable:i,visible:a,path:s,onDblClick:l,onDragEnd:c,onDragStart:p,onMouseDown:f,onMouseMove:m,onMouseOut:x,onMouseOver:u,onMouseUp:h,onRightClick:d,onClick:g,onDrag:y,onLoad:E,onUnmount:j}=t,O=r.useContext(Y),[v,b]=r.useState(null),[L,k]=r.useState(null),[D,w]=r.useState(null),[P,_]=r.useState(null),[N,V]=r.useState(null),[A,z]=r.useState(null),[Z,X]=r.useState(null),[q,H]=r.useState(null),[J,ie]=r.useState(null),[ne,B]=r.useState(null),[S,C]=r.useState(null),[R,$]=r.useState(null);return r.useEffect(()=>{v!==null&&v.setMap(O)},[O]),r.useEffect(()=>{typeof e<"u"&&v!==null&&v.setOptions(e)},[v,e]),r.useEffect(()=>{typeof n<"u"&&v!==null&&v.setDraggable(n)},[v,n]),r.useEffect(()=>{typeof i<"u"&&v!==null&&v.setEditable(i)},[v,i]),r.useEffect(()=>{typeof a<"u"&&v!==null&&v.setVisible(a)},[v,a]),r.useEffect(()=>{typeof s<"u"&&v!==null&&v.setPath(s)},[v,s]),r.useEffect(()=>{v&&l&&(L!==null&&google.maps.event.removeListener(L),k(google.maps.event.addListener(v,"dblclick",l)))},[l]),r.useEffect(()=>{v&&c&&(D!==null&&google.maps.event.removeListener(D),w(google.maps.event.addListener(v,"dragend",c)))},[c]),r.useEffect(()=>{v&&p&&(P!==null&&google.maps.event.removeListener(P),_(google.maps.event.addListener(v,"dragstart",p)))},[p]),r.useEffect(()=>{v&&f&&(N!==null&&google.maps.event.removeListener(N),V(google.maps.event.addListener(v,"mousedown",f)))},[f]),r.useEffect(()=>{v&&m&&(A!==null&&google.maps.event.removeListener(A),z(google.maps.event.addListener(v,"mousemove",m)))},[m]),r.useEffect(()=>{v&&x&&(Z!==null&&google.maps.event.removeListener(Z),X(google.maps.event.addListener(v,"mouseout",x)))},[x]),r.useEffect(()=>{v&&u&&(q!==null&&google.maps.event.removeListener(q),H(google.maps.event.addListener(v,"mouseover",u)))},[u]),r.useEffect(()=>{v&&h&&(J!==null&&google.maps.event.removeListener(J),ie(google.maps.event.addListener(v,"mouseup",h)))},[h]),r.useEffect(()=>{v&&d&&(ne!==null&&google.maps.event.removeListener(ne),B(google.maps.event.addListener(v,"rightclick",d)))},[d]),r.useEffect(()=>{v&&g&&(S!==null&&google.maps.event.removeListener(S),C(google.maps.event.addListener(v,"click",g)))},[g]),r.useEffect(()=>{v&&y&&(R!==null&&google.maps.event.removeListener(R),$(google.maps.event.addListener(v,"drag",y)))},[y]),r.useEffect(()=>{var F=new google.maps.Polyline(Dt(Dt({},e||No),{},{map:O}));return s&&F.setPath(s),typeof a<"u"&&F.setVisible(a),typeof i<"u"&&F.setEditable(i),typeof n<"u"&&F.setDraggable(n),l&&k(google.maps.event.addListener(F,"dblclick",l)),c&&w(google.maps.event.addListener(F,"dragend",c)),p&&_(google.maps.event.addListener(F,"dragstart",p)),f&&V(google.maps.event.addListener(F,"mousedown",f)),m&&z(google.maps.event.addListener(F,"mousemove",m)),x&&X(google.maps.event.addListener(F,"mouseout",x)),u&&H(google.maps.event.addListener(F,"mouseover",u)),h&&ie(google.maps.event.addListener(F,"mouseup",h)),d&&B(google.maps.event.addListener(F,"rightclick",d)),g&&C(google.maps.event.addListener(F,"click",g)),y&&$(google.maps.event.addListener(F,"drag",y)),b(F),E&&E(F),()=>{L!==null&&google.maps.event.removeListener(L),D!==null&&google.maps.event.removeListener(D),P!==null&&google.maps.event.removeListener(P),N!==null&&google.maps.event.removeListener(N),A!==null&&google.maps.event.removeListener(A),Z!==null&&google.maps.event.removeListener(Z),q!==null&&google.maps.event.removeListener(q),J!==null&&google.maps.event.removeListener(J),ne!==null&&google.maps.event.removeListener(ne),S!==null&&google.maps.event.removeListener(S),j&&j(F),F.setMap(null)}},[]),null}r.memo(_o);class Io extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{polyline:null}),M(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var e=new google.maps.Polyline(Dt(Dt({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:ri,eventMap:si,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{polyline:e}},this.setPolylineCallback)}componentDidUpdate(e){this.state.polyline!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:ri,eventMap:si,prevProps:e,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),te(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}M(Io,"contextType",Y);function oi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function li(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?oi(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oi(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var ci={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},pi={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},paths(t,e){t.setPaths(e)},visible(t,e){t.setVisible(e)}};function Ro(t){var{options:e,draggable:n,editable:i,visible:a,path:s,paths:l,onDblClick:c,onDragEnd:p,onDragStart:f,onMouseDown:m,onMouseMove:x,onMouseOut:u,onMouseOver:h,onMouseUp:d,onRightClick:g,onClick:y,onDrag:E,onLoad:j,onUnmount:O,onEdit:v}=t,b=r.useContext(Y),[L,k]=r.useState(null),[D,w]=r.useState(null),[P,_]=r.useState(null),[N,V]=r.useState(null),[A,z]=r.useState(null),[Z,X]=r.useState(null),[q,H]=r.useState(null),[J,ie]=r.useState(null),[ne,B]=r.useState(null),[S,C]=r.useState(null),[R,$]=r.useState(null),[F,G]=r.useState(null);return r.useEffect(()=>{L!==null&&L.setMap(b)},[b]),r.useEffect(()=>{typeof e<"u"&&L!==null&&L.setOptions(e)},[L,e]),r.useEffect(()=>{typeof n<"u"&&L!==null&&L.setDraggable(n)},[L,n]),r.useEffect(()=>{typeof i<"u"&&L!==null&&L.setEditable(i)},[L,i]),r.useEffect(()=>{typeof a<"u"&&L!==null&&L.setVisible(a)},[L,a]),r.useEffect(()=>{typeof s<"u"&&L!==null&&L.setPath(s)},[L,s]),r.useEffect(()=>{typeof l<"u"&&L!==null&&L.setPaths(l)},[L,l]),r.useEffect(()=>{L&&typeof c=="function"&&(D!==null&&google.maps.event.removeListener(D),w(google.maps.event.addListener(L,"dblclick",c)))},[c]),r.useEffect(()=>{L&&(google.maps.event.addListener(L.getPath(),"insert_at",()=>{v?.(L)}),google.maps.event.addListener(L.getPath(),"set_at",()=>{v?.(L)}),google.maps.event.addListener(L.getPath(),"remove_at",()=>{v?.(L)}))},[L,v]),r.useEffect(()=>{L&&typeof p=="function"&&(P!==null&&google.maps.event.removeListener(P),_(google.maps.event.addListener(L,"dragend",p)))},[p]),r.useEffect(()=>{L&&typeof f=="function"&&(N!==null&&google.maps.event.removeListener(N),V(google.maps.event.addListener(L,"dragstart",f)))},[f]),r.useEffect(()=>{L&&typeof m=="function"&&(A!==null&&google.maps.event.removeListener(A),z(google.maps.event.addListener(L,"mousedown",m)))},[m]),r.useEffect(()=>{L&&typeof x=="function"&&(Z!==null&&google.maps.event.removeListener(Z),X(google.maps.event.addListener(L,"mousemove",x)))},[x]),r.useEffect(()=>{L&&typeof u=="function"&&(q!==null&&google.maps.event.removeListener(q),H(google.maps.event.addListener(L,"mouseout",u)))},[u]),r.useEffect(()=>{L&&typeof h=="function"&&(J!==null&&google.maps.event.removeListener(J),ie(google.maps.event.addListener(L,"mouseover",h)))},[h]),r.useEffect(()=>{L&&typeof d=="function"&&(ne!==null&&google.maps.event.removeListener(ne),B(google.maps.event.addListener(L,"mouseup",d)))},[d]),r.useEffect(()=>{L&&typeof g=="function"&&(S!==null&&google.maps.event.removeListener(S),C(google.maps.event.addListener(L,"rightclick",g)))},[g]),r.useEffect(()=>{L&&typeof y=="function"&&(R!==null&&google.maps.event.removeListener(R),$(google.maps.event.addListener(L,"click",y)))},[y]),r.useEffect(()=>{L&&typeof E=="function"&&(F!==null&&google.maps.event.removeListener(F),G(google.maps.event.addListener(L,"drag",E)))},[E]),r.useEffect(()=>{var T=new google.maps.Polygon(li(li({},e),{},{map:b}));return s&&T.setPath(s),l&&T.setPaths(l),typeof a<"u"&&T.setVisible(a),typeof i<"u"&&T.setEditable(i),typeof n<"u"&&T.setDraggable(n),c&&w(google.maps.event.addListener(T,"dblclick",c)),p&&_(google.maps.event.addListener(T,"dragend",p)),f&&V(google.maps.event.addListener(T,"dragstart",f)),m&&z(google.maps.event.addListener(T,"mousedown",m)),x&&X(google.maps.event.addListener(T,"mousemove",x)),u&&H(google.maps.event.addListener(T,"mouseout",u)),h&&ie(google.maps.event.addListener(T,"mouseover",h)),d&&B(google.maps.event.addListener(T,"mouseup",d)),g&&C(google.maps.event.addListener(T,"rightclick",g)),y&&$(google.maps.event.addListener(T,"click",y)),E&&G(google.maps.event.addListener(T,"drag",E)),k(T),j&&j(T),()=>{D!==null&&google.maps.event.removeListener(D),P!==null&&google.maps.event.removeListener(P),N!==null&&google.maps.event.removeListener(N),A!==null&&google.maps.event.removeListener(A),Z!==null&&google.maps.event.removeListener(Z),q!==null&&google.maps.event.removeListener(q),J!==null&&google.maps.event.removeListener(J),ne!==null&&google.maps.event.removeListener(ne),S!==null&&google.maps.event.removeListener(S),R!==null&&google.maps.event.removeListener(R),O&&O(T),T.setMap(null)}},[]),null}r.memo(Ro);class To extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[])}componentDidMount(){var e=this.props.options||{};this.polygon=new google.maps.Polygon(e),this.polygon.setMap(this.context),this.registeredEvents=ee({updaterMap:pi,eventMap:ci,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(e){this.polygon&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:pi,eventMap:ci,prevProps:e,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),te(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}M(To,"contextType",Y);function di(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Nt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?di(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):di(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var ui={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},mi={bounds(t,e){t.setBounds(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},visible(t,e){t.setVisible(e)}};function Ao(t){var{options:e,bounds:n,draggable:i,editable:a,visible:s,onDblClick:l,onDragEnd:c,onDragStart:p,onMouseDown:f,onMouseMove:m,onMouseOut:x,onMouseOver:u,onMouseUp:h,onRightClick:d,onClick:g,onDrag:y,onBoundsChanged:E,onLoad:j,onUnmount:O}=t,v=r.useContext(Y),[b,L]=r.useState(null),[k,D]=r.useState(null),[w,P]=r.useState(null),[_,N]=r.useState(null),[V,A]=r.useState(null),[z,Z]=r.useState(null),[X,q]=r.useState(null),[H,J]=r.useState(null),[ie,ne]=r.useState(null),[B,S]=r.useState(null),[C,R]=r.useState(null),[$,F]=r.useState(null),[G,T]=r.useState(null);return r.useEffect(()=>{b!==null&&b.setMap(v)},[v]),r.useEffect(()=>{typeof e<"u"&&b!==null&&b.setOptions(e)},[b,e]),r.useEffect(()=>{typeof i<"u"&&b!==null&&b.setDraggable(i)},[b,i]),r.useEffect(()=>{typeof a<"u"&&b!==null&&b.setEditable(a)},[b,a]),r.useEffect(()=>{typeof s<"u"&&b!==null&&b.setVisible(s)},[b,s]),r.useEffect(()=>{typeof n<"u"&&b!==null&&b.setBounds(n)},[b,n]),r.useEffect(()=>{b&&l&&(k!==null&&google.maps.event.removeListener(k),D(google.maps.event.addListener(b,"dblclick",l)))},[l]),r.useEffect(()=>{b&&c&&(w!==null&&google.maps.event.removeListener(w),P(google.maps.event.addListener(b,"dragend",c)))},[c]),r.useEffect(()=>{b&&p&&(_!==null&&google.maps.event.removeListener(_),N(google.maps.event.addListener(b,"dragstart",p)))},[p]),r.useEffect(()=>{b&&f&&(V!==null&&google.maps.event.removeListener(V),A(google.maps.event.addListener(b,"mousedown",f)))},[f]),r.useEffect(()=>{b&&m&&(z!==null&&google.maps.event.removeListener(z),Z(google.maps.event.addListener(b,"mousemove",m)))},[m]),r.useEffect(()=>{b&&x&&(X!==null&&google.maps.event.removeListener(X),q(google.maps.event.addListener(b,"mouseout",x)))},[x]),r.useEffect(()=>{b&&u&&(H!==null&&google.maps.event.removeListener(H),J(google.maps.event.addListener(b,"mouseover",u)))},[u]),r.useEffect(()=>{b&&h&&(ie!==null&&google.maps.event.removeListener(ie),ne(google.maps.event.addListener(b,"mouseup",h)))},[h]),r.useEffect(()=>{b&&d&&(B!==null&&google.maps.event.removeListener(B),S(google.maps.event.addListener(b,"rightclick",d)))},[d]),r.useEffect(()=>{b&&g&&(C!==null&&google.maps.event.removeListener(C),R(google.maps.event.addListener(b,"click",g)))},[g]),r.useEffect(()=>{b&&y&&($!==null&&google.maps.event.removeListener($),F(google.maps.event.addListener(b,"drag",y)))},[y]),r.useEffect(()=>{b&&E&&(G!==null&&google.maps.event.removeListener(G),T(google.maps.event.addListener(b,"bounds_changed",E)))},[E]),r.useEffect(()=>{var U=new google.maps.Rectangle(Nt(Nt({},e),{},{map:v}));return typeof s<"u"&&U.setVisible(s),typeof a<"u"&&U.setEditable(a),typeof i<"u"&&U.setDraggable(i),typeof n<"u"&&U.setBounds(n),l&&D(google.maps.event.addListener(U,"dblclick",l)),c&&P(google.maps.event.addListener(U,"dragend",c)),p&&N(google.maps.event.addListener(U,"dragstart",p)),f&&A(google.maps.event.addListener(U,"mousedown",f)),m&&Z(google.maps.event.addListener(U,"mousemove",m)),x&&q(google.maps.event.addListener(U,"mouseout",x)),u&&J(google.maps.event.addListener(U,"mouseover",u)),h&&ne(google.maps.event.addListener(U,"mouseup",h)),d&&S(google.maps.event.addListener(U,"rightclick",d)),g&&R(google.maps.event.addListener(U,"click",g)),y&&F(google.maps.event.addListener(U,"drag",y)),E&&T(google.maps.event.addListener(U,"bounds_changed",E)),L(U),j&&j(U),()=>{k!==null&&google.maps.event.removeListener(k),w!==null&&google.maps.event.removeListener(w),_!==null&&google.maps.event.removeListener(_),V!==null&&google.maps.event.removeListener(V),z!==null&&google.maps.event.removeListener(z),X!==null&&google.maps.event.removeListener(X),H!==null&&google.maps.event.removeListener(H),ie!==null&&google.maps.event.removeListener(ie),B!==null&&google.maps.event.removeListener(B),C!==null&&google.maps.event.removeListener(C),$!==null&&google.maps.event.removeListener($),G!==null&&google.maps.event.removeListener(G),O&&O(U),U.setMap(null)}},[]),null}r.memo(Ao);class zo extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{rectangle:null}),M(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var e=new google.maps.Rectangle(Nt(Nt({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:mi,eventMap:ui,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{rectangle:e}},this.setRectangleCallback)}componentDidUpdate(e){this.state.rectangle!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:mi,eventMap:ui,prevProps:e,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),te(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}}M(zo,"contextType",Y);function fi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function _t(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?fi(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fi(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var gi={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},hi={center(t,e){t.setCenter(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},radius(t,e){t.setRadius(e)},visible(t,e){t.setVisible(e)}},Fo={};function Uo(t){var{options:e,center:n,radius:i,draggable:a,editable:s,visible:l,onDblClick:c,onDragEnd:p,onDragStart:f,onMouseDown:m,onMouseMove:x,onMouseOut:u,onMouseOver:h,onMouseUp:d,onRightClick:g,onClick:y,onDrag:E,onCenterChanged:j,onRadiusChanged:O,onLoad:v,onUnmount:b}=t,L=r.useContext(Y),[k,D]=r.useState(null),[w,P]=r.useState(null),[_,N]=r.useState(null),[V,A]=r.useState(null),[z,Z]=r.useState(null),[X,q]=r.useState(null),[H,J]=r.useState(null),[ie,ne]=r.useState(null),[B,S]=r.useState(null),[C,R]=r.useState(null),[$,F]=r.useState(null),[G,T]=r.useState(null),[U,re]=r.useState(null),[xe,je]=r.useState(null);return r.useEffect(()=>{k!==null&&k.setMap(L)},[L]),r.useEffect(()=>{typeof e<"u"&&k!==null&&k.setOptions(e)},[k,e]),r.useEffect(()=>{typeof a<"u"&&k!==null&&k.setDraggable(a)},[k,a]),r.useEffect(()=>{typeof s<"u"&&k!==null&&k.setEditable(s)},[k,s]),r.useEffect(()=>{typeof l<"u"&&k!==null&&k.setVisible(l)},[k,l]),r.useEffect(()=>{typeof i=="number"&&k!==null&&k.setRadius(i)},[k,i]),r.useEffect(()=>{typeof n<"u"&&k!==null&&k.setCenter(n)},[k,n]),r.useEffect(()=>{k&&c&&(w!==null&&google.maps.event.removeListener(w),P(google.maps.event.addListener(k,"dblclick",c)))},[c]),r.useEffect(()=>{k&&p&&(_!==null&&google.maps.event.removeListener(_),N(google.maps.event.addListener(k,"dragend",p)))},[p]),r.useEffect(()=>{k&&f&&(V!==null&&google.maps.event.removeListener(V),A(google.maps.event.addListener(k,"dragstart",f)))},[f]),r.useEffect(()=>{k&&m&&(z!==null&&google.maps.event.removeListener(z),Z(google.maps.event.addListener(k,"mousedown",m)))},[m]),r.useEffect(()=>{k&&x&&(X!==null&&google.maps.event.removeListener(X),q(google.maps.event.addListener(k,"mousemove",x)))},[x]),r.useEffect(()=>{k&&u&&(H!==null&&google.maps.event.removeListener(H),J(google.maps.event.addListener(k,"mouseout",u)))},[u]),r.useEffect(()=>{k&&h&&(ie!==null&&google.maps.event.removeListener(ie),ne(google.maps.event.addListener(k,"mouseover",h)))},[h]),r.useEffect(()=>{k&&d&&(B!==null&&google.maps.event.removeListener(B),S(google.maps.event.addListener(k,"mouseup",d)))},[d]),r.useEffect(()=>{k&&g&&(C!==null&&google.maps.event.removeListener(C),R(google.maps.event.addListener(k,"rightclick",g)))},[g]),r.useEffect(()=>{k&&y&&($!==null&&google.maps.event.removeListener($),F(google.maps.event.addListener(k,"click",y)))},[y]),r.useEffect(()=>{k&&E&&(G!==null&&google.maps.event.removeListener(G),T(google.maps.event.addListener(k,"drag",E)))},[E]),r.useEffect(()=>{k&&j&&(U!==null&&google.maps.event.removeListener(U),re(google.maps.event.addListener(k,"center_changed",j)))},[y]),r.useEffect(()=>{k&&O&&(xe!==null&&google.maps.event.removeListener(xe),je(google.maps.event.addListener(k,"radius_changed",O)))},[O]),r.useEffect(()=>{var oe=new google.maps.Circle(_t(_t({},e||Fo),{},{map:L}));return typeof i=="number"&&oe.setRadius(i),typeof n<"u"&&oe.setCenter(n),typeof i=="number"&&oe.setRadius(i),typeof l<"u"&&oe.setVisible(l),typeof s<"u"&&oe.setEditable(s),typeof a<"u"&&oe.setDraggable(a),c&&P(google.maps.event.addListener(oe,"dblclick",c)),p&&N(google.maps.event.addListener(oe,"dragend",p)),f&&A(google.maps.event.addListener(oe,"dragstart",f)),m&&Z(google.maps.event.addListener(oe,"mousedown",m)),x&&q(google.maps.event.addListener(oe,"mousemove",x)),u&&J(google.maps.event.addListener(oe,"mouseout",u)),h&&ne(google.maps.event.addListener(oe,"mouseover",h)),d&&S(google.maps.event.addListener(oe,"mouseup",d)),g&&R(google.maps.event.addListener(oe,"rightclick",g)),y&&F(google.maps.event.addListener(oe,"click",y)),E&&T(google.maps.event.addListener(oe,"drag",E)),j&&re(google.maps.event.addListener(oe,"center_changed",j)),O&&je(google.maps.event.addListener(oe,"radius_changed",O)),D(oe),v&&v(oe),()=>{w!==null&&google.maps.event.removeListener(w),_!==null&&google.maps.event.removeListener(_),V!==null&&google.maps.event.removeListener(V),z!==null&&google.maps.event.removeListener(z),X!==null&&google.maps.event.removeListener(X),H!==null&&google.maps.event.removeListener(H),ie!==null&&google.maps.event.removeListener(ie),B!==null&&google.maps.event.removeListener(B),C!==null&&google.maps.event.removeListener(C),$!==null&&google.maps.event.removeListener($),U!==null&&google.maps.event.removeListener(U),xe!==null&&google.maps.event.removeListener(xe),b&&b(oe),oe.setMap(null)}},[]),null}r.memo(Uo);class Bo extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{circle:null}),M(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var e=new google.maps.Circle(_t(_t({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:hi,eventMap:gi,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{circle:e}},this.setCircleCallback)}componentDidUpdate(e){this.state.circle!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:hi,eventMap:gi,prevProps:e,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var e;this.props.onUnmount&&this.props.onUnmount(this.state.circle),te(this.registeredEvents),(e=this.state.circle)===null||e===void 0||e.setMap(null)}}render(){return null}}M(Bo,"contextType",Y);function vi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function It(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?vi(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vi(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var xi={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},yi={add(t,e){t.add(e)},addgeojson(t,e,n){t.addGeoJson(e,n)},contains(t,e){t.contains(e)},foreach(t,e){t.forEach(e)},loadgeojson(t,e,n,i){t.loadGeoJson(e,n,i)},overridestyle(t,e,n){t.overrideStyle(e,n)},remove(t,e){t.remove(e)},revertstyle(t,e){t.revertStyle(e)},controlposition(t,e){t.setControlPosition(e)},controls(t,e){t.setControls(e)},drawingmode(t,e){t.setDrawingMode(e)},map(t,e){t.setMap(e)},style(t,e){t.setStyle(e)},togeojson(t,e){t.toGeoJson(e)}};function $o(t){var{options:e,onClick:n,onDblClick:i,onMouseDown:a,onMouseMove:s,onMouseOut:l,onMouseOver:c,onMouseUp:p,onRightClick:f,onAddFeature:m,onRemoveFeature:x,onRemoveProperty:u,onSetGeometry:h,onSetProperty:d,onLoad:g,onUnmount:y}=t,E=r.useContext(Y),[j,O]=r.useState(null),[v,b]=r.useState(null),[L,k]=r.useState(null),[D,w]=r.useState(null),[P,_]=r.useState(null),[N,V]=r.useState(null),[A,z]=r.useState(null),[Z,X]=r.useState(null),[q,H]=r.useState(null),[J,ie]=r.useState(null),[ne,B]=r.useState(null),[S,C]=r.useState(null),[R,$]=r.useState(null),[F,G]=r.useState(null);return r.useEffect(()=>{j!==null&&j.setMap(E)},[E]),r.useEffect(()=>{j&&i&&(v!==null&&google.maps.event.removeListener(v),b(google.maps.event.addListener(j,"dblclick",i)))},[i]),r.useEffect(()=>{j&&a&&(L!==null&&google.maps.event.removeListener(L),k(google.maps.event.addListener(j,"mousedown",a)))},[a]),r.useEffect(()=>{j&&s&&(D!==null&&google.maps.event.removeListener(D),w(google.maps.event.addListener(j,"mousemove",s)))},[s]),r.useEffect(()=>{j&&l&&(P!==null&&google.maps.event.removeListener(P),_(google.maps.event.addListener(j,"mouseout",l)))},[l]),r.useEffect(()=>{j&&c&&(N!==null&&google.maps.event.removeListener(N),V(google.maps.event.addListener(j,"mouseover",c)))},[c]),r.useEffect(()=>{j&&p&&(A!==null&&google.maps.event.removeListener(A),z(google.maps.event.addListener(j,"mouseup",p)))},[p]),r.useEffect(()=>{j&&f&&(Z!==null&&google.maps.event.removeListener(Z),X(google.maps.event.addListener(j,"rightclick",f)))},[f]),r.useEffect(()=>{j&&n&&(q!==null&&google.maps.event.removeListener(q),H(google.maps.event.addListener(j,"click",n)))},[n]),r.useEffect(()=>{j&&m&&(J!==null&&google.maps.event.removeListener(J),ie(google.maps.event.addListener(j,"addfeature",m)))},[m]),r.useEffect(()=>{j&&x&&(ne!==null&&google.maps.event.removeListener(ne),B(google.maps.event.addListener(j,"removefeature",x)))},[x]),r.useEffect(()=>{j&&u&&(S!==null&&google.maps.event.removeListener(S),C(google.maps.event.addListener(j,"removeproperty",u)))},[u]),r.useEffect(()=>{j&&h&&(R!==null&&google.maps.event.removeListener(R),$(google.maps.event.addListener(j,"setgeometry",h)))},[h]),r.useEffect(()=>{j&&d&&(F!==null&&google.maps.event.removeListener(F),G(google.maps.event.addListener(j,"setproperty",d)))},[d]),r.useEffect(()=>{if(E!==null){var T=new google.maps.Data(It(It({},e),{},{map:E}));i&&b(google.maps.event.addListener(T,"dblclick",i)),a&&k(google.maps.event.addListener(T,"mousedown",a)),s&&w(google.maps.event.addListener(T,"mousemove",s)),l&&_(google.maps.event.addListener(T,"mouseout",l)),c&&V(google.maps.event.addListener(T,"mouseover",c)),p&&z(google.maps.event.addListener(T,"mouseup",p)),f&&X(google.maps.event.addListener(T,"rightclick",f)),n&&H(google.maps.event.addListener(T,"click",n)),m&&ie(google.maps.event.addListener(T,"addfeature",m)),x&&B(google.maps.event.addListener(T,"removefeature",x)),u&&C(google.maps.event.addListener(T,"removeproperty",u)),h&&$(google.maps.event.addListener(T,"setgeometry",h)),d&&G(google.maps.event.addListener(T,"setproperty",d)),O(T),g&&g(T)}return()=>{j&&(v!==null&&google.maps.event.removeListener(v),L!==null&&google.maps.event.removeListener(L),D!==null&&google.maps.event.removeListener(D),P!==null&&google.maps.event.removeListener(P),N!==null&&google.maps.event.removeListener(N),A!==null&&google.maps.event.removeListener(A),Z!==null&&google.maps.event.removeListener(Z),q!==null&&google.maps.event.removeListener(q),J!==null&&google.maps.event.removeListener(J),ne!==null&&google.maps.event.removeListener(ne),S!==null&&google.maps.event.removeListener(S),R!==null&&google.maps.event.removeListener(R),F!==null&&google.maps.event.removeListener(F),y&&y(j),j.setMap(null))}},[]),null}r.memo($o);class Wo extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{data:null}),M(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var e=new google.maps.Data(It(It({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:yi,eventMap:xi,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({data:e}),this.setDataCallback)}}componentDidUpdate(e){this.state.data!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:yi,eventMap:xi,prevProps:e,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),te(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}M(Wo,"contextType",Y);function bi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function wi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?bi(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bi(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var Li={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},Ei={options(t,e){t.setOptions(e)},url(t,e){t.setUrl(e)},zIndex(t,e){t.setZIndex(e)}};class Vo extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{kmlLayer:null}),M(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var e=new google.maps.KmlLayer(wi(wi({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:Ei,eventMap:Li,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{kmlLayer:e}},this.setKmlLayerCallback)}componentDidUpdate(e){this.state.kmlLayer!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Ei,eventMap:Li,prevProps:e,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),te(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}M(Vo,"contextType",Y);function Ta(t,e){return typeof e=="function"?e(t.offsetWidth,t.offsetHeight):{x:0,y:0}}function qo(t,e){return new e(t.lat,t.lng)}function Ho(t,e){return new e(new google.maps.LatLng(t.ne.lat,t.ne.lng),new google.maps.LatLng(t.sw.lat,t.sw.lng))}function Zo(t,e,n){return t instanceof e?t:n(t,e)}function Go(t,e,n){return t instanceof e?t:n(t,e)}function Ko(t,e,n){var i=t&&t.fromLatLngToDivPixel(n.getNorthEast()),a=t&&t.fromLatLngToDivPixel(n.getSouthWest());return i&&a?{left:"".concat(a.x+e.x,"px"),top:"".concat(i.y+e.y,"px"),width:"".concat(i.x-a.x-e.x,"px"),height:"".concat(a.y-i.y-e.y,"px")}:{left:"-9999px",top:"-9999px"}}function Yo(t,e,n){var i=t&&t.fromLatLngToDivPixel(n);if(i){var{x:a,y:s}=i;return{left:"".concat(a+e.x,"px"),top:"".concat(s+e.y,"px")}}return{left:"-9999px",top:"-9999px"}}function Aa(t,e,n,i){return n!==void 0?Ko(t,e,Go(n,google.maps.LatLngBounds,Ho)):Yo(t,e,Zo(i,google.maps.LatLng,qo))}function Xo(t,e){return t.left===e.left&&t.top===e.top&&t.width===e.height&&t.height===e.height}function Ci(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Qo(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ci(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ci(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Jo(t,e,n,i,a){class s extends google.maps.OverlayView{constructor(c,p,f,m){super(),this.container=c,this.pane=p,this.position=f,this.bounds=m}onAdd(){var c,p=(c=this.getPanes())===null||c===void 0?void 0:c[this.pane];p?.appendChild(this.container)}draw(){var c=this.getProjection(),p=Qo({},this.container?Ta(this.container,a):{x:0,y:0}),f=Aa(c,p,this.bounds,this.position);for(var[m,x]of Object.entries(f))this.container.style[m]=x}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new s(t,e,n,i)}function ji(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function el(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ji(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ji(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function ki(t){if(!t)return"";var e=t instanceof google.maps.LatLng?t:new google.maps.LatLng(t.lat,t.lng);return e+""}function Mi(t){if(!t)return"";var e=t instanceof google.maps.LatLngBounds?t:new google.maps.LatLngBounds(new google.maps.LatLng(t.south,t.east),new google.maps.LatLng(t.north,t.west));return e+""}function tl(t){var{position:e,bounds:n,mapPaneName:i,zIndex:a,onLoad:s,onUnmount:l,getPixelPositionOffset:c,children:p}=t,f=r.useContext(Y),m=r.useMemo(()=>{var u=document.createElement("div");return u.style.position="absolute",u},[]),x=r.useMemo(()=>Jo(m,i,e,n,c),[m,i,e,n]);return r.useEffect(()=>(s?.(x),x?.setMap(f),()=>{l?.(x),x?.setMap(null)}),[f,x]),r.useEffect(()=>{m.style.zIndex="".concat(a)},[a,m]),et.createPortal(p,m)}r.memo(tl);class tt extends r.PureComponent{constructor(e){super(e),M(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),M(this,"updatePane",()=>{var i=this.props.mapPaneName,a=this.overlayView.getPanes();ue(!!i,"OverlayView requires props.mapPaneName but got %s",i),a?this.setState({paneEl:a[i]}):this.setState({paneEl:null})}),M(this,"onAdd",()=>{var i,a;this.updatePane(),(i=(a=this.props).onLoad)===null||i===void 0||i.call(a,this.overlayView)}),M(this,"onPositionElement",()=>{var i=this.overlayView.getProjection(),a=el({x:0,y:0},this.containerRef.current?Ta(this.containerRef.current,this.props.getPixelPositionOffset):{}),s=Aa(i,a,this.props.bounds,this.props.position);if(!Xo(s,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var l,c,p,f;this.setState({containerStyle:{top:(l=s.top)!==null&&l!==void 0?l:0,left:(c=s.left)!==null&&c!==void 0?c:0,width:(p=s.width)!==null&&p!==void 0?p:0,height:(f=s.height)!==null&&f!==void 0?f:0,position:"absolute"}})}}),M(this,"draw",()=>{this.onPositionElement()}),M(this,"onRemove",()=>{var i,a;this.setState(()=>({paneEl:null})),(i=(a=this.props).onUnmount)===null||i===void 0||i.call(a,this.overlayView)}),this.containerRef=r.createRef();var n=new google.maps.OverlayView;n.onAdd=this.onAdd,n.draw=this.draw,n.onRemove=this.onRemove,this.overlayView=n}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(e){var n=ki(e.position),i=ki(this.props.position),a=Mi(e.bounds),s=Mi(this.props.bounds);(n!==i||a!==s)&&this.overlayView.draw(),e.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var e=this.state.paneEl;return e?et.createPortal(o.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:r.Children.only(this.props.children)}),e):null}}M(tt,"FLOAT_PANE","floatPane");M(tt,"MAP_PANE","mapPane");M(tt,"MARKER_LAYER","markerLayer");M(tt,"OVERLAY_LAYER","overlayLayer");M(tt,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");M(tt,"contextType",Y);function nl(){}function Si(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Oi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Si(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Si(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var Pi={onDblClick:"dblclick",onClick:"click"},Di={opacity(t,e){t.setOpacity(e)}};function il(t){var{url:e,bounds:n,options:i,visible:a}=t,s=r.useContext(Y),l=new google.maps.LatLngBounds(new google.maps.LatLng(n.south,n.west),new google.maps.LatLng(n.north,n.east)),c=r.useMemo(()=>new google.maps.GroundOverlay(e,l,i),[]);return r.useEffect(()=>{c!==null&&c.setMap(s)},[s]),r.useEffect(()=>{typeof e<"u"&&c!==null&&(c.set("url",e),c.setMap(s))},[c,e]),r.useEffect(()=>{typeof a<"u"&&c!==null&&c.setOpacity(a?1:0)},[c,a]),r.useEffect(()=>{var p=new google.maps.LatLngBounds(new google.maps.LatLng(n.south,n.west),new google.maps.LatLng(n.north,n.east));typeof n<"u"&&c!==null&&(c.set("bounds",p),c.setMap(s))},[c,n]),null}r.memo(il);class za extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{groundOverlay:null}),M(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){ue(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var e=new google.maps.GroundOverlay(this.props.url,this.props.bounds,Oi(Oi({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:Di,eventMap:Pi,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{groundOverlay:e}},this.setGroundOverlayCallback)}componentDidUpdate(e){this.state.groundOverlay!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Di,eventMap:Pi,prevProps:e,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}M(za,"defaultProps",{onLoad:nl});M(za,"contextType",Y);function Ni(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Rt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ni(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ni(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var _i={},Ii={data(t,e){t.setData(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)}};function al(t){var{data:e,onLoad:n,onUnmount:i,options:a}=t,s=r.useContext(Y),[l,c]=r.useState(null);return r.useEffect(()=>{google.maps.visualization||ue(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),r.useEffect(()=>{ue(!!e,"data property is required in HeatmapLayer %s",e)},[e]),r.useEffect(()=>{l!==null&&l.setMap(s)},[s]),r.useEffect(()=>{a&&l!==null&&l.setOptions(a)},[l,a]),r.useEffect(()=>{var p=new google.maps.visualization.HeatmapLayer(Rt(Rt({},a),{},{data:e,map:s}));return c(p),n&&n(p),()=>{l!==null&&(i&&i(l),l.setMap(null))}},[]),null}r.memo(al);class sl extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{heatmapLayer:null}),M(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){ue(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),ue(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var e=new google.maps.visualization.HeatmapLayer(Rt(Rt({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=ee({updaterMap:Ii,eventMap:_i,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{heatmapLayer:e}},this.setHeatmapLayerCallback)}componentDidUpdate(e){te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Ii,eventMap:_i,prevProps:e,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),te(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}M(sl,"contextType",Y);var Ri={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},Ti={register(t,e,n){t.registerPanoProvider(e,n)},links(t,e){t.setLinks(e)},motionTracking(t,e){t.setMotionTracking(e)},options(t,e){t.setOptions(e)},pano(t,e){t.setPano(e)},position(t,e){t.setPosition(e)},pov(t,e){t.setPov(e)},visible(t,e){t.setVisible(e)},zoom(t,e){t.setZoom(e)}};class rl extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{streetViewPanorama:null}),M(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var e,n,i=(e=(n=this.context)===null||n===void 0?void 0:n.getStreetView())!==null&&e!==void 0?e:null;this.registeredEvents=ee({updaterMap:Ti,eventMap:Ri,prevProps:{},nextProps:this.props,instance:i}),this.setState(()=>({streetViewPanorama:i}),this.setStreetViewPanoramaCallback)}componentDidUpdate(e){this.state.streetViewPanorama!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Ti,eventMap:Ri,prevProps:e,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),te(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}M(rl,"contextType",Y);class ol extends r.PureComponent{constructor(){super(...arguments),M(this,"state",{streetViewService:null}),M(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var e=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:e}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}M(ol,"contextType",Y);var Ai={onDirectionsChanged:"directions_changed"},zi={directions(t,e){t.setDirections(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},panel(t,e){t.setPanel(e)},routeIndex(t,e){t.setRouteIndex(e)}};class ll extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{directionsRenderer:null}),M(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var e=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=ee({updaterMap:zi,eventMap:Ai,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{directionsRenderer:e}},this.setDirectionsRendererCallback)}componentDidUpdate(e){this.state.directionsRenderer!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:zi,eventMap:Ai,prevProps:e,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),te(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}M(ll,"contextType",Y);var Fi={onPlacesChanged:"places_changed"},Ui={bounds(t,e){t.setBounds(e)}};class cl extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"containerElement",r.createRef()),M(this,"state",{searchBox:null}),M(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(ue(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var e=this.containerElement.current.querySelector("input");if(e!==null){var n=new google.maps.places.SearchBox(e,this.props.options);this.registeredEvents=ee({updaterMap:Ui,eventMap:Fi,prevProps:{},nextProps:this.props,instance:n}),this.setState(function(){return{searchBox:n}},this.setSearchBoxCallback)}}}componentDidUpdate(e){this.state.searchBox!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Ui,eventMap:Fi,prevProps:e,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),te(this.registeredEvents))}render(){return o.jsx("div",{ref:this.containerElement,children:r.Children.only(this.props.children)})}}M(cl,"contextType",Y);var Bi={onPlaceChanged:"place_changed"},$i={bounds(t,e){t.setBounds(e)},restrictions(t,e){t.setComponentRestrictions(e)},fields(t,e){t.setFields(e)},options(t,e){t.setOptions(e)},types(t,e){t.setTypes(e)}};class Fa extends r.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"containerElement",r.createRef()),M(this,"state",{autocomplete:null}),M(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var e;ue(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var n=(e=this.containerElement.current)===null||e===void 0?void 0:e.querySelector("input");if(n){var i=new google.maps.places.Autocomplete(n,this.props.options);this.registeredEvents=ee({updaterMap:$i,eventMap:Bi,prevProps:{},nextProps:this.props,instance:i}),this.setState(()=>({autocomplete:i}),this.setAutocompleteCallback)}}componentDidUpdate(e){te(this.registeredEvents),this.registeredEvents=ee({updaterMap:$i,eventMap:Bi,prevProps:e,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&te(this.registeredEvents)}render(){return o.jsx("div",{ref:this.containerElement,className:this.props.className,children:r.Children.only(this.props.children)})}}M(Fa,"defaultProps",{className:""});M(Fa,"contextType",Y);const pl=["places"],ln=({location:t,onLocationChange:e,height:n="100%",className:i})=>{const{isLoaded:a}=zr({id:"google-map-script",googleMapsApiKey:"AIzaSyAfp-MrsswDkw8NAgm5CYvpcKAG_Ia8c2w",libraries:pl,version:"weekly"}),[s,l]=Ne.useState(null),[c,p]=Ne.useState(null),f=Ne.useRef(null);return Ne.useEffect(()=>{if(a&&f.current&&!c){const m=new window.google.maps.places.SearchBox(f.current);p(m),m.addListener("places_changed",()=>{const x=m.getPlaces();if(!x||x.length===0)return;const u=x[0];!u.geometry||!u.geometry.location||(e({lat:u.geometry.location.lat(),lng:u.geometry.location.lng(),name:u.name||u.formatted_address||""}),s&&(s.panTo(u.geometry.location),s.setZoom(15)))})}return()=>{c&&window.google.maps.event.clearInstanceListeners(c)}},[a,c,s,e]),a?o.jsxs("div",{className:i,children:[o.jsx("div",{className:"relative",children:o.jsx("input",{ref:f,type:"text",placeholder:"Search for a location...",className:"ios-input w-full mb-2",defaultValue:t.name})}),o.jsx("div",{style:{height:n,width:"100%"},className:"rounded-apple overflow-hidden",children:o.jsx(kr,{mapContainerStyle:{width:"100%",height:"100%"},center:t.lat&&t.lng?t:{lat:0,lng:0},zoom:t.lat&&t.lng?15:1,onClick:m=>{m.latLng&&e({lat:m.latLng.lat(),lng:m.latLng.lng(),name:t.name||`${m.latLng.lat()}, ${m.latLng.lng()}`})},onLoad:l,options:{mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1},children:t.lat&&t.lng&&o.jsx(Pa,{position:t})})})]}):o.jsx("div",{className:"h-64 bg-apple-gray-100 rounded-apple flex items-center justify-center",children:o.jsx(Wa,{className:"w-8 h-8 text-apple-gray-400 animate-spin"})})},dl=({eventId:t,onUploadComplete:e,onError:n})=>{const{user:i}=Tt(),[a,s]=r.useState([]),[l,c]=r.useState({mode:"grid",sortBy:"date"}),[p,f]=r.useState(""),[m,x]=r.useState(null),[u,h]=r.useState({}),[d,g]=r.useState(null),[y,E]=r.useState(""),[j,O]=r.useState(0),[v]=r.useState(10*1024*1024*1024),[b,L]=r.useState({eventName:"",venueName:"",location:{lat:0,lng:0,name:""},promoterName:"",date:new Date().toISOString().split("T")[0]}),[k,D]=r.useState(!1),[w,P]=r.useState([]),[_,N]=r.useState(null);r.useEffect(()=>{(async()=>{if(i)try{const{data:C,error:R}=await Re.getUserStorageUsage(i.id);!R&&C&&O(C.total_size)}catch(C){console.error("Error fetching storage usage:",C)}})()},[i]);const V=()=>b.eventName.trim()?b.venueName.trim()?b.promoterName.trim()?b.date?!0:(n?.("Date is required"),!1):(n?.("Promoter name is required"),!1):(n?.("Venue name is required"),!1):(n?.("Event name is required"),!1),A=r.useCallback(async S=>{const C=S.reduce((R,$)=>R+$.size,0);if(j+C>v){n?.("Upload would exceed your 10GB storage limit");return}P(S),D(!0)},[j,v,n]),z=async()=>{if(!V())return;const S={...u},C=[];w.forEach(R=>{const F=(R.webkitRelativePath||R.name).split("/");F.pop();let G=S;F.forEach(U=>{G[U]||(G[U]={name:U,files:[],subfolders:{}}),G=G[U].subfolders});const T={id:Math.random().toString(36).substring(7),file:R,progress:0,status:"pending",folderPath:F.length?F.join("/"):null};C.push(T)}),h(S),s(R=>[...R,...C]);for(const R of C)try{s(T=>T.map(U=>U.id===R.id?{...U,status:"uploading"}:U));const $=setInterval(()=>{s(T=>T.map(U=>U.id===R.id&&U.status==="uploading"&&U.progress<90?{...U,progress:U.progress+10}:U))},200),F={title:R.file.name,event_details:{name:b.eventName,date:b.date,promoter:b.promoterName},venue:{name:b.venueName},location:b.location.name?b.location:void 0,date_taken:b.date},G=await Re.uploadPhoto(R.file,t,R.folderPath,F);if(clearInterval($),G.success){const T={...R,status:"complete",progress:100,photoId:G.photoId,photoDetails:G.photoMetadata};s(U=>U.map(re=>re.id===R.id?T:re)),e?.(G.photoId),O(U=>U+R.file.size)}else throw new Error(G.error)}catch($){s(F=>F.map(G=>G.id===R.id?{...G,status:"error",error:$.message}:G)),n?.($.message)}D(!1),P([])},{getRootProps:Z,getInputProps:X,isDragActive:q}=Ca({onDrop:A,accept:{"image/jpeg":[".jpg",".jpeg"],"image/png":[".png"],"image/webp":[".webp"],"image/x-canon-cr2":[".cr2"],"image/x-nikon-nef":[".nef"],"image/x-sony-arw":[".arw"],"image/x-panasonic-rw2":[".rw2"]},maxSize:104857600,disabled:k,noClick:k,noKeyboard:k}),H=async(S,C)=>{try{await Re.renameFolder(S,C),s($=>$.map(F=>{if(F.folderPath?.startsWith(S)){const G=F.folderPath.replace(S,C);return{...F,folderPath:G}}return F}));const R=($,F,G)=>{if(F.length===0)return $;const[T,...U]=F,re={...$};return U.length===0?re[T]&&(re[G]={...re[T],name:G},delete re[T]):re[T]&&(re[T]={...re[T],subfolders:R(re[T].subfolders,U,G)}),re};h($=>R($,S.split("/"),C)),g(null),E("")}catch{n?.("Failed to rename folder")}},J=a.filter(S=>p?S.file.name.toLowerCase().includes(p.toLowerCase()):m?S.folderPath===m:!0).sort((S,C)=>{switch(l.sortBy){case"name":return S.file.name.localeCompare(C.file.name);case"size":return C.file.size-S.file.size;case"date":default:return C.file.lastModified-S.file.lastModified}}),ie=S=>{const C=a.find(R=>R.id===S);C&&C.status==="complete"&&O(R=>R-C.file.size),s(R=>R.filter($=>$.id!==S))},ne=(S,C="")=>Object.entries(S).map(([R,$])=>o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-2 bg-apple-gray-50 rounded-apple",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Ha,{className:"w-4 h-4 text-apple-gray-400 mr-2"}),d===C+R?o.jsx("input",{type:"text",value:y,onChange:F=>E(F.target.value),onBlur:()=>{y&&y!==$.name?H(C+R,y):(g(null),E(""))},onKeyPress:F=>{F.key==="Enter"&&y&&y!==$.name&&H(C+R,y)},className:"px-2 py-1 rounded-apple text-sm",autoFocus:!0}):o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-sm font-medium",children:$.name}),o.jsx("button",{onClick:()=>{g(C+R),E($.name)},className:"ml-2 text-apple-gray-400 hover:text-apple-gray-600",children:o.jsx(Za,{className:"w-3 h-3"})})]})]}),o.jsxs("span",{className:"text-xs text-apple-gray-500",children:[$.files.length," files"]})]}),o.jsx("div",{className:"ml-4",children:ne($.subfolders,C+R+"/")})]},C+R)),B=S=>S.photoDetails?o.jsx("div",{className:"mt-4 space-y-4",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium mb-2",children:"Photo Information"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[o.jsx(Ie,{className:"w-4 h-4 text-apple-gray-500 mr-2"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium",children:"Date Taken"}),o.jsx("div",{className:"text-xs text-apple-gray-500",children:new Date(S.photoDetails.date_taken||S.photoDetails.created_at).toLocaleDateString()})]})]}),o.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[o.jsx(Vt,{className:"w-4 h-4 text-apple-gray-500 mr-2"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium",children:"Location"}),o.jsx("div",{className:"text-xs text-apple-gray-500",children:S.photoDetails.location?.name||"Unknown"})]})]})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium mb-2",children:"Face Detection"}),o.jsx("div",{className:"space-y-2",children:S.photoDetails.matched_users?.length?S.photoDetails.matched_users.map((C,R)=>o.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[o.jsx(Qe,{className:"w-4 h-4 text-apple-gray-500 mr-2"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium",children:C.fullName}),o.jsxs("div",{className:"text-xs text-apple-gray-500",children:[Math.round(C.confidence),"% match"]})]})]},R)):o.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[o.jsx(ct,{className:"w-4 h-4 text-apple-gray-500 mr-2"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium",children:"No Matches Found"}),o.jsx("div",{className:"text-xs text-apple-gray-500",children:"No registered faces were detected"})]})]})})]})]})}):null;return o.jsxs("div",{className:"w-full",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-sm font-medium text-apple-gray-700",children:"Storage Usage"}),o.jsxs("span",{className:"text-sm text-apple-gray-500",children:[(j/1024/1024/1024).toFixed(2),"GB of 10GB"]})]}),o.jsx("div",{className:"h-2 bg-apple-gray-100 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-apple-blue-500 transition-all duration-300",style:{width:`${j/v*100}%`}})})]}),o.jsx(Ye,{children:k&&o.jsxs(he.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-8 p-6 bg-white rounded-apple-xl border border-apple-gray-200",children:[o.jsx("h3",{className:"text-lg font-medium text-apple-gray-900 mb-4",children:"Photo Details"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"ios-label flex items-center",children:[o.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Event Name*"]}),o.jsx("input",{type:"text",value:b.eventName,onChange:S=>L({...b,eventName:S.target.value}),className:"ios-input",placeholder:"Enter event name",required:!0})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"ios-label flex items-center",children:[o.jsx(Hi,{className:"w-4 h-4 mr-2"}),"Venue Name*"]}),o.jsx("input",{type:"text",value:b.venueName,onChange:S=>L({...b,venueName:S.target.value}),className:"ios-input",placeholder:"Enter venue name",required:!0})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"ios-label flex items-center",children:[o.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Promoter Name*"]}),o.jsx("input",{type:"text",value:b.promoterName,onChange:S=>L({...b,promoterName:S.target.value}),className:"ios-input",placeholder:"Enter promoter name",required:!0})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"ios-label flex items-center",children:[o.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Date*"]}),o.jsx("input",{type:"date",value:b.date,onChange:S=>L({...b,date:S.target.value}),className:"ios-input",required:!0})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsxs("label",{className:"ios-label flex items-center",children:[o.jsx(Vt,{className:"w-4 h-4 mr-2"}),"Location (optional)"]}),o.jsx(ln,{location:b.location,onLocationChange:S=>L({...b,location:S}),height:"300px",className:"rounded-apple overflow-hidden"})]})]}),o.jsxs("div",{className:"flex justify-end space-x-4 mt-6",children:[o.jsx("button",{onClick:()=>{D(!1),P([])},className:"ios-button-secondary",children:"Cancel"}),o.jsx("button",{onClick:z,className:"ios-button-primary",children:"Continue Upload"})]})]})}),o.jsxs("div",{...Z(),className:me("mt-4 p-10 border-2 border-dashed rounded-apple-xl text-center transition-colors duration-300",q?"border-apple-blue-500 bg-apple-blue-50":"border-apple-gray-200 bg-apple-gray-50",a.length>0&&"mb-8"),children:[o.jsx("input",{...X(),webkitdirectory:""}),o.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-white flex items-center justify-center",children:o.jsx(Lt,{className:"w-8 h-8 text-apple-gray-500"})}),o.jsx("p",{className:"text-apple-gray-500 mb-2",children:q?"Drop the photos or folders here":"Drag and drop photos or folders here, or click to select"}),o.jsx("p",{className:"text-apple-gray-400 text-sm",children:"Supported formats: JPG, PNG, WebP, RAW (CR2, NEF, ARW, RW2) ‚Ä¢ Max 100MB per file"})]}),a.length>0&&o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("button",{onClick:()=>c(S=>({...S,mode:"grid"})),className:me("p-2 rounded-apple",l.mode==="grid"?"bg-apple-blue-500 text-white":"bg-apple-gray-100 text-apple-gray-600"),children:o.jsx(Va,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>c(S=>({...S,mode:"list"})),className:me("p-2 rounded-apple",l.mode==="list"?"bg-apple-blue-500 text-white":"bg-apple-gray-100 text-apple-gray-600"),children:o.jsx(qa,{className:"w-4 h-4"})}),o.jsx("div",{className:"h-6 w-px bg-apple-gray-200 mx-2"}),o.jsxs("div",{className:"relative",children:[o.jsx(Zi,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-apple-gray-400"}),o.jsx("input",{type:"text",placeholder:"Search uploads...",value:p,onChange:S=>f(S.target.value),className:"pl-9 pr-4 py-2 rounded-apple bg-apple-gray-100 text-sm focus:outline-none focus:ring-2 focus:ring-apple-blue-500"})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("button",{className:"ios-button-secondary flex items-center",children:[o.jsx(Gi,{className:"w-4 h-4 mr-2"}),"Filter"]}),o.jsxs("select",{value:l.sortBy,onChange:S=>c(C=>({...C,sortBy:S.target.value})),className:"ios-input py-2 pl-4 pr-10",children:[o.jsx("option",{value:"date",children:"Sort by Date"}),o.jsx("option",{value:"name",children:"Sort by Name"}),o.jsx("option",{value:"size",children:"Sort by Size"})]})]})]}),Object.keys(u).length>0&&o.jsxs("div",{className:"mb-8",children:[o.jsx("h3",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Folders"}),ne(u)]}),o.jsx(Ye,{children:a.length>0&&o.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:me("grid gap-4",l.mode==="grid"?"grid-cols-1 md:grid-cols-3":"grid-cols-1"),children:J.map(S=>o.jsxs(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:me("bg-white rounded-apple shadow-sm border border-apple-gray-200",l.mode==="list"&&"flex items-center"),children:[o.jsxs("div",{className:me("relative",l.mode==="grid"?"aspect-square":"w-20 h-20"),children:[S.file.type.startsWith("image/")&&o.jsx("img",{src:URL.createObjectURL(S.file),alt:S.file.name,className:"w-full h-full object-cover rounded-tl-apple rounded-tr-apple"}),o.jsxs("div",{className:me("absolute inset-0 bg-black/50 flex items-center justify-center",S.status==="complete"&&"bg-apple-green-500/50",S.status==="error"&&"bg-apple-red-500/50"),children:[S.status==="uploading"&&o.jsx("div",{className:"w-8 h-8 border-2 border-white/30 border-t-white rounded-full animate-spin"}),S.status==="complete"&&o.jsx(Vi,{className:"w-8 h-8 text-white"}),S.status==="error"&&o.jsx(ct,{className:"w-8 h-8 text-white"})]})]}),o.jsxs("div",{className:"p-4 flex-1",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-apple-gray-900 truncate",children:S.file.name}),o.jsxs("p",{className:"text-sm text-apple-gray-500",children:[S.folderPath&&o.jsxs("span",{className:"text-apple-gray-400",children:[S.folderPath," /"]})," ",(S.file.size/1024/1024).toFixed(2)," MB"]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[S.status==="complete"&&o.jsx("button",{onClick:()=>N(S),className:"text-apple-gray-400 hover:text-apple-gray-600",children:o.jsx(Ki,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>ie(S.id),className:"text-apple-gray-400 hover:text-apple-gray-600",children:o.jsx(wt,{className:"w-4 h-4"})})]})]}),S.status!=="complete"&&o.jsxs("div",{className:"mt-2",children:[o.jsx("div",{className:"h-1 bg-apple-gray-100 rounded-full overflow-hidden",children:o.jsx("div",{className:me("h-full transition-all duration-300",S.status==="error"?"bg-apple-red-500":"bg-apple-blue-500"),style:{width:`${S.progress}%`}})}),S.error&&o.jsx("p",{className:"mt-1 text-sm text-apple-red-500",children:S.error})]}),S.status==="complete"&&S.photoDetails&&o.jsx("div",{className:"mt-4",children:o.jsx("div",{className:"flex items-center space-x-2",children:S.photoDetails.matched_users?.length?o.jsxs("div",{className:"bg-apple-green-500 text-white px-2 py-1 rounded-full text-sm flex items-center",children:[o.jsx(qt,{className:"w-4 h-4 mr-1"}),S.photoDetails.matched_users.length," ",S.photoDetails.matched_users.length===1?"Match":"Matches"]}):o.jsxs("div",{className:"bg-apple-gray-200 text-apple-gray-600 px-2 py-1 rounded-full text-sm flex items-center",children:[o.jsx(qt,{className:"w-4 h-4 mr-1"}),"No Matches"]})})})]})]},S.id))})}),o.jsx(Ye,{children:_&&_.photoDetails&&o.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/75 backdrop-blur-sm flex items-center justify-center p-4",onClick:()=>N(null),children:o.jsx(he.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"relative max-w-2xl w-full bg-white rounded-apple-2xl overflow-hidden",onClick:S=>S.stopPropagation(),children:o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Photo Details"}),o.jsx("button",{onClick:()=>N(null),className:"text-apple-gray-400 hover:text-apple-gray-600",children:o.jsx(wt,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"aspect-video rounded-apple-xl overflow-hidden mb-6",children:o.jsx("img",{src:URL.createObjectURL(_.file),alt:_.file.name,className:"w-full h-full object-cover"})}),B(_)]})})})})]})},ul=({photo:t,onClose:e,onShare:n})=>{const[i,a]=Ne.useState(!1),[s,l]=Ne.useState(!1),[c,p]=Ne.useState({width:0,height:0}),f=g=>{const y=g.target;p({width:y.naturalWidth,height:y.naturalHeight}),l(!0)},m=async()=>{try{a(!0);const g=await Re.downloadPhoto(t.id),y=document.createElement("a");y.href=g,y.download=`photo-${t.id}.jpg`,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(g)}catch(g){console.error("Error downloading photo:",g)}finally{a(!1)}},x=()=>{if(!t.event_details)return null;const g=[{icon:o.jsx(Ie,{className:"w-4 h-4"}),label:"Event Date",value:new Date(t.event_details.date||t.date_taken||t.created_at).toLocaleDateString()},{icon:o.jsx(Qa,{className:"w-4 h-4"}),label:"Event Name",value:t.event_details.name||"Untitled Event"},{icon:o.jsx(Hi,{className:"w-4 h-4"}),label:"Venue",value:t.venue?.name||"Unknown Venue"},{icon:o.jsx(Ja,{className:"w-4 h-4"}),label:"Promoter",value:t.event_details.promoter||"Unknown"}];return o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Event Information"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:g.map((y,E)=>o.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[o.jsx("div",{className:"mr-2 text-apple-gray-500",children:y.icon}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-apple-gray-900",children:y.label}),o.jsx("div",{className:"text-xs text-apple-gray-500",children:y.value})]})]},E))})]})},u=()=>{const g=[{icon:o.jsx(Ie,{className:"w-4 h-4"}),label:"Date Taken",value:new Date(t.date_taken||t.created_at).toLocaleDateString()},{icon:o.jsx(es,{className:"w-4 h-4"}),label:"File Type",value:t.fileType},{icon:o.jsx(ts,{className:"w-4 h-4"}),label:"File Size",value:`${(t.fileSize/1024/1024).toFixed(2)} MB`},{icon:o.jsx(ea,{className:"w-4 h-4"}),label:"Uploaded",value:new Date(t.created_at).toLocaleString()},{icon:o.jsx(ta,{className:"w-4 h-4"}),label:"Dimensions",value:`${c.width} √ó ${c.height}`},{icon:o.jsx(Lt,{className:"w-4 h-4"}),label:"Uploaded By",value:t.uploadedBy||"Unknown"}];return t.location?.name&&g.push({icon:o.jsx(ns,{className:"w-4 h-4"}),label:"Location",value:t.location.name}),t.tags?.length&&g.push({icon:o.jsx(na,{className:"w-4 h-4"}),label:"Tags",value:t.tags.join(", ")}),o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Photo Information"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:g.map((y,E)=>o.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[o.jsx("div",{className:"mr-2 text-apple-gray-500",children:y.icon}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-apple-gray-900",children:y.label}),o.jsx("div",{className:"text-xs text-apple-gray-500",children:y.value})]})]},E))}),t.location?.lat&&t.location?.lng&&o.jsxs("div",{className:"mt-4",children:[o.jsx("h4",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Location"}),o.jsx("div",{className:"h-48 rounded-apple overflow-hidden",children:o.jsx(ln,{location:{lat:t.location.lat,lng:t.location.lng,name:t.location.name||""},onLocationChange:()=>{},height:"100%",className:"w-full"})})]})]})},h=()=>{if(!t.faces?.length)return null;const g=t.faces[0];if(!g.attributes)return null;const y=g.attributes.emotions?.reduce((j,O)=>O.confidence>j.confidence?O:j),E=[{icon:o.jsx(Ht,{className:"w-4 h-4"}),label:"Expression",value:g.attributes.smile?.value?"Smiling":"Not Smiling",confidence:g.attributes.smile?.confidence},{icon:o.jsx(Qi,{className:"w-4 h-4"}),label:"Eyes",value:g.attributes.eyesOpen?.value?"Open":"Closed",confidence:g.attributes.eyesOpen?.confidence},{icon:o.jsx(Ga,{className:"w-4 h-4"}),label:"Eyewear",value:g.attributes.sunglasses?.value?"Sunglasses":g.attributes.eyeglasses?.value?"Glasses":"None",confidence:g.attributes.sunglasses?.value?g.attributes.sunglasses?.confidence:g.attributes.eyeglasses?.confidence},{icon:o.jsx(Ji,{className:"w-4 h-4"}),label:"Age Range",value:`${g.attributes.age?.low}-${g.attributes.age?.high} years`,confidence:100},{icon:o.jsx(Qe,{className:"w-4 h-4"}),label:"Gender",value:g.attributes.gender?.value,confidence:g.attributes.gender?.confidence},{icon:o.jsx(Ka,{className:"w-4 h-4"}),label:"Emotion",value:y?.type||"Neutral",confidence:y?.confidence},{icon:o.jsx(Ya,{className:"w-4 h-4"}),label:"Facial Hair",value:g.attributes.beard?.value?"Beard":g.attributes.mustache?.value?"Mustache":"None",confidence:g.attributes.beard?.value?g.attributes.beard?.confidence:g.attributes.mustache?.confidence},{icon:o.jsx(Xa,{className:"w-4 h-4"}),label:"Quality",value:`${Math.round(g.attributes.quality?.brightness||0)}% Brightness, ${Math.round(g.attributes.quality?.sharpness||0)}% Sharpness`,confidence:100}];return o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Face Analysis"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:E.map((j,O)=>o.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[o.jsx("div",{className:"mr-2 text-apple-gray-500",children:j.icon}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-apple-gray-900",children:j.label}),o.jsxs("div",{className:"text-xs text-apple-gray-500",children:[j.value," (",Math.round(j.confidence||0),"% confidence)"]})]})]},O))})]})},d=()=>t.matched_users?.length?o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Matched People"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:t.matched_users.map(g=>o.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-apple bg-apple-gray-50",children:[g.avatarUrl?o.jsx("img",{src:g.avatarUrl,alt:g.fullName,className:"w-8 h-8 rounded-full"}):o.jsx("div",{className:"w-8 h-8 rounded-full bg-apple-blue-100 text-apple-blue-500 flex items-center justify-center",children:o.jsx(Qe,{className:"w-4 h-4"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium",children:g.fullName}),o.jsxs("div",{className:"text-xs text-apple-gray-500",children:[Math.round(g.confidence),"% match"]})]})]},g.userId))})]}):o.jsxs("div",{className:"mb-6 p-4 bg-apple-gray-50 rounded-apple text-center",children:[o.jsx(tn,{className:"w-8 h-8 text-apple-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-apple-gray-600 font-medium",children:"No Matches Found"}),o.jsx("p",{className:"text-apple-gray-500 text-sm mt-1",children:"No registered faces were detected in this photo"})]});return o.jsx(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/75 backdrop-blur-sm flex items-center justify-center p-4",onClick:e,children:o.jsx(he.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"relative w-full max-w-5xl bg-white rounded-apple-2xl overflow-hidden",onClick:g=>g.stopPropagation(),children:o.jsxs("div",{className:"flex flex-col md:flex-row h-[85vh]",children:[o.jsx("div",{className:"w-full md:w-3/5 h-full relative",children:o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-apple-gray-100",children:o.jsxs("div",{className:"relative w-full h-full",children:[o.jsx("img",{src:t.url,alt:t.title||"Photo",className:me("absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2","max-w-[95%] max-h-[95%] w-auto h-auto object-contain",!s&&"opacity-0"),onLoad:f}),!s&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-apple-gray-900"})})]})})}),o.jsxs("div",{className:"w-full md:w-2/5 h-full flex flex-col",children:[o.jsxs("div",{className:"p-6 flex-1 overflow-y-auto",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Photo Details"}),o.jsx("button",{onClick:e,className:"text-apple-gray-400 hover:text-apple-gray-600",children:o.jsx(wt,{className:"w-5 h-5"})})]}),(t.title||t.description)&&o.jsxs("div",{className:"mb-6",children:[t.title&&o.jsx("h3",{className:"text-lg font-medium mb-1",children:t.title}),t.description&&o.jsx("p",{className:"text-apple-gray-600 text-sm",children:t.description})]}),h(),x(),u(),d()]}),o.jsx("div",{className:"p-4 border-t border-apple-gray-200 bg-white",children:o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsxs("button",{onClick:m,disabled:i,className:"ios-button-secondary flex items-center",children:[o.jsx(Yi,{className:"w-5 h-5 mr-2"}),"Download"]}),n&&o.jsxs("button",{onClick:()=>n(t.id),className:"ios-button-primary flex items-center",children:[o.jsx(Xi,{className:"w-5 h-5 mr-2"}),"Share"]})]})})]})]})})})},ml=({photos:t,onDelete:e,onShare:n,onDownload:i})=>{const[a,s]=r.useState(null),[l,c]=r.useState({}),p=async f=>{try{if(c({...l,[f.id]:!0}),i)await i(f.id);else{const m=await Re.downloadPhoto(f.id),x=document.createElement("a");x.href=m,x.download=`photo-${f.id}.jpg`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(m)}}catch(m){console.error("Error downloading photo:",m)}finally{c({...l,[f.id]:!1})}};return t.length===0?o.jsxs("div",{className:"text-center py-12 bg-apple-gray-50 rounded-apple-xl border-2 border-dashed border-apple-gray-200",children:[o.jsx(tn,{className:"w-12 h-12 text-apple-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-apple-gray-500 font-medium",children:"No photos found"}),o.jsx("p",{className:"text-apple-gray-400 text-sm mt-1",children:t.length===0?"No photos have been uploaded yet":"No matches found in any photos"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:t.map(f=>o.jsxs(he.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"relative group",children:[o.jsx("div",{className:"aspect-square rounded-apple-xl overflow-hidden",children:o.jsx("img",{src:f.url,alt:f.title||`Photo ${f.id}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"})}),f.faces&&o.jsxs("div",{className:me("absolute top-2 right-2 px-2 py-1 rounded-full text-sm flex items-center gap-1",f.matched_users?.length?"bg-apple-green-500 text-white":"bg-apple-gray-200 text-apple-gray-600"),children:[o.jsx(qt,{className:"w-4 h-4"}),f.matched_users?.length||"No"," ",f.matched_users?.length===1?"Match":"Matches"]}),o.jsx("div",{className:"absolute inset-0 bg-black/50 rounded-apple-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:o.jsxs("div",{className:"absolute bottom-0 inset-x-0 p-4 flex justify-between items-center",children:[o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>p(f),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors duration-300",disabled:l[f.id],children:o.jsx(Yi,{className:"w-5 h-5"})}),n&&o.jsx("button",{onClick:()=>n(f.id),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors duration-300",children:o.jsx(Xi,{className:"w-5 h-5"})}),o.jsx("button",{onClick:()=>s(f),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors duration-300",children:o.jsx(Ki,{className:"w-5 h-5"})})]}),e&&o.jsx("button",{onClick:()=>e(f.id),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors duration-300",children:o.jsx(is,{className:"w-5 h-5"})})]})})]},f.id))}),o.jsx(Ye,{children:a&&o.jsx(ul,{photo:a,onClose:()=>s(null)})})]})},Wi=({eventId:t,mode:e="upload"})=>{const[n,i]=r.useState([]),[a,s]=r.useState(!0),[l,c]=r.useState(null),[p,f]=r.useState(!1),[m,x]=r.useState(""),[u,h]=r.useState({dateRange:{start:"",end:""},location:{lat:0,lng:0,name:""},tags:[],timeRange:{start:"",end:""}}),{user:d}=Tt();r.useEffect(()=>{if(!d)return;console.log("Setting up realtime subscription for photo matches...");const v=se.channel("photo-matches").on("postgres_changes",{event:"UPDATE",schema:"public",table:"photos",filter:e==="matches"?`matched_users::jsonb @> '[{"userId": "${d.id}"}]'`:`uploaded_by=eq.${d.id}`},b=>{console.log("Received realtime update:",b),g()}).subscribe();return()=>{console.log("Cleaning up realtime subscription"),v.unsubscribe()}},[d,e]);const g=async()=>{try{if(s(!0),c(null),!d)return;console.log("Fetching photos...");let v=se.from("photos").select("*");u.dateRange.start&&(v=v.gte("date_taken",u.dateRange.start)),u.dateRange.end&&(v=v.lte("date_taken",u.dateRange.end)),u.location.name&&(v=v.textSearch("location->>name",u.location.name)),u.tags.length>0&&(v=v.contains("tags",u.tags)),m&&(v=v.textSearch("search_vector",m)),e==="upload"?(console.log("Fetching uploaded photos"),v=v.eq("uploaded_by",d.id)):(console.log("Fetching matched photos"),v=v.filter("matched_users","cs",`[{"userId": "${d.id}"}]`)),v=v.order("created_at",{ascending:!1});const{data:b,error:L}=await v;if(L)throw L;console.log(`Fetched ${b?.length||0} photos`);const k=(b||[]).map(D=>({id:D.id,url:D.public_url,eventId:D.event_id,uploadedBy:D.uploaded_by,created_at:D.created_at,folderPath:D.folder_path,folderName:D.folder_name,fileSize:D.file_size,fileType:D.file_type,faces:D.faces||[],title:D.title,description:D.description,location:D.location,venue:D.venue,tags:D.tags,date_taken:D.date_taken,event_details:D.event_details,matched_users:D.matched_users||[]}));i(k)}catch(v){console.error("Error fetching photos:",v),c("Failed to load photos. Please try again.")}finally{s(!1)}};r.useEffect(()=>{d&&g()},[d,t,e,u,m]);const y=async v=>{await g()},E=async v=>{try{await Re.deletePhoto(v),i(n.filter(b=>b.id!==v))}catch(b){console.error("Error deleting photo:",b),c("Failed to delete photo. Please try again.")}},j=async v=>{console.log("Share photo:",v)},O=()=>{h({dateRange:{start:"",end:""},location:{lat:0,lng:0,name:""},tags:[],timeRange:{start:"",end:""}}),x("")};return a?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx(as,{className:"w-8 h-8 text-apple-gray-400 animate-spin"})}):o.jsxs("div",{children:[l&&o.jsxs("div",{className:"mb-6 p-4 bg-red-50 text-red-600 rounded-apple flex items-center",children:[o.jsx(ct,{className:"w-5 h-5 mr-2"}),l]}),e==="upload"&&o.jsx(dl,{eventId:t,onUploadComplete:y,onError:v=>c(v)}),o.jsxs("div",{className:"mt-8 mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"relative flex-1 max-w-lg",children:[o.jsx(Zi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-apple-gray-400 w-5 h-5"}),o.jsx("input",{type:"text",placeholder:"Search photos...",value:m,onChange:v=>x(v.target.value),className:"w-full pl-10 pr-4 py-2 ios-input"})]}),o.jsxs("button",{onClick:()=>f(!p),className:me("ios-button-secondary ml-4 flex items-center",p&&"bg-apple-blue-500 text-white hover:bg-apple-blue-600"),children:[o.jsx(Gi,{className:"w-4 h-4 mr-2"}),"Filters",o.jsx(ia,{className:me("w-4 h-4 ml-2 transition-transform duration-200",p&&"transform rotate-180")})]})]}),o.jsx(Ye,{children:p&&o.jsx(he.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:o.jsxs("div",{className:"p-4 bg-white rounded-apple-xl border border-apple-gray-200 mb-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"ios-label flex items-center",children:[o.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Date Range"]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("input",{type:"date",value:u.dateRange.start,onChange:v=>h({...u,dateRange:{...u.dateRange,start:v.target.value}}),className:"ios-input"}),o.jsx("input",{type:"date",value:u.dateRange.end,onChange:v=>h({...u,dateRange:{...u.dateRange,end:v.target.value}}),className:"ios-input"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"ios-label flex items-center",children:[o.jsx(Vt,{className:"w-4 h-4 mr-2"}),"Location"]}),o.jsx(ln,{location:u.location,onLocationChange:v=>h({...u,location:v}),height:"200px",className:"rounded-apple overflow-hidden"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"ios-label flex items-center",children:[o.jsx(na,{className:"w-4 h-4 mr-2"}),"Tags"]}),o.jsx("input",{type:"text",placeholder:"Add tags...",onKeyDown:v=>{v.key==="Enter"&&v.currentTarget.value&&(h({...u,tags:[...u.tags,v.currentTarget.value]}),v.currentTarget.value="")},className:"ios-input"}),u.tags.length>0&&o.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:u.tags.map((v,b)=>o.jsxs("span",{className:"bg-apple-blue-100 text-apple-blue-700 px-2 py-1 rounded-full text-sm flex items-center",children:[v,o.jsx("button",{onClick:()=>h({...u,tags:u.tags.filter((L,k)=>k!==b)}),className:"ml-1 hover:text-apple-blue-900",children:"√ó"})]},b))})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"ios-label flex items-center",children:[o.jsx(ea,{className:"w-4 h-4 mr-2"}),"Time Range"]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("input",{type:"time",value:u.timeRange.start,onChange:v=>h({...u,timeRange:{...u.timeRange,start:v.target.value}}),className:"ios-input"}),o.jsx("input",{type:"time",value:u.timeRange.end,onChange:v=>h({...u,timeRange:{...u.timeRange,end:v.target.value}}),className:"ios-input"})]})]})]}),o.jsx("div",{className:"flex justify-end mt-4",children:o.jsx("button",{onClick:O,className:"ios-button-secondary",children:"Clear Filters"})})]})})})]}),o.jsx(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:n.length>0?o.jsx(ml,{photos:n,onDelete:e==="upload"?E:void 0,onShare:j}):o.jsx("div",{className:"text-center py-12 bg-apple-gray-50 rounded-apple-xl border-2 border-dashed border-apple-gray-200",children:o.jsx("p",{className:"text-apple-gray-500",children:e==="upload"?"No photos uploaded yet":"No photos found with your face"})})})]})},xl=()=>{const{user:t,signOut:e}=Tt(),[n,i]=r.useState(!1),[a,s]=r.useState("home"),[l,c]=r.useState(!1),[p,f]=r.useState(!1),[m,x]=r.useState(null),[u,h]=r.useState(null);r.useEffect(()=>{(async()=>{if(t)try{const{data:j,error:O}=await se.from("face_data").select("face_data").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(O){if(!O.message.includes("JSON object requested, multiple (or no) rows returned"))throw O;c(!1),x(null),h(null);return}if(j){c(!0),h(j.face_data.attributes||null);const{data:{publicUrl:v}}=se.storage.from("face-data").getPublicUrl(j.face_data.image_path);x(v)}else c(!1),x(null),h(null)}catch(j){console.error("Error fetching face data:",j),c(!1),x(null),h(null)}})()},[t]);const d=()=>{c(!0),f(!1),t&&se.from("face_data").select("face_data").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(1).maybeSingle().then(({data:E,error:j})=>{if(!j&&E){h(E.face_data.attributes||null);const{data:{publicUrl:O}}=se.storage.from("face-data").getPublicUrl(E.face_data.image_path);x(O)}})},g=()=>{if(!u)return null;const E=u.emotions&&u.emotions.length>0?u.emotions.reduce((O,v)=>O.confidence>v.confidence?O:v):null,j=[{icon:o.jsx(Ht,{className:"w-4 h-4"}),label:"Smile",value:u.smile.value?"Yes":"No",confidence:u.smile.confidence},{icon:o.jsx(Qi,{className:"w-4 h-4"}),label:"Eyes Open",value:u.eyesOpen.value?"Yes":"No",confidence:u.eyesOpen.confidence},{icon:o.jsx(Ji,{className:"w-4 h-4"}),label:"Age Range",value:`${u.age.low}-${u.age.high}`,confidence:100},{icon:o.jsx(Ht,{className:"w-4 h-4"}),label:"Emotion",value:E?E.type:"None",confidence:E?E.confidence:0},{icon:o.jsx(Qe,{className:"w-4 h-4"}),label:"Gender",value:u.gender.value,confidence:u.gender.confidence}];return o.jsxs("div",{className:"mt-4 space-y-2",children:[o.jsx("h4",{className:"text-sm font-medium text-apple-gray-700",children:"Face Attributes"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:j.map((O,v)=>o.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[o.jsx("div",{className:"mr-2 text-apple-gray-500",children:O.icon}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-apple-gray-900",children:O.label}),o.jsxs("div",{className:"text-xs text-apple-gray-500",children:[O.value," (",Math.round(O.confidence),"% confidence)"]})]})]},v))})]})},y=()=>{switch(a){case"upload":return o.jsxs("div",{className:"bg-white rounded-apple-2xl shadow-apple p-8 border border-apple-gray-100",children:[o.jsx("div",{className:"flex items-center mb-6",children:o.jsxs("h2",{className:"text-xl font-semibold text-apple-gray-900 flex items-center",children:[o.jsx(Lt,{className:"w-5 h-5 mr-2 text-apple-blue-500"}),"Upload Photos"]})}),o.jsx("p",{className:"text-apple-gray-600 mb-6 border-l-4 border-apple-blue-500 pl-4 py-2 bg-apple-blue-50 rounded-r-apple",children:"Upload photos to be indexed for facial recognition. Other users will be able to find photos they appear in."}),o.jsx(Wi,{mode:"upload"})]});case"photos":return o.jsxs("div",{className:"bg-white rounded-apple-2xl shadow-apple p-8 border border-apple-gray-100",children:[o.jsx("div",{className:"flex items-center justify-between mb-6",children:o.jsxs("h2",{className:"text-xl font-semibold text-apple-gray-900 flex items-center",children:[o.jsx(os,{className:"w-5 h-5 mr-2 text-apple-blue-500"}),"My Photos"]})}),o.jsx("p",{className:"text-apple-gray-600 mb-6 border-l-4 border-apple-blue-500 pl-4 py-2 bg-apple-blue-50 rounded-r-apple",children:"Photos where you have been identified through facial recognition."}),o.jsx(Wi,{mode:"matches"})]});case"events":return o.jsxs("div",{className:"bg-white rounded-apple-2xl shadow-apple p-8 border border-apple-gray-100",children:[o.jsx("div",{className:"flex items-center justify-between mb-6",children:o.jsxs("h2",{className:"text-xl font-semibold text-apple-gray-900 flex items-center",children:[o.jsx(Ie,{className:"w-5 h-5 mr-2 text-apple-blue-500"}),"Events"]})}),o.jsx("p",{className:"text-apple-gray-500",children:"No events found."})]});default:return o.jsxs(o.Fragment,{children:[o.jsxs(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"lg:col-span-2 bg-white rounded-apple-2xl shadow-apple p-8 border border-apple-gray-100",children:[o.jsxs("div",{className:"flex items-center mb-6",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-apple-blue-100 text-apple-blue-700 flex items-center justify-center mr-4 text-xl font-semibold",children:(t?.user_metadata?.full_name?.charAt(0)||t?.email?.charAt(0)||"U").toUpperCase()}),o.jsxs("div",{children:[o.jsxs("h1",{className:"text-2xl font-semibold text-apple-gray-900",children:["Welcome back",t?.user_metadata?.full_name?`, ${t.user_metadata.full_name}`:""]}),o.jsx("p",{className:"text-apple-gray-500",children:l?"Your face is registered":"Complete your profile by registering your face"})]})]}),o.jsx("p",{className:"text-apple-gray-600 mb-6 border-l-4 border-apple-blue-500 pl-4 py-2 bg-apple-blue-50 rounded-r-apple",children:l?"Your face has been registered. You can now use the facial recognition feature for quick authentication.":"Get started by registering your face to enable quick authentication and find your photos at events."}),m&&o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Your Registered Face"}),o.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[o.jsx("div",{className:"relative w-full max-w-xs aspect-square rounded-apple-xl overflow-hidden border border-apple-gray-200",children:o.jsx("img",{src:m,alt:"Registered face",className:"w-full h-full object-contain"})}),g()]})]}),o.jsxs("button",{onClick:()=>f(!0),className:"ios-button-primary flex items-center",children:[o.jsx(qi,{className:"w-5 h-5 mr-2"}),l?"Re-Register Face":"Register Your Face"]})]}),o.jsxs(he.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"bg-white rounded-apple-2xl shadow-apple p-8 border border-apple-gray-100",children:[o.jsxs("h2",{className:"text-lg font-medium text-apple-gray-900 mb-6 flex items-center",children:[o.jsx(rs,{className:"w-5 h-5 mr-2 text-apple-blue-500"}),"Face Recognition Status"]}),o.jsxs("div",{className:"flex items-center p-4 bg-apple-gray-50 rounded-apple mb-4 border border-apple-gray-200",children:[o.jsx("div",{className:`w-3 h-3 rounded-full mr-3 ${l?"bg-apple-green-500":"bg-amber-500"}`}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-apple-gray-900",children:l?"Registered":"Not Registered"}),o.jsx("p",{className:"text-xs text-apple-gray-500 mt-1",children:l?"Last updated: Today":"Register to enhance security"})]})]}),o.jsxs("div",{className:"mt-6",children:[o.jsx("h3",{className:"text-sm font-medium text-apple-gray-900 mb-2",children:"Privacy information"}),o.jsxs("div",{className:"flex items-start text-xs text-apple-gray-600",children:[o.jsx(tn,{className:"w-4 h-4 mr-2 text-apple-gray-400 flex-shrink-0 mt-0.5"}),o.jsx("p",{children:"Your face data is encrypted and stored securely. We never share your biometric data with third parties."})]})]})]})]})}};return o.jsxs("div",{className:"min-h-screen bg-apple-gray-50 font-sans",children:[o.jsx("header",{className:"backdrop-navbar sticky top-0 z-40 pt-ios-safe",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between h-16 items-center",children:[o.jsx("div",{className:"font-bold text-xl",children:o.jsx("img",{src:"https://www.shmong.tv/wp-content/uploads/2023/05/main-logo.png",alt:"SHMONG.tv",className:"h-8"})}),o.jsxs("div",{className:"relative",children:[o.jsxs("button",{onClick:()=>i(!n),className:"flex items-center space-x-2 text-sm text-apple-gray-700 bg-apple-gray-100 px-3 py-2 rounded-apple hover:bg-apple-gray-200 transition-all duration-300",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-apple-blue-100 text-apple-blue-700 flex items-center justify-center",children:t?.email?.charAt(0).toUpperCase()}),o.jsx("span",{className:"hidden md:inline font-medium",children:t?.email}),o.jsx(ia,{className:"h-4 w-4 text-apple-gray-500"})]}),n&&o.jsxs(he.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2},className:"absolute right-0 mt-2 w-56 bg-white rounded-apple-xl shadow-apple-lg py-2 z-10 border border-apple-gray-100",children:[o.jsxs("div",{className:"px-4 py-2 border-b border-apple-gray-100",children:[o.jsx("p",{className:"text-sm font-medium text-apple-gray-900",children:t?.user_metadata?.full_name||"User"}),o.jsx("p",{className:"text-xs text-apple-gray-500 truncate",children:t?.email})]}),o.jsxs("button",{onClick:()=>e(),className:"flex items-center w-full text-left px-4 py-2 text-sm text-apple-red-500 hover:bg-apple-gray-50",children:[o.jsx(ss,{className:"w-4 h-4 mr-2"}),"Sign out"]})]})]})]})})}),o.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-ios-safe",children:[o.jsx("div",{className:"flex overflow-x-auto mb-8 pb-2 no-scrollbar",children:o.jsx("nav",{className:"flex space-x-2 mx-auto bg-apple-gray-200 p-1 rounded-full",children:[{id:"home",name:"Home",icon:o.jsx(Qe,{className:"w-4 h-4"})},{id:"upload",name:"Upload",icon:o.jsx(Lt,{className:"w-4 h-4"})},{id:"photos",name:"My Photos",icon:o.jsx(ta,{className:"w-4 h-4"})},{id:"events",name:"Events",icon:o.jsx(Ie,{className:"w-4 h-4"})}].map(E=>o.jsxs("button",{onClick:()=>s(E.id),className:me("flex items-center px-4 py-2 text-sm font-medium rounded-full whitespace-nowrap transition-all duration-300",a===E.id?"bg-white text-apple-gray-900 shadow-apple-button":"text-apple-gray-600 hover:text-apple-gray-900"),children:[E.icon,o.jsx("span",{className:"ml-2",children:E.name})]},E.id))})}),o.jsx("div",{className:me("grid gap-8",a==="home"?"grid-cols-1 lg:grid-cols-3":"grid-cols-1"),children:y()})]}),o.jsx(Ye,{children:p&&o.jsx(hs,{onSuccess:d,onClose:()=>f(!1)})})]})};export{xl as Dashboard,xl as default};
//# sourceMappingURL=Dashboard-DzzccwH7.js.map
