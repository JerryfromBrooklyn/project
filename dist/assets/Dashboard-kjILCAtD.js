import{j as l,m as ge,X as Lt,i as pt,V as Va,k as Ha,h as Gi,g as Ki,l as Za,A as Xe,n as Re,B as Yi,U as et,o as Ht,p as Et,G as Ga,q as Ka,S as Xi,F as Ji,r as Qi,f as Zt,s as Ya,P as Xa,D as ea,t as ta,u as Gt,c as na,v as Ja,w as ia,x as Qa,y as es,z as ts,H as ns,b as is,J as as,K as ss,d as aa,I as sa,N as os,O as oa,a as sn,Q as rs,R as ls,W as ra,Y as cs,e as ps,_ as ds}from"./ui-vendor-CgFX2fHc.js";import{b as la,r as o,c as us,e as Ie,a as nt}from"./react-vendor-A5uOPIs8.js";import{d as ms,s as V,u as Tt,c as me}from"./index-BGZo0jzH.js";import{R as fs,S as gs,L as ca,D as pa,C as Kt,I as wt,a as hs,b as vs,c as Ct,_ as $e,v as xs}from"./aws-vendor-BQ6H-t6f.js";var da={exports:{}};(function(t,e){(function(i,a){t.exports=a(o)})(us,function(n){return function(i){var a={};function s(r){if(a[r])return a[r].exports;var c=a[r]={i:r,l:!1,exports:{}};return i[r].call(c.exports,c,c.exports,s),c.l=!0,c.exports}return s.m=i,s.c=a,s.d=function(r,c,p){s.o(r,c)||Object.defineProperty(r,c,{enumerable:!0,get:p})},s.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},s.t=function(r,c){if(c&1&&(r=s(r)),c&8||c&4&&typeof r=="object"&&r&&r.__esModule)return r;var p=Object.create(null);if(s.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:r}),c&2&&typeof r!="string")for(var m in r)s.d(p,m,function(g){return r[g]}.bind(null,m));return p},s.n=function(r){var c=r&&r.__esModule?function(){return r.default}:function(){return r};return s.d(c,"a",c),c},s.o=function(r,c){return Object.prototype.hasOwnProperty.call(r,c)},s.p="",s(s.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(i,a,s){s.r(a);var r=s("react"),c=function(){var u=function(f,d){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,b){h.__proto__=b}||function(h,b){for(var L in b)b.hasOwnProperty(L)&&(h[L]=b[L])},u(f,d)};return function(f,d){u(f,d);function h(){this.constructor=f}f.prototype=d===null?Object.create(d):(h.prototype=d.prototype,new h)}}(),p=function(){return p=Object.assign||function(u){for(var f,d=1,h=arguments.length;d<h;d++){f=arguments[d];for(var b in f)Object.prototype.hasOwnProperty.call(f,b)&&(u[b]=f[b])}return u},p.apply(this,arguments)},m=function(u,f){var d={};for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&f.indexOf(h)<0&&(d[h]=u[h]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var b=0,h=Object.getOwnPropertySymbols(u);b<h.length;b++)f.indexOf(h[b])<0&&Object.prototype.propertyIsEnumerable.call(u,h[b])&&(d[h[b]]=u[h[b]]);return d};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(f){var d=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return d?new Promise(function(h,b){d.call(navigator,f,h,b)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function g(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var x=function(u){c(f,u);function f(d){var h=u.call(this,d)||this;return h.canvas=null,h.ctx=null,h.requestUserMediaId=0,h.unmounted=!1,h.state={hasUserMedia:!1},h}return f.prototype.componentDidMount=function(){var d=this,h=d.state,b=d.props;if(this.unmounted=!1,!g()){b.onUserMediaError("getUserMedia not supported");return}h.hasUserMedia||this.requestUserMedia(),b.children&&typeof b.children!="function"&&console.warn("children must be a function")},f.prototype.componentDidUpdate=function(d){var h=this.props;if(!g()){h.onUserMediaError("getUserMedia not supported");return}var b=JSON.stringify(d.audioConstraints)!==JSON.stringify(h.audioConstraints),L=JSON.stringify(d.videoConstraints)!==JSON.stringify(h.videoConstraints),C=d.minScreenshotWidth!==h.minScreenshotWidth,k=d.minScreenshotHeight!==h.minScreenshotHeight;(L||C||k)&&(this.canvas=null,this.ctx=null),(b||L)&&(this.stopAndCleanup(),this.requestUserMedia())},f.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},f.stopMediaStream=function(d){d&&(d.getVideoTracks&&d.getAudioTracks?(d.getVideoTracks().map(function(h){d.removeTrack(h),h.stop()}),d.getAudioTracks().map(function(h){d.removeTrack(h),h.stop()})):d.stop())},f.prototype.stopAndCleanup=function(){var d=this.state;d.hasUserMedia&&(f.stopMediaStream(this.stream),d.src&&window.URL.revokeObjectURL(d.src))},f.prototype.getScreenshot=function(d){var h=this,b=h.state,L=h.props;if(!b.hasUserMedia)return null;var C=this.getCanvas(d);return C&&C.toDataURL(L.screenshotFormat,L.screenshotQuality)},f.prototype.getCanvas=function(d){var h=this,b=h.state,L=h.props;if(!this.video||!b.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var C=this.video.videoWidth,k=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var v=C/k;C=L.minScreenshotWidth||this.video.clientWidth,k=C/v,L.minScreenshotHeight&&k<L.minScreenshotHeight&&(k=L.minScreenshotHeight,C=k*v)}this.canvas=document.createElement("canvas"),this.canvas.width=d?.width||C,this.canvas.height=d?.height||k,this.ctx=this.canvas.getContext("2d")}var y=this,E=y.ctx,w=y.canvas;return E&&w&&(w.width=d?.width||w.width,w.height=d?.height||w.height,L.mirrored&&(E.translate(w.width,0),E.scale(-1,1)),E.imageSmoothingEnabled=L.imageSmoothing,E.drawImage(this.video,0,0,d?.width||w.width,d?.height||w.height),L.mirrored&&(E.scale(-1,1),E.translate(-w.width,0))),w},f.prototype.requestUserMedia=function(){var d=this,h=this.props,b=function(k,v){var y={video:typeof v<"u"?v:!0};h.audio&&(y.audio=typeof k<"u"?k:!0),d.requestUserMediaId++;var E=d.requestUserMediaId;navigator.mediaDevices.getUserMedia(y).then(function(w){d.unmounted||E!==d.requestUserMediaId?f.stopMediaStream(w):d.handleUserMedia(null,w)}).catch(function(w){d.handleUserMedia(w)})};if("mediaDevices"in navigator)b(h.audioConstraints,h.videoConstraints);else{var L=function(k){return{optional:[{sourceId:k}]}},C=function(k){var v=k.deviceId;return typeof v=="string"?v:Array.isArray(v)&&v.length>0?v[0]:typeof v=="object"&&v.ideal?v.ideal:null};MediaStreamTrack.getSources(function(k){var v=null,y=null;k.forEach(function(P){P.kind==="audio"?v=P.id:P.kind==="video"&&(y=P.id)});var E=C(h.audioConstraints);E&&(v=E);var w=C(h.videoConstraints);w&&(y=w),b(L(v),L(y))})}},f.prototype.handleUserMedia=function(d,h){var b=this.props;if(d||!h){this.setState({hasUserMedia:!1}),b.onUserMediaError(d);return}this.stream=h;try{this.video&&(this.video.srcObject=h),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(h)})}b.onUserMedia(h)},f.prototype.render=function(){var d=this,h=this,b=h.state,L=h.props,C=L.audio;L.forceScreenshotSourceSize;var k=L.disablePictureInPicture;L.onUserMedia,L.onUserMediaError,L.screenshotFormat,L.screenshotQuality,L.minScreenshotWidth,L.minScreenshotHeight,L.audioConstraints,L.videoConstraints,L.imageSmoothing;var v=L.mirrored,y=L.style,E=y===void 0?{}:y,w=L.children,P=m(L,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),S=v?p(p({},E),{transform:(E.transform||"")+" scaleX(-1)"}):E,N={getScreenshot:this.getScreenshot.bind(this)};return r.createElement(r.Fragment,null,r.createElement("video",p({autoPlay:!0,disablePictureInPicture:k,src:b.src,muted:!C,playsInline:!0,ref:function(D){d.video=D},style:S},P)),w&&w(N))},f.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},f}(r.Component);a.default=x},react:function(i,a){i.exports=n}}).default})})(da);var ys=da.exports;const bs=la(ys),xn={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_AWS_ACCESS_KEY_ID:"AKIA3ISBVSQ26AGWN3OT",VITE_AWS_COLLECTION_ID:"shmong-faces",VITE_AWS_REGION:"us-east-1",VITE_AWS_SECRET_ACCESS_KEY:"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",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdtdXB3emp4aXJwa3Nrb2xzdWl4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDEyNDU5OTAsImV4cCI6MjA1NjgyMTk5MH0.TRH6LIgIYD4QWaqQxUXxm6HMURqypbkipGMiNuy9PUU",VITE_SUPABASE_URL:"https://gmupwzjxirpkskolsuix.supabase.co"};var yn={};typeof import.meta>"u"&&ms.config();function Ft(t,e){return typeof import.meta<"u"&&xn?xn[t]||yn[t]||e||"":yn[t]||e||""}const ua=Ft("VITE_AWS_REGION","us-east-1"),ma=Ft("VITE_AWS_ACCESS_KEY_ID"),fa=Ft("VITE_AWS_SECRET_ACCESS_KEY"),Ue=80,je=Ft("VITE_AWS_COLLECTION_ID","shmong-faces");new gs({region:ua,credentials:{accessKeyId:ma,secretAccessKey:fa}});const ue=new fs({region:ua,credentials:{accessKeyId:ma,secretAccessKey:fa}}),ws=async()=>{try{if(console.log("Checking for existing face collection..."),(await ue.send(new ca({}))).CollectionIds?.includes(je))console.log("Face collection already exists");else{try{console.log("Attempting to delete existing collection if present..."),await ue.send(new pa({CollectionId:je})),console.log("Existing collection deleted successfully")}catch{console.log("No existing collection found to delete")}console.log("Creating new face collection..."),await ue.send(new Kt({CollectionId:je,Tags:{Environment:"production",Application:"shmong"}})),console.log("Face collection created successfully")}return!0}catch(t){throw console.error("Error initializing face collection:",t),t}};ws().catch(console.error);const Ls={photos:{required:["id","storage_path","public_url","uploaded_by","file_size","file_type"],defaults:{faces:[],matched_users:[],face_ids:[],tags:[],location:{lat:null,lng:null,name:null},venue:{id:null,name:null},event_details:{name:null,date:null,type:null},file_type:"image/jpeg"}},face_data:{required:["user_id","face_id"],defaults:{face_data:{}}},unassociated_faces:{required:["face_id","photo_id","external_image_id"],defaults:{attributes:{}}}},Yt=(t,e)=>{const n=Ls[t];if(!n)throw new Error(`No schema defined for table: ${t}`);const i=n.required.filter(s=>e[s]===void 0||e[s]===null||e[s]==="");if(i.length>0)throw new Error(`Missing required fields for ${t}: ${i.join(", ")}`);const a={...e};return Object.entries(n.defaults).forEach(([s,r])=>{(a[s]===void 0||a[s]===null)&&(a[s]=r)}),n.required.forEach(s=>{if(a[s]===void 0||a[s]===null)throw new Error(`Required field ${s} is missing after validation`)}),a};class he{static async indexFace(e,n){try{console.group("Face Indexing Process"),console.log("üîç Starting face indexing..."),console.log("Step 1: Detecting faces in image...");const i=await this.detectFacesWithRetry(e);if(!i||i.length===0)return console.warn("‚ùå No faces detected in image"),console.groupEnd(),{success:!1,error:"No faces detected in image"};if(i.length>1)return console.warn("‚ùå Multiple faces detected in image"),console.groupEnd(),{success:!1,error:"Only one face can be registered at a time"};console.log("Step 2: Indexing face...");const a=new wt({CollectionId:this.COLLECTION_ID,Image:{Bytes:e},ExternalImageId:n,DetectionAttributes:["ALL"],MaxFaces:1,QualityFilter:"AUTO"}),s=await ue.send(a);if(!s.FaceRecords||s.FaceRecords.length===0)return console.warn("‚ùå No faces indexed"),console.groupEnd(),{success:!1,error:"Failed to index face"};const r=s.FaceRecords[0],c=r.Face?.FaceId;console.log("‚úÖ Face indexed successfully:",c),console.log("Face attributes:",r.FaceDetail),await this.saveFaceData(n,c,r.FaceDetail);const p=`${Date.now()}.jpg`,m=`${n}/${p}`,{data:g,error:x}=await V.storage.from("face-data").upload(m,e,{contentType:"image/jpeg",upsert:!1});if(!x){const{data:{publicUrl:f}}=V.storage.from("face-data").getPublicUrl(m);await V.from("face_data").update({face_data:{aws_face_id:c,attributes:r.FaceDetail,image_path:m,public_url:f}}).eq("user_id",n)}console.log("Step 3: Searching for face matches using FaceId...");const u=await this.searchFacesByFaceId(c,n);return u.length>0?console.log(`‚úÖ Found ${u.length} photos with matching faces`):console.log("No matching photos found"),console.groupEnd(),{success:!0,faceId:c,attributes:r.FaceDetail}}catch(i){return console.error("‚ùå Error indexing face:",i),console.groupEnd(),{success:!1,error:i.message||"Failed to index face"}}}static async saveFaceData(e,n,i){try{const{data:a,error:s}=await V.from("face_data").select("*").eq("user_id",e).maybeSingle();if(s)throw s;const r={aws_face_id:n,attributes:i||{},updated_at:new Date().toISOString()};if(a){const c=Yt("face_data",{user_id:e,face_id:n,face_data:{...a.face_data,aws_face_id:n,attributes:i||a.face_data.attributes},updated_at:new Date().toISOString()}),{error:p}=await V.from("face_data").update(c).eq("id",a.id);if(p)throw p}else{const c=Yt("face_data",{user_id:e,face_id:n,face_data:{aws_face_id:n,attributes:i||{}}}),{error:p}=await V.from("face_data").insert(c);if(p)throw p}console.log(`Face data saved to database: User ${e}, Face ID ${n}`)}catch(a){throw console.error("Error saving face data:",a),a}}static async searchFacesByFaceId(e,n){try{console.log(`Searching for faces matching FaceId: ${e}`);const i=new hs({CollectionId:this.COLLECTION_ID,FaceId:e,FaceMatchThreshold:Ue,MaxFaces:1e3}),a=await ue.send(i);if(!a.FaceMatches?.length)return console.log("No matching faces found"),[];console.log(`Found ${a.FaceMatches.length} matching faces in AWS collection`);const s=a.FaceMatches.map(f=>f.Face?.FaceId||"").filter(f=>!!f);console.log(`Matching face IDs: ${s.slice(0,5).join(", ")}${s.length>5?" (and more)":""}`),console.log("Fetching all photos to check for matches...");const{data:r,error:c}=await V.from("photos").select("id, faces, matched_users, face_ids");if(c)return console.error("Error fetching photos:",c),[];if(!r?.length)return console.log("No photos found in database"),[];console.log(`Fetched ${r.length} photos from database. Checking for matches...`),r.length>0&&console.log("First photo structure:",JSON.stringify(r[0],null,2));const p=r.filter(f=>!!(Array.isArray(f.faces)&&f.faces.some(h=>h.faceId&&s.includes(h.faceId))||Array.isArray(f.face_ids)&&f.face_ids.some(h=>s.includes(h))));if(p.length===0){console.log("No matches found in photos table, checking unassociated_faces table...");try{const{data:f,error:d}=await V.from("unassociated_faces").select("photo_id").in("face_id",s);if(d)console.error("Error checking unassociated_faces:",d);else if(f&&f.length>0){console.log(`Found ${f.length} matches in unassociated_faces table`);const h=[...new Set(f.map(C=>C.photo_id))],{data:b,error:L}=await V.from("photos").select("id, faces, matched_users, face_ids").in("id",h);L?console.error("Error fetching additional photos:",L):b&&b.length>0&&(console.log(`Fetched ${b.length} additional photos`),p.push(...b))}}catch(f){console.error("Error querying unassociated_faces:",f)}}if(!p.length)return console.log("No photos found with matching face IDs after manual filtering"),[];console.log(`Found ${p.length} photos with matching face IDs`);const m=p.filter(f=>Array.isArray(f.matched_users)?!f.matched_users.some(d=>d.userId===n):!0);if(m.length===0)return console.log("User already matched with all photos"),[];console.log(`Found ${m.length} photos to update with new match`);const{data:g,error:x}=await V.from("users").select(`
          id,
          full_name,
          avatar_url,
          user_profiles (
            metadata
          )
        `).eq("id",n).single();if(x||!g)return console.log("User data not found:",x),[];const u=[];for(const f of m){let d=Ue;if(Array.isArray(f.faces)){const k=f.faces.find(v=>v.faceId&&s.includes(v.faceId));k&&k.confidence&&(d=k.confidence)}const h={userId:n,fullName:g.full_name||g?.user_profiles?.[0]?.metadata?.full_name||"Unknown User",avatarUrl:g.avatar_url||g?.user_profiles?.[0]?.metadata?.avatar_url,confidence:d},L=[...Array.isArray(f.matched_users)?f.matched_users:[],h];console.log(`Updating photo ${f.id} with matched user ${n}, confidence: ${d}`);const{error:C}=await V.from("photos").update({matched_users:L}).eq("id",f.id);C?console.error(`Error updating photo ${f.id}:`,C):(u.push(f.id),console.log(`Successfully updated photo ${f.id} with new user match`))}return u}catch(i){return console.error("Error searching faces by FaceId:",i),[]}}static async startBackgroundProcessing(){setInterval(()=>{this.isProcessing||this.processBackgroundTasks()},this.BACKGROUND_INTERVAL)}static async processBackgroundTasks(){if(this.backgroundTasks.length!==0){this.isProcessing=!0,console.log("Processing background tasks:",this.backgroundTasks.length);try{const e=this.backgroundTasks[0];switch(e.status="processing",e.updatedAt=new Date,e.type){case"FACE_REGISTRATION":await this.processFaceRegistration(e);break;case"PHOTO_MATCHING":await this.processPhotoMatching(e);break}this.backgroundTasks.shift()}catch(e){console.error("Error processing background task:",e)}finally{this.isProcessing=!1}}}static async processFaceRegistration(e){console.group("Processing Face Registration");try{const{imageBytes:n,userId:i}=e.data,a=new wt({CollectionId:this.COLLECTION_ID,Image:{Bytes:n},ExternalImageId:i,DetectionAttributes:["ALL"],MaxFaces:1,QualityFilter:"AUTO"}),s=await ue.send(a);if(!s.FaceRecords?.length)throw new Error("Failed to add face to collection");const r=s.FaceRecords[0].Face?.FaceId;await this.saveFaceData(i,r),await this.searchFacesByFaceId(r,i),e.status="completed"}catch(n){e.status="failed",e.error=n.message,console.error("Face registration failed:",n)}finally{console.groupEnd()}}static async processPhotoMatching(e){console.group("Processing Photo Matching");try{const{data:n}=await V.from("photos").select("*").not("matched_users","cs",`[{"userId":"${e.userId}"}]`);if(!n?.length){console.log("No unmatched photos found to process"),e.status="completed";return}console.log(`Processing ${n.length} unmatched photos for user ${e.userId}`);const{data:i}=await V.from("face_data").select("face_id").eq("user_id",e.userId);if(!i?.length){console.log("No face data found for this user"),e.status="completed";return}const a=i.map(s=>s.face_id);console.log(`User has ${a.length} registered faces`);for(const s of a)await this.searchFacesByFaceId(s,e.userId);e.status="completed"}catch(n){e.status="failed",e.error=n.message,console.error("Photo matching failed:",n)}finally{console.groupEnd()}}static addBackgroundTask(e){const n={id:crypto.randomUUID(),type:e.type,userId:e.userId,data:e.data||{},status:"pending",createdAt:new Date,updatedAt:new Date};this.backgroundTasks.push(n),console.log("Added background task:",n.type)}static createCacheKey(e){return Array.from(e.slice(0,1e3)).reduce((n,i)=>n+i,0).toString(36)}static async searchFaces(e){try{console.group("Face Search Process"),console.log("üîç Starting face search process...");const n=this.createCacheKey(e);console.log("Generated cache key:",n);const i=this.matchCache.get(n);if(i&&Date.now()-i.timestamp<this.CACHE_TTL)return console.log("üîÑ Returning cached face matches:",i.result),console.groupEnd(),i.result;const a=await this.detectFacesWithRetry(e);if(!a||a.length===0)return console.warn("‚ùå No faces detected in image during search"),console.groupEnd(),this.matchCache.set(n,{result:[],timestamp:Date.now()}),[];console.log(`‚úÖ Detected ${a.length} faces in image`),console.log("Face details:",a),console.log("Step 2: Searching for face matches in collection...");const s=new vs({CollectionId:this.COLLECTION_ID,Image:{Bytes:e},MaxFaces:5,FaceMatchThreshold:Ue,QualityFilter:"AUTO"}),r=await ue.send(s);if(!r.FaceMatches?.length)return console.warn("‚ùå No face matches found in collection"),this.matchCache.set(n,{result:[],timestamp:Date.now()}),console.groupEnd(),[];console.log(`‚úÖ Found ${r.FaceMatches.length} potential matches`),console.log("Raw matches:",r.FaceMatches),console.log("Step 3: Processing matches...");const c=r.FaceMatches.map(p=>{const m={userId:p.Face?.ExternalImageId||"",confidence:p.Similarity||0,faceId:p.Face?.FaceId||""};return console.log(`Match processed: User ${m.userId} with ${m.confidence.toFixed(2)}% confidence`),m}).filter(p=>{const m=p.confidence>=Ue;return m||console.log(`Match filtered out: ${p.confidence.toFixed(2)}% < ${Ue}% threshold`),m});return console.log(`‚úÖ Final results: ${c.length} valid matches above ${Ue}% threshold`),console.log("Processed results:",c),this.matchCache.set(n,{result:c,timestamp:Date.now()}),console.log("Cache updated with new results"),console.groupEnd(),c}catch(n){return console.error("‚ùå Error during face search:",n),console.groupEnd(),[]}}static async detectFacesWithRetry(e){let n=0,i;for(;n<this.MAX_RETRIES;)try{console.log(`Attempt ${n+1} to detect faces...`);const a=new Ct({Image:{Bytes:e},Attributes:["ALL"]}),s=await ue.send(a);return!s.FaceDetails||s.FaceDetails.length===0?(console.log("No faces detected in image"),[]):(console.log(`Successfully detected ${s.FaceDetails.length} faces`),s.FaceDetails)}catch(a){if(console.error(`Face detection attempt ${n+1} failed:`,a),i=a,n++,n<this.MAX_RETRIES){const s=this.RETRY_DELAY*n;console.log(`Waiting ${s}ms before retry...`),await new Promise(r=>setTimeout(r,s))}}throw i||new Error("Failed to detect faces after all retries")}static async initialize(){try{return console.group("Face Collection Initialization"),console.log("üîÑ Initializing face collection..."),(await ue.send(new ca({}))).CollectionIds?.includes(je)?console.log("‚úÖ Face collection already exists"):(console.log("Creating new face collection..."),await ue.send(new Kt({CollectionId:je,Tags:{Environment:"production",Application:"shmong"}})),console.log("‚úÖ Face collection created successfully")),console.groupEnd(),!0}catch(e){return console.error("‚ùå Error initializing face collection:",e),console.groupEnd(),!1}}static async resetCollection(){try{console.group("Face Collection Reset"),console.log("üîÑ Resetting face collection...");try{console.log("Deleting existing collection..."),await ue.send(new pa({CollectionId:je})),console.log("‚úÖ Existing collection deleted")}catch{console.log("No existing collection to delete")}return console.log("Creating new collection..."),await ue.send(new Kt({CollectionId:je,Tags:{Environment:"production",Application:"shmong"}})),console.log("‚úÖ New collection created"),console.log("‚úÖ Collection reset complete"),console.groupEnd(),!0}catch(e){return console.error("‚ùå Error resetting collection:",e),console.groupEnd(),!1}}static async reindexAllFaces(){try{console.log("Starting to reindex all photos...");const{data:e,error:n}=await V.from("photos").select("*").order("created_at",{ascending:!1});if(n)return console.error("Error fetching photos:",n),!1;if(!e||e.length===0)return console.log("No photos found to reindex"),!0;console.log(`Found ${e.length} photos to reindex`),e.length>0&&(console.log("Photo record structure:",Object.keys(e[0])),console.log("First photo sample:",e[0]));const i=[];for(let r=0;r<e.length;r+=this.BATCH_SIZE)i.push(e.slice(r,r+this.BATCH_SIZE));console.log(`Processing in ${i.length} batches of up to ${this.BATCH_SIZE} photos`);let a=0,s=0;for(let r=0;r<i.length;r++){console.log(`Processing batch ${r+1} of ${i.length}...`);const c=i[r];for(const p of c)try{console.log(`Reindexing photo ${p.id}...`);let m,g;p.path?m=p.path:p.file_path?m=p.file_path:p.filePath?m=p.filePath:p.storage_path?m=p.storage_path:p.storagePath?m=p.storagePath:p.folderPath?m=`${p.folderPath}/${p.id}`:p.folder_path?m=`${p.folder_path}/${p.id}`:m=`photos/${p.id}`,console.log(`Attempting to download photo using path: ${m}`);const{data:x,error:u}=await V.storage.from("photos").download(m);if(u||!x)if(console.error(`Error downloading photo ${p.id} with path ${m}:`,u),p.url)try{console.log(`Attempting to fetch photo from URL: ${p.url}`);const k=await fetch(p.url);if(!k.ok)throw new Error(`HTTP error! status: ${k.status}`);g=await k.arrayBuffer(),console.log("Successfully fetched photo from URL")}catch(k){console.error("Error fetching photo from URL:",k),s++;continue}else{s++;continue}else g=await x.arrayBuffer();if(!g){console.error(`No photo data available for photo ${p.id}`),s++;continue}const f=new Uint8Array(g),d=await this.detectFacesWithRetry(f);if(!d||d.length===0){console.log(`No faces detected in photo ${p.id}`);continue}console.log(`Detected ${d.length} faces in photo ${p.id}`);const h=new wt({CollectionId:this.COLLECTION_ID,Image:{Bytes:f},ExternalImageId:`photo_${p.id}`,DetectionAttributes:["ALL"],MaxFaces:10,QualityFilter:"AUTO"}),b=await ue.send(h);if(!b.FaceRecords||b.FaceRecords.length===0){console.log(`No faces indexed for photo ${p.id}`);continue}console.log(`Successfully indexed ${b.FaceRecords.length} faces for photo ${p.id}`);const L=b.FaceRecords.map((k,v)=>({face_id:k.Face?.FaceId,photo_id:p.id,external_image_id:`photo_${p.id}_${v}`,created_at:new Date().toISOString(),attributes:k.FaceDetail||{}}));for(const k of L){if(!k.face_id)continue;const{error:v}=await V.from("unassociated_faces").insert(k);v&&console.error(`Error storing unassociated face for photo ${p.id}:`,v)}const{error:C}=await V.from("photos").update({faces:L.map(k=>({faceId:k.face_id,userId:"",confidence:0,attributes:k.attributes}))}).eq("id",p.id);C?console.error(`Error updating photo ${p.id} faces:`,C):a++,await new Promise(k=>setTimeout(k,500))}catch(m){console.error(`Error reindexing photo ${p.id}:`,m),s++}r<i.length-1&&(console.log(`Waiting ${this.RETRY_DELAY}ms before next batch...`),await new Promise(p=>setTimeout(p,this.RETRY_DELAY)))}return console.log(`Reindexing completed: ${a} successful, ${s} errors`),!0}catch(e){return console.error("Error reindexing all faces:",e),!1}}static async storeUnassociatedFace(e,n,i,a){try{const s={face_id:e,photo_id:n,external_image_id:i,created_at:new Date().toISOString(),attributes:a||{},updated_at:new Date().toISOString()},{error:r}=await V.from("unassociated_faces").insert(s);return r?(console.error("Error storing unassociated face:",r),!1):(console.log(`Stored unassociated face: ${e} for photo ${n}`),!0)}catch(s){return console.error("Error storing unassociated face:",s),!1}}}Object.defineProperty(he,"COLLECTION_ID",{enumerable:!0,configurable:!0,writable:!0,value:je});Object.defineProperty(he,"MAX_RETRIES",{enumerable:!0,configurable:!0,writable:!0,value:1});Object.defineProperty(he,"RETRY_DELAY",{enumerable:!0,configurable:!0,writable:!0,value:2e3});Object.defineProperty(he,"BATCH_SIZE",{enumerable:!0,configurable:!0,writable:!0,value:20});Object.defineProperty(he,"CACHE_TTL",{enumerable:!0,configurable:!0,writable:!0,value:30*60*1e3});Object.defineProperty(he,"BACKGROUND_INTERVAL",{enumerable:!0,configurable:!0,writable:!0,value:1e4});Object.defineProperty(he,"matchCache",{enumerable:!0,configurable:!0,writable:!0,value:new Map});Object.defineProperty(he,"backgroundTasks",{enumerable:!0,configurable:!0,writable:!0,value:[]});Object.defineProperty(he,"isProcessing",{enumerable:!0,configurable:!0,writable:!0,value:!1});he.startBackgroundProcessing();he.initialize().catch(console.error);const Es=({onSuccess:t,onClose:e})=>{const n=o.useRef(null),[i,a]=o.useState(!1),[s,r]=o.useState(null),[c,p]=o.useState(null),[m,g]=o.useState([]),[x,u]=o.useState(""),[f,d]=o.useState(!1),[h,b]=o.useState(!1),{user:L}=Tt();o.useEffect(()=>{(async()=>{try{console.log("Getting video devices...");const P=(await navigator.mediaDevices.enumerateDevices()).filter(S=>S.kind==="videoinput");console.log("Found video devices:",P),g(P),P.length>0&&u(P[0].deviceId)}catch(w){console.error("Error getting video devices:",w),r("Unable to access camera devices")}})()},[]),o.useEffect(()=>{if(!c&&n.current&&n.current.video){const w=setInterval(async()=>{b(!0);try{const P=n.current?.video;if(!P)return;const S=document.createElement("canvas");S.width=P.videoWidth||640,S.height=P.videoHeight||480;const N=S.getContext("2d");if(!N)return;N.drawImage(P,0,0);const D=await new Promise(Y=>{try{S.toBlob(Y,"image/jpeg",.9)}catch(Z){console.error("Error creating blob:",Z),Y(null)}});if(!D){console.error("Failed to create blob from canvas");return}const _=await D.arrayBuffer(),A=new Uint8Array(_);console.log("Detecting faces in webcam frame...");const T=new Ct({Image:{Bytes:A},Attributes:["ALL"]}),I=await ue.send(T),$=!!(I.FaceDetails&&I.FaceDetails.length>0);console.log("Face detection result:",$?"Face detected":"No face detected"),d($)}catch(P){console.error("Error checking for face:",P),d(!1)}finally{b(!1)}},1e3);return()=>clearInterval(w)}},[c]);const C=o.useCallback(()=>{if(!f){console.log("No face detected, cannot capture"),r("Please position your face in the frame");return}console.log("Capturing image...");const E=n.current?.getScreenshot();E?(console.log("Image captured successfully"),p(E),r(null)):(console.error("Failed to capture image"),r("Failed to capture image"))},[f]),k=()=>{console.log("Retaking photo..."),p(null),r(null),d(!1)},v=E=>{console.log("Changing camera device to:",E.target.value),u(E.target.value),p(null),r(null),d(!1)},y=async()=>{if(!(!c||!L)){a(!0),r(null);try{console.log("Starting face registration process...");const w=await(await fetch(c)).blob(),P=await w.arrayBuffer(),S=new Uint8Array(P);console.log("Detecting face attributes...");const N=new Ct({Image:{Bytes:S},Attributes:["ALL"]}),D=await ue.send(N);if(!D.FaceDetails?.length)throw new Error("No face detected in the image");const _=D.FaceDetails[0];console.log("Face attributes detected successfully"),console.log("Uploading image to storage...");const A=`${L.id}/${Date.now()}.jpg`,{error:T}=await V.storage.from("face-data").upload(A,w,{cacheControl:"3600",upsert:!0,contentType:"image/jpeg"});if(T)throw T;console.log("Image uploaded successfully");const{data:{publicUrl:I}}=V.storage.from("face-data").getPublicUrl(A);if(!I)throw new Error("Failed to retrieve public URL");console.log("Saving face data...");const{error:$}=await V.from("face_data").upsert({user_id:L.id,face_data:{image_path:A,public_url:I,attributes:{age:{low:_.AgeRange?.Low||0,high:_.AgeRange?.High||0},smile:{value:_.Smile?.Value||!1,confidence:_.Smile?.Confidence||0},eyeglasses:{value:_.Eyeglasses?.Value||!1,confidence:_.Eyeglasses?.Confidence||0},sunglasses:{value:_.Sunglasses?.Value||!1,confidence:_.Sunglasses?.Confidence||0},gender:{value:_.Gender?.Value||"",confidence:_.Gender?.Confidence||0},eyesOpen:{value:_.EyesOpen?.Value||!1,confidence:_.EyesOpen?.Confidence||0},mouthOpen:{value:_.MouthOpen?.Value||!1,confidence:_.MouthOpen?.Confidence||0},quality:{brightness:_.Quality?.Brightness||0,sharpness:_.Quality?.Sharpness||0},emotions:_.Emotions?.map(Z=>({type:Z.Type,confidence:Z.Confidence}))||[],landmarks:_.Landmarks,pose:_.Pose,beard:{value:_.Beard?.Value||!1,confidence:_.Beard?.Confidence||0},mustache:{value:_.Mustache?.Value||!1,confidence:_.Mustache?.Confidence||0},overallConfidence:_.Confidence}}});if($)throw $;console.log("Face data saved successfully"),console.log("Indexing face...");const Y=await he.indexFace(S,L.id);if(!Y.success)throw new Error(Y.error||"Failed to index face");console.log("Face indexed successfully"),console.log("Face registration complete!"),t()}catch(E){console.error("Face registration error:",E),r(E.message||"Failed to register face")}finally{a(!1)}}};return l.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:l.jsx("div",{className:"bg-white rounded-apple-2xl shadow-apple-lg overflow-hidden max-w-lg w-full",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("h2",{className:"text-2xl font-semibold text-apple-gray-900",children:"Face Registration"}),l.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-apple-gray-100 text-apple-gray-500",children:l.jsx(Lt,{className:"w-5 h-5"})})]}),s&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 text-red-600 rounded-apple flex items-center",children:[l.jsx(pt,{className:"w-5 h-5 mr-2"}),s]}),m.length>1&&l.jsxs("div",{className:"mb-4",children:[l.jsxs("label",{className:"ios-label flex items-center",children:[l.jsx(Va,{className:"w-4 h-4 mr-2"}),"Camera"]}),l.jsx("select",{value:x,onChange:v,className:"ios-input",children:m.map(E=>l.jsx("option",{value:E.deviceId,children:E.label||`Camera ${m.indexOf(E)+1}`},E.deviceId))})]}),l.jsx("div",{className:"relative aspect-video overflow-hidden rounded-apple-xl bg-black mb-6",children:c?l.jsx("img",{src:c,alt:"Captured face",className:"w-full h-full object-cover"}):l.jsxs(l.Fragment,{children:[l.jsx(bs,{ref:n,screenshotFormat:"image/jpeg",className:"w-full h-full object-cover",videoConstraints:{width:1280,height:720,deviceId:x,facingMode:"user"}}),l.jsx("div",{className:me("absolute inset-0 border-4 transition-colors duration-300",f?"border-apple-green-500":"border-white/20")}),!h&&!f&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/25",children:l.jsxs("div",{className:"text-white text-center",children:[l.jsx(pt,{className:"w-8 h-8 mx-auto mb-2"}),l.jsx("p",{children:"No face detected"})]})})]})}),l.jsx("div",{className:"flex gap-3",children:c?l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:k,className:"ios-button-secondary flex items-center",children:[l.jsx(Ha,{className:"w-5 h-5 mr-2"}),"Retake"]}),l.jsx("button",{onClick:y,disabled:i,className:me("ios-button-primary flex-1",i&&"opacity-50 cursor-not-allowed"),children:i?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),"Registering..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Gi,{className:"w-5 h-5 mr-2"}),"Confirm & Register"]})})]}):l.jsxs("button",{onClick:C,disabled:!f,className:me("ios-button-primary flex-1",!f&&"opacity-50 cursor-not-allowed"),children:[l.jsx(Ki,{className:"w-5 h-5 mr-2"}),f?"Capture Photo":"Position Your Face"]})})]})})})};var ga={exports:{}},Cs="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",js=Cs,ks=js;function ha(){}function va(){}va.resetWarningCache=ha;var Ss=function(){function t(i,a,s,r,c,p){if(p!==ks){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:va,resetWarningCache:ha};return n.PropTypes=n,n};ga.exports=Ss();var Ms=ga.exports;const re=la(Ms),Ps=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function tt(t,e,n){const i=Os(t),{webkitRelativePath:a}=t,s=typeof e=="string"?e:typeof a=="string"&&a.length>0?a:`./${t.name}`;return typeof i.path!="string"&&bn(i,"path",s),bn(i,"relativePath",s),i}function Os(t){const{name:e}=t;if(e&&e.lastIndexOf(".")!==-1&&!t.type){const i=e.split(".").pop().toLowerCase(),a=Ps.get(i);a&&Object.defineProperty(t,"type",{value:a,writable:!1,configurable:!1,enumerable:!0})}return t}function bn(t,e,n){Object.defineProperty(t,e,{value:n,writable:!1,configurable:!1,enumerable:!0})}const _s=[".DS_Store","Thumbs.db"];function Ds(t){return $e(this,void 0,void 0,function*(){return jt(t)&&Is(t.dataTransfer)?Ts(t.dataTransfer,t.type):Ns(t)?Rs(t):Array.isArray(t)&&t.every(e=>"getFile"in e&&typeof e.getFile=="function")?As(t):[]})}function Is(t){return jt(t)}function Ns(t){return jt(t)&&jt(t.target)}function jt(t){return typeof t=="object"&&t!==null}function Rs(t){return Xt(t.target.files).map(e=>tt(e))}function As(t){return $e(this,void 0,void 0,function*(){return(yield Promise.all(t.map(n=>n.getFile()))).map(n=>tt(n))})}function Ts(t,e){return $e(this,void 0,void 0,function*(){if(t.items){const n=Xt(t.items).filter(a=>a.kind==="file");if(e!=="drop")return n;const i=yield Promise.all(n.map(Fs));return wn(xa(i))}return wn(Xt(t.files).map(n=>tt(n)))})}function wn(t){return t.filter(e=>_s.indexOf(e.name)===-1)}function Xt(t){if(t===null)return[];const e=[];for(let n=0;n<t.length;n++){const i=t[n];e.push(i)}return e}function Fs(t){if(typeof t.webkitGetAsEntry!="function")return Ln(t);const e=t.webkitGetAsEntry();return e&&e.isDirectory?ya(e):Ln(t,e)}function xa(t){return t.reduce((e,n)=>[...e,...Array.isArray(n)?xa(n):[n]],[])}function Ln(t,e){return $e(this,void 0,void 0,function*(){var n;if(globalThis.isSecureContext&&typeof t.getAsFileSystemHandle=="function"){const s=yield t.getAsFileSystemHandle();if(s===null)throw new Error(`${t} is not a File`);if(s!==void 0){const r=yield s.getFile();return r.handle=s,tt(r)}}const i=t.getAsFile();if(!i)throw new Error(`${t} is not a File`);return tt(i,(n=e?.fullPath)!==null&&n!==void 0?n:void 0)})}function Us(t){return $e(this,void 0,void 0,function*(){return t.isDirectory?ya(t):zs(t)})}function ya(t){const e=t.createReader();return new Promise((n,i)=>{const a=[];function s(){e.readEntries(r=>$e(this,void 0,void 0,function*(){if(r.length){const c=Promise.all(r.map(Us));a.push(c),s()}else try{const c=yield Promise.all(a);n(c)}catch(c){i(c)}}),r=>{i(r)})}s()})}function zs(t){return $e(this,void 0,void 0,function*(){return new Promise((e,n)=>{t.file(i=>{const a=tt(i,t.fullPath);e(a)},i=>{n(i)})})})}var Ut=function(t,e){if(t&&e){var n=Array.isArray(e)?e:e.split(",");if(n.length===0)return!0;var i=t.name||"",a=(t.type||"").toLowerCase(),s=a.replace(/\/.*$/,"");return n.some(function(r){var c=r.trim().toLowerCase();return c.charAt(0)==="."?i.toLowerCase().endsWith(c):c.endsWith("/*")?s===c.replace(/\/.*$/,""):a===c})}return!0};function En(t){return Ws(t)||$s(t)||wa(t)||Bs()}function Bs(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $s(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ws(t){if(Array.isArray(t))return Jt(t)}function Cn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function jn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Cn(Object(n),!0).forEach(function(i){ba(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cn(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function ba(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dt(t,e){return Hs(t)||Vs(t,e)||wa(t,e)||qs()}function qs(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wa(t,e){if(t){if(typeof t=="string")return Jt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jt(t,e)}}function Jt(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Vs(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],a=!0,s=!1,r,c;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!(e&&i.length===e));a=!0);}catch(p){s=!0,c=p}finally{try{!a&&n.return!=null&&n.return()}finally{if(s)throw c}}return i}}function Hs(t){if(Array.isArray(t))return t}var Zs=typeof Ut=="function"?Ut:Ut.default,Gs="file-invalid-type",Ks="file-too-large",Ys="file-too-small",Xs="too-many-files",Js=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=e.split(","),i=n.length>1?"one of ".concat(n.join(", ")):n[0];return{code:Gs,message:"File type must be ".concat(i)}},kn=function(e){return{code:Ks,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},Sn=function(e){return{code:Ys,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},Qs={code:Xs,message:"Too many files"};function La(t,e){var n=t.type==="application/x-moz-file"||Zs(t,e);return[n,n?null:Js(e)]}function Ea(t,e,n){if(ze(t.size))if(ze(e)&&ze(n)){if(t.size>n)return[!1,kn(n)];if(t.size<e)return[!1,Sn(e)]}else{if(ze(e)&&t.size<e)return[!1,Sn(e)];if(ze(n)&&t.size>n)return[!1,kn(n)]}return[!0,null]}function ze(t){return t!=null}function eo(t){var e=t.files,n=t.accept,i=t.minSize,a=t.maxSize,s=t.multiple,r=t.maxFiles,c=t.validator;return!s&&e.length>1||s&&r>=1&&e.length>r?!1:e.every(function(p){var m=La(p,n),g=dt(m,1),x=g[0],u=Ea(p,i,a),f=dt(u,1),d=f[0],h=c?c(p):null;return x&&d&&!h})}function kt(t){return typeof t.isPropagationStopped=="function"?t.isPropagationStopped():typeof t.cancelBubble<"u"?t.cancelBubble:!1}function xt(t){return t.dataTransfer?Array.prototype.some.call(t.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!t.target&&!!t.target.files}function Mn(t){t.preventDefault()}function to(t){return t.indexOf("MSIE")!==-1||t.indexOf("Trident/")!==-1}function no(t){return t.indexOf("Edge/")!==-1}function io(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return to(t)||no(t)}function Le(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(i){for(var a=arguments.length,s=new Array(a>1?a-1:0),r=1;r<a;r++)s[r-1]=arguments[r];return e.some(function(c){return!kt(i)&&c&&c.apply(void 0,[i].concat(s)),kt(i)})}}function ao(){return"showOpenFilePicker"in window}function so(t){if(ze(t)){var e=Object.entries(t).filter(function(n){var i=dt(n,2),a=i[0],s=i[1],r=!0;return Ca(a)||(console.warn('Skipped "'.concat(a,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),r=!1),(!Array.isArray(s)||!s.every(ja))&&(console.warn('Skipped "'.concat(a,'" because an invalid file extension was provided.')),r=!1),r}).reduce(function(n,i){var a=dt(i,2),s=a[0],r=a[1];return jn(jn({},n),{},ba({},s,r))},{});return[{description:"Files",accept:e}]}return t}function oo(t){if(ze(t))return Object.entries(t).reduce(function(e,n){var i=dt(n,2),a=i[0],s=i[1];return[].concat(En(e),[a],En(s))},[]).filter(function(e){return Ca(e)||ja(e)}).join(",")}function ro(t){return t instanceof DOMException&&(t.name==="AbortError"||t.code===t.ABORT_ERR)}function lo(t){return t instanceof DOMException&&(t.name==="SecurityError"||t.code===t.SECURITY_ERR)}function Ca(t){return t==="audio/*"||t==="video/*"||t==="image/*"||t==="text/*"||t==="application/*"||/\w+\/[-+.\w]+/g.test(t)}function ja(t){return/^.*\.[\w]+$/.test(t)}var co=["children"],po=["open"],uo=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],mo=["refKey","onChange","onClick"];function fo(t){return vo(t)||ho(t)||ka(t)||go()}function go(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ho(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function vo(t){if(Array.isArray(t))return Qt(t)}function zt(t,e){return bo(t)||yo(t,e)||ka(t,e)||xo()}function xo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ka(t,e){if(t){if(typeof t=="string")return Qt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qt(t,e)}}function Qt(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function yo(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],a=!0,s=!1,r,c;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!(e&&i.length===e));a=!0);}catch(p){s=!0,c=p}finally{try{!a&&n.return!=null&&n.return()}finally{if(s)throw c}}return i}}function bo(t){if(Array.isArray(t))return t}function Pn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function pe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Pn(Object(n),!0).forEach(function(i){en(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pn(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function en(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function St(t,e){if(t==null)return{};var n=wo(t,e),i,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)i=s[a],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function wo(t,e){if(t==null)return{};var n={},i=Object.keys(t),a,s;for(s=0;s<i.length;s++)a=i[s],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}var on=o.forwardRef(function(t,e){var n=t.children,i=St(t,co),a=Ma(i),s=a.open,r=St(a,po);return o.useImperativeHandle(e,function(){return{open:s}},[s]),Ie.createElement(o.Fragment,null,n(pe(pe({},r),{},{open:s})))});on.displayName="Dropzone";var Sa={disabled:!1,getFilesFromEvent:Ds,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};on.defaultProps=Sa;on.propTypes={children:re.func,accept:re.objectOf(re.arrayOf(re.string)),multiple:re.bool,preventDropOnDocument:re.bool,noClick:re.bool,noKeyboard:re.bool,noDrag:re.bool,noDragEventsBubbling:re.bool,minSize:re.number,maxSize:re.number,maxFiles:re.number,disabled:re.bool,getFilesFromEvent:re.func,onFileDialogCancel:re.func,onFileDialogOpen:re.func,useFsAccessApi:re.bool,autoFocus:re.bool,onDragEnter:re.func,onDragLeave:re.func,onDragOver:re.func,onDrop:re.func,onDropAccepted:re.func,onDropRejected:re.func,onError:re.func,validator:re.func};var tn={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Ma(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=pe(pe({},Sa),t),n=e.accept,i=e.disabled,a=e.getFilesFromEvent,s=e.maxSize,r=e.minSize,c=e.multiple,p=e.maxFiles,m=e.onDragEnter,g=e.onDragLeave,x=e.onDragOver,u=e.onDrop,f=e.onDropAccepted,d=e.onDropRejected,h=e.onFileDialogCancel,b=e.onFileDialogOpen,L=e.useFsAccessApi,C=e.autoFocus,k=e.preventDropOnDocument,v=e.noClick,y=e.noKeyboard,E=e.noDrag,w=e.noDragEventsBubbling,P=e.onError,S=e.validator,N=o.useMemo(function(){return oo(n)},[n]),D=o.useMemo(function(){return so(n)},[n]),_=o.useMemo(function(){return typeof b=="function"?b:On},[b]),A=o.useMemo(function(){return typeof h=="function"?h:On},[h]),T=o.useRef(null),I=o.useRef(null),$=o.useReducer(Lo,tn),Y=zt($,2),Z=Y[0],G=Y[1],Q=Z.isFocused,ie=Z.isFileDialogActive,ne=o.useRef(typeof window<"u"&&window.isSecureContext&&L&&ao()),W=function(){!ne.current&&ie&&setTimeout(function(){if(I.current){var H=I.current.files;H.length||(G({type:"closeDialog"}),A())}},300)};o.useEffect(function(){return window.addEventListener("focus",W,!1),function(){window.removeEventListener("focus",W,!1)}},[I,ie,A,ne]);var O=o.useRef([]),j=function(H){T.current&&T.current.contains(H.target)||(H.preventDefault(),O.current=[])};o.useEffect(function(){return k&&(document.addEventListener("dragover",Mn,!1),document.addEventListener("drop",j,!1)),function(){k&&(document.removeEventListener("dragover",Mn),document.removeEventListener("drop",j))}},[T,k]),o.useEffect(function(){return!i&&C&&T.current&&T.current.focus(),function(){}},[T,C,i]);var F=o.useCallback(function(R){P?P(R):console.error(R)},[P]),q=o.useCallback(function(R){R.preventDefault(),R.persist(),Ae(R),O.current=[].concat(fo(O.current),[R.target]),xt(R)&&Promise.resolve(a(R)).then(function(H){if(!(kt(R)&&!w)){var le=H.length,ce=le>0&&eo({files:H,accept:N,minSize:r,maxSize:s,multiple:c,maxFiles:p,validator:S}),fe=le>0&&!ce;G({isDragAccept:ce,isDragReject:fe,isDragActive:!0,type:"setDraggedFiles"}),m&&m(R)}}).catch(function(H){return F(H)})},[a,m,F,w,N,r,s,c,p,S]),z=o.useCallback(function(R){R.preventDefault(),R.persist(),Ae(R);var H=xt(R);if(H&&R.dataTransfer)try{R.dataTransfer.dropEffect="copy"}catch{}return H&&x&&x(R),!1},[x,w]),K=o.useCallback(function(R){R.preventDefault(),R.persist(),Ae(R);var H=O.current.filter(function(ce){return T.current&&T.current.contains(ce)}),le=H.indexOf(R.target);le!==-1&&H.splice(le,1),O.current=H,!(H.length>0)&&(G({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),xt(R)&&g&&g(R))},[T,g,w]),U=o.useCallback(function(R,H){var le=[],ce=[];R.forEach(function(fe){var we=La(fe,N),Ce=zt(we,2),Se=Ce[0],He=Ce[1],Me=Ea(fe,r,s),Te=zt(Me,2),Pe=Te[0],Ze=Te[1],Oe=S?S(fe):null;if(Se&&Pe&&!Oe)le.push(fe);else{var Ge=[He,Ze];Oe&&(Ge=Ge.concat(Oe)),ce.push({file:fe,errors:Ge.filter(function(Ke){return Ke})})}}),(!c&&le.length>1||c&&p>=1&&le.length>p)&&(le.forEach(function(fe){ce.push({file:fe,errors:[Qs]})}),le.splice(0)),G({acceptedFiles:le,fileRejections:ce,isDragReject:ce.length>0,type:"setFiles"}),u&&u(le,ce,H),ce.length>0&&d&&d(ce,H),le.length>0&&f&&f(le,H)},[G,c,N,r,s,p,u,f,d,S]),B=o.useCallback(function(R){R.preventDefault(),R.persist(),Ae(R),O.current=[],xt(R)&&Promise.resolve(a(R)).then(function(H){kt(R)&&!w||U(H,R)}).catch(function(H){return F(H)}),G({type:"reset"})},[a,U,F,w]),se=o.useCallback(function(){if(ne.current){G({type:"openDialog"}),_();var R={multiple:c,types:D};window.showOpenFilePicker(R).then(function(H){return a(H)}).then(function(H){U(H,null),G({type:"closeDialog"})}).catch(function(H){ro(H)?(A(H),G({type:"closeDialog"})):lo(H)?(ne.current=!1,I.current?(I.current.value=null,I.current.click()):F(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):F(H)});return}I.current&&(G({type:"openDialog"}),_(),I.current.value=null,I.current.click())},[G,_,A,L,U,F,D,c]),xe=o.useCallback(function(R){!T.current||!T.current.isEqualNode(R.target)||(R.key===" "||R.key==="Enter"||R.keyCode===32||R.keyCode===13)&&(R.preventDefault(),se())},[T,se]),ke=o.useCallback(function(){G({type:"focus"})},[]),oe=o.useCallback(function(){G({type:"blur"})},[]),at=o.useCallback(function(){v||(io()?setTimeout(se,0):se())},[v,se]),be=function(H){return i?null:H},We=function(H){return y?null:be(H)},Ee=function(H){return E?null:be(H)},Ae=function(H){w&&H.stopPropagation()},qe=o.useMemo(function(){return function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},H=R.refKey,le=H===void 0?"ref":H,ce=R.role,fe=R.onKeyDown,we=R.onFocus,Ce=R.onBlur,Se=R.onClick,He=R.onDragEnter,Me=R.onDragOver,Te=R.onDragLeave,Pe=R.onDrop,Ze=St(R,uo);return pe(pe(en({onKeyDown:We(Le(fe,xe)),onFocus:We(Le(we,ke)),onBlur:We(Le(Ce,oe)),onClick:be(Le(Se,at)),onDragEnter:Ee(Le(He,q)),onDragOver:Ee(Le(Me,z)),onDragLeave:Ee(Le(Te,K)),onDrop:Ee(Le(Pe,B)),role:typeof ce=="string"&&ce!==""?ce:"presentation"},le,T),!i&&!y?{tabIndex:0}:{}),Ze)}},[T,xe,ke,oe,at,q,z,K,B,y,E,i]),ft=o.useCallback(function(R){R.stopPropagation()},[]),Ve=o.useMemo(function(){return function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},H=R.refKey,le=H===void 0?"ref":H,ce=R.onChange,fe=R.onClick,we=St(R,mo),Ce=en({accept:N,multiple:c,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:be(Le(ce,B)),onClick:be(Le(fe,ft)),tabIndex:-1},le,I);return pe(pe({},Ce),we)}},[I,n,c,B,i]);return pe(pe({},Z),{},{isFocused:Q&&!i,getRootProps:qe,getInputProps:Ve,rootRef:T,inputRef:I,open:be(se)})}function Lo(t,e){switch(e.type){case"focus":return pe(pe({},t),{},{isFocused:!0});case"blur":return pe(pe({},t),{},{isFocused:!1});case"openDialog":return pe(pe({},tn),{},{isFileDialogActive:!0});case"closeDialog":return pe(pe({},t),{},{isFileDialogActive:!1});case"setDraggedFiles":return pe(pe({},t),{},{isDragActive:e.isDragActive,isDragAccept:e.isDragAccept,isDragReject:e.isDragReject});case"setFiles":return pe(pe({},t),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections,isDragReject:e.isDragReject});case"reset":return pe({},tn);default:return t}}function On(){}class Je{static MAX_RETRIES=3;static RETRY_DELAY=1e3;static validatePhotoData(e,n,i){const a={...e,public_url:i||e.public_url,file_size:n?.size||e.file_size,file_type:n?.type||e.file_type||"image/jpeg"};return Yt("photos",a)}static async uploadPhoto(e,n,i,a){try{const s=xs(),r=e.name.split(".").pop(),c=i?`photos/${i}/${s}.${r}`:`photos/${s}.${r}`,p=(await V.auth.getUser()).data.user?.id;if(!p)throw new Error("User not found");const{data:m,error:g}=await this.getUserStorageUsage(p);if(g)throw g;if(!m)throw new Error("Could not get storage data");if(m.total_size+e.size>m.quota_limit)throw new Error("Storage quota exceeded");let x;for(let f=0;f<this.MAX_RETRIES;f++){try{const{error:d}=await V.storage.from("photos").upload(c,e,{cacheControl:"3600",upsert:!1});if(!d){x=null;break}x=d}catch(d){x=d}f<this.MAX_RETRIES-1&&await new Promise(d=>setTimeout(d,this.RETRY_DELAY*(f+1)))}if(x)throw x;const{data:{publicUrl:u}}=V.storage.from("photos").getPublicUrl(c);try{const f={id:s,storage_path:c,public_url:u,uploaded_by:p,file_size:e.size||0,file_type:e.type||"image/jpeg",faces:[],matched_users:[],face_ids:[],tags:[],location:{lat:null,lng:null,name:null},venue:{id:null,name:null},event_details:{name:null,date:null,type:null}};console.log("Inserting complete photo record with data:",JSON.stringify(f));try{const w=`
                        INSERT INTO photos (
                            id, storage_path, public_url, uploaded_by, 
                            file_size, file_type, created_at, updated_at
                        ) VALUES (
                            '${s}', 
                            '${c}', 
                            '${u}', 
                            '${p}',
                            ${e.size||0}, 
                            '${e.type||"image/jpeg"}',
                            NOW(), 
                            NOW()
                        )
                    `,{error:P}=await V.rpc("execute_sql",{sql_query:w});if(P){console.warn("Raw SQL insert failed, trying fallback methods:",P);const{data:S,error:N}=await V.rpc("insert_photo",{photo_data:f});if(N){console.warn("RPC insertion failed, trying direct insert:",N);const{error:D}=await V.from("photos").insert(f);if(D)throw console.error("Error inserting complete photo record:",D),typeof D=="object"&&console.error("Error details:",JSON.stringify(D,null,2)),await V.storage.from("photos").remove([c]),D}}else console.log("Photo record created successfully via raw SQL")}catch(w){throw console.error("All photo insertion methods failed:",w),await V.storage.from("photos").remove([c]),w}console.log("Photo record created successfully");const{data:d,error:h}=await V.from("photos").select("*").eq("id",s).single();h&&console.warn("Warning: Could not fetch the created photo record:",h);const b=await e.arrayBuffer(),L=new Uint8Array(b);console.log("Processing faces in uploaded photo...");const C=await this.detectFaces(L);console.log("Detected faces:",C);const k=C.map(w=>({userId:"",confidence:0,attributes:{age:{low:w.AgeRange?.Low||0,high:w.AgeRange?.High||0},smile:{value:w.Smile?.Value||!1,confidence:w.Smile?.Confidence||0},eyeglasses:{value:w.Eyeglasses?.Value||!1,confidence:w.Eyeglasses?.Confidence||0},sunglasses:{value:w.Sunglasses?.Value||!1,confidence:w.Sunglasses?.Confidence||0},gender:{value:w.Gender?.Value||"",confidence:w.Gender?.Confidence||0},eyesOpen:{value:w.EyesOpen?.Value||!1,confidence:w.EyesOpen?.Confidence||0},mouthOpen:{value:w.MouthOpen?.Value||!1,confidence:w.MouthOpen?.Confidence||0},quality:{brightness:w.Quality?.Brightness||0,sharpness:w.Quality?.Sharpness||0},emotions:w.Emotions?.map(P=>({type:P.Type,confidence:P.Confidence}))||[],landmarks:w.Landmarks,pose:w.Pose,beard:{value:w.Beard?.Value||!1,confidence:w.Beard?.Confidence||0},mustache:{value:w.Mustache?.Value||!1,confidence:w.Mustache?.Confidence||0},overallConfidence:w.Confidence}}));let v=[];if(k.length>0){console.log(`Indexing ${k.length} faces for future matching...`);try{const w=`p${s.replace(/-/g,"")}`,P=new wt({CollectionId:je,Image:{Bytes:L},ExternalImageId:w,DetectionAttributes:["ALL"],MaxFaces:10,QualityFilter:"AUTO"}),S=await ue.send(P);if(S.FaceRecords&&S.FaceRecords.length>0){console.log(`Successfully indexed ${S.FaceRecords.length} faces in AWS`);const _=[];for(let A=0;A<S.FaceRecords.length;A++){const T=S.FaceRecords[A],I=T.Face?.FaceId;if(I){_.push(I);try{await he.storeUnassociatedFace(I,s,`${w}${A}`,T.FaceDetail||{})&&k[A]&&(k[A].faceId=I)}catch($){console.error("Error in storing unassociated face:",$)}}}if(_.length>0){const{error:A}=await V.from("photos").update({face_ids:_}).eq("id",s);A&&console.log("Note: Could not update face_ids column, it may not exist:",A)}}const N=await he.searchFaces(L);console.log("Face matches:",N);const D=N.filter(_=>_.confidence>=Ue);if(console.log("High confidence matches:",D),D.length>0){const _=D.map(A=>A.userId).filter(A=>!A.startsWith("photo_")&&!A.startsWith("p")).filter(A=>A&&A.length>10);if(_.length>0){console.log("Querying for user details with IDs:",_);const{data:A,error:T}=await V.from("users").select(`
                  id,
                  full_name,
                  avatar_url,
                  user_profiles (
                    metadata
                  )
                `).in("id",_);T?console.error("Error fetching matched users:",T):A&&A.length>0&&(console.log("Matched users data:",A),v=D.filter(I=>!I.userId.startsWith("photo_")&&!I.userId.startsWith("p")).filter(I=>I.userId&&I.userId.length>10).map(I=>{const $=A.find(Z=>Z.id===I.userId);if(!$)return null;const Y=k.findIndex(Z=>Z.faceId===I.faceId);return Y!==-1&&(k[Y].userId=I.userId,k[Y].confidence=I.confidence),{userId:I.userId,fullName:$.full_name||$?.user_profiles?.[0]?.metadata?.full_name||"Unknown User",avatarUrl:$.avatar_url||$?.user_profiles?.[0]?.metadata?.avatar_url,confidence:I.confidence}}).filter(Boolean))}}}catch(w){console.error("Error indexing faces:",w)}}const y={faces:k.length>0?k:[],matched_users:v.length>0?v:[]};a?.title&&(y.title=a.title||e.name),a?.description!==void 0&&(y.description=a.description||""),a?.location&&(y.location=a.location),a?.venue&&(y.venue=a.venue),a?.tags&&(y.tags=a.tags),a?.date_taken&&(y.date_taken=a.date_taken),a?.event_details&&(y.event_details=a.event_details),n&&(y.event_id=n),i&&(y.folder_path=i,y.folder_name=i.split("/").pop()),y.file_size=e.size,y.file_type=e.type,console.log("Updating photo with full details:",JSON.stringify(y));const{error:E}=await V.from("photos").update(y).eq("id",s);return E&&console.error("Error updating photo with full details:",E),{success:!0,url:u,photoId:s,photoMetadata:{id:s,url:u,eventId:n,uploadedBy:p,created_at:new Date().toISOString(),fileSize:e.size,fileType:e.type,faces:k,matched_users:v,folderPath:i,title:a?.title||e.name,description:a?.description||"",location:a?.location||null,venue:a?.venue||null,tags:a?.tags||[],date_taken:a?.date_taken||new Date().toISOString(),event_details:a?.event_details||null}}}catch(f){return console.error("Error uploading photo:",f),{success:!1,error:f.message||"Failed to upload photo"}}}catch(s){return console.error("Error uploading photo:",s),{success:!1,error:s.message||"Failed to upload photo"}}}static async updatePhotoMetadata(e,n){try{let i=0,a;for(;i<this.MAX_RETRIES;){try{const{error:s}=await V.from("photos").update({title:n.title,description:n.description,location:n.location,venue:n.venue,tags:n.tags,date_taken:n.date_taken,event_details:n.event_details}).eq("id",e);if(!s)return!0;a=s}catch(s){a=s}i++,i<this.MAX_RETRIES&&await new Promise(s=>setTimeout(s,this.RETRY_DELAY*i))}throw a}catch(i){return console.error("Error updating photo metadata:",i),!1}}static async batchUpdatePhotos(e,n){try{let i=0,a;for(;i<this.MAX_RETRIES;){try{const{error:s}=await V.from("photos").update({location:n.location,venue:n.venue,tags:n.tags,date_taken:n.date_taken,event_details:n.event_details}).in("id",e);if(!s)return!0;a=s}catch(s){a=s}i++,i<this.MAX_RETRIES&&await new Promise(s=>setTimeout(s,this.RETRY_DELAY*i))}throw a}catch(i){return console.error("Error batch updating photos:",i),!1}}static async renameFolder(e,n){try{let i=0,a;for(;i<this.MAX_RETRIES;){try{const{error:s}=await V.from("photos").update({folder_name:n,folder_path:e.split("/").slice(0,-1).concat(n).join("/")}).eq("folder_path",e);if(!s)return!0;a=s}catch(s){a=s}i++,i<this.MAX_RETRIES&&await new Promise(s=>setTimeout(s,this.RETRY_DELAY*i))}throw a}catch(i){return console.error("Error renaming folder:",i),!1}}static async getUserStorageUsage(e){try{const{data:n,error:i}=await V.from("user_storage").select("total_size, quota_limit").eq("user_id",e).maybeSingle();if(!n){const{data:a,error:s}=await V.from("user_storage").upsert([{user_id:e,total_size:0,quota_limit:10737418240}]).select("total_size, quota_limit").single();if(s)throw s;return{data:a}}return{data:n}}catch(n){return console.error("Error getting/creating storage usage:",n),{error:n}}}static async detectFaces(e){try{let n=0,i,a;for(;n<this.MAX_RETRIES;)try{const s=new Ct({Image:{Bytes:e},Attributes:["ALL"]});return i=await ue.send(s),i.FaceDetails||[]}catch(s){a=s,n++,n<this.MAX_RETRIES&&await new Promise(r=>setTimeout(r,this.RETRY_DELAY*n))}throw a}catch(n){throw console.error("Error detecting faces:",n),n}}static async getPhotosForEvent(e){try{let n=0,i,a;for(;n<this.MAX_RETRIES;){try{const{data:s,error:r}=await V.from("photos").select(`
              *,
              users (
                id,
                full_name,
                avatar_url,
                user_profiles (
                  metadata
                )
              )
            `).eq("event_id",e).order("created_at",{ascending:!1});if(!r){i=s;break}a=r}catch(s){a=s}n++,n<this.MAX_RETRIES&&await new Promise(s=>setTimeout(s,this.RETRY_DELAY*n))}if(a)throw a;return(i||[]).map(s=>({id:s.id,url:s.public_url,eventId:s.event_id,uploadedBy:s.uploaded_by,created_at:s.created_at,folderPath:s.folder_path,folderName:s.folder_name,fileSize:s.file_size,fileType:s.file_type,faces:s.faces||[],title:s.title,description:s.description,location:s.location,venue:s.venue,tags:s.tags,date_taken:s.date_taken,event_details:s.event_details,matched_users:s.matched_users||[]}))}catch(n){throw console.error("Error fetching event photos:",n),n}}static async getPhotosForUser(e){try{let n=0,i,a;for(;n<this.MAX_RETRIES;){try{const{data:s,error:r}=await V.from("photos").select(`
              *,
              users (
                id,
                full_name,
                avatar_url,
                user_profiles (
                  metadata
                )
              )
            `).or(`uploaded_by.eq.${e},faces->0->>userId.eq.${e}`).order("created_at",{ascending:!1});if(!r){i=s;break}a=r}catch(s){a=s}n++,n<this.MAX_RETRIES&&await new Promise(s=>setTimeout(s,this.RETRY_DELAY*n))}if(a)throw a;return(i||[]).map(s=>({id:s.id,url:s.public_url,eventId:s.event_id,uploadedBy:s.uploaded_by,created_at:s.created_at,folderPath:s.folder_path,folderName:s.folder_name,fileSize:s.file_size,fileType:s.file_type,faces:s.faces||[],title:s.title,description:s.description,location:s.location,venue:s.venue,tags:s.tags,date_taken:s.date_taken,event_details:s.event_details,matched_users:s.matched_users||[]}))}catch(n){throw console.error("Error fetching user photos:",n),n}}static async updatePhotoPermissions(e,n){try{let i=0,a;for(;i<this.MAX_RETRIES;){try{const{error:s}=await V.from("photo_permissions").upsert(n.map(r=>({photo_id:e,user_id:r.userId,access_level:r.access})));if(!s)return;a=s}catch(s){a=s}i++,i<this.MAX_RETRIES&&await new Promise(s=>setTimeout(s,this.RETRY_DELAY*i))}throw a}catch(i){throw console.error("Error updating photo permissions:",i),i}}static async deletePhoto(e){try{const{data:n,error:i}=await V.from("photos").select("storage_path, file_size").eq("id",e).single();if(i)throw i;let a=0,s;for(;a<this.MAX_RETRIES;){try{const{error:r}=await V.storage.from("photos").remove([n.storage_path]);if(!r){s=null;break}s=r}catch(r){s=r}a++,a<this.MAX_RETRIES&&await new Promise(r=>setTimeout(r,this.RETRY_DELAY*a))}if(s)throw s;for(a=0;a<this.MAX_RETRIES;){try{const{error:r}=await V.from("photos").delete().eq("id",e);if(!r)return;s=r}catch(r){s=r}a++,a<this.MAX_RETRIES&&await new Promise(r=>setTimeout(r,this.RETRY_DELAY*a))}throw s}catch(n){throw console.error("Error deleting photo:",n),n}}static async downloadPhoto(e){try{let n=0,i,a;for(;n<this.MAX_RETRIES;){try{const{data:r,error:c}=await V.from("photos").select("storage_path").eq("id",e).single();if(!c){i=r;break}a=c}catch(r){a=r}n++,n<this.MAX_RETRIES&&await new Promise(r=>setTimeout(r,this.RETRY_DELAY*n))}if(a)throw a;n=0;let s;for(;n<this.MAX_RETRIES;){try{const{data:r,error:c}=await V.storage.from("photos").download(i.storage_path);if(!c){s=r;break}a=c}catch(r){a=r}n++,n<this.MAX_RETRIES&&await new Promise(r=>setTimeout(r,this.RETRY_DELAY*n))}if(a)throw a;return URL.createObjectURL(s)}catch(n){throw console.error("Error downloading photo:",n),n}}}function ut(t){"@babel/helpers - typeof";return ut=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ut(t)}function Eo(t,e){if(ut(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(ut(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Co(t){var e=Eo(t,"string");return ut(e)=="symbol"?e:e+""}function M(t,e,n){return(e=Co(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pa(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Bt,_n;function jo(){if(_n)return Bt;_n=1;var t=function(n,i,a,s,r,c,p,m){if(!n){var g;if(i===void 0)g=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var x=[a,s,r,c,p,m],u=0;g=new Error(i.replace(/%s/g,function(){return x[u++]})),g.name="Invariant Violation"}throw g.framesToPop=1,g}};return Bt=t,Bt}var ko=jo(),de=Pa(ko),J=o.createContext(null);function So(){de(!!o.useContext,"useGoogleMap is React hook and requires React version 16.8+");var t=o.useContext(J);return de(!!t,"useGoogleMap needs a GoogleMap available up in the tree"),t}function Mo(t,e,n){return Object.keys(t).reduce(function(a,s){return e(a,t[s],s)},n)}function Po(t,e){Object.keys(t).forEach(n=>e(t[n],n))}function Oo(t,e,n,i){var a={},s=(r,c)=>{var p=n[c];p!==e[c]&&(a[c]=p,r(i,p))};return Po(t,s),a}function _o(t,e,n){var i=Mo(n,function(s,r,c){return typeof t[c]=="function"&&s.push(google.maps.event.addListener(e,r,t[c])),s},[]);return i}function Do(t){google.maps.event.removeListener(t)}function te(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t.forEach(Do)}function ee(t){var{updaterMap:e,eventMap:n,prevProps:i,nextProps:a,instance:s}=t,r=_o(a,s,n);return Oo(e,i,a,s),r}var Dn={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},In={extraMapTypes(t,e){e.forEach(function(i,a){t.mapTypes.set(String(a),i)})},center(t,e){t.setCenter(e)},clickableIcons(t,e){t.setClickableIcons(e)},heading(t,e){t.setHeading(e)},mapTypeId(t,e){t.setMapTypeId(e)},options(t,e){t.setOptions(e)},streetView(t,e){t.setStreetView(e)},tilt(t,e){t.setTilt(e)},zoom(t,e){t.setZoom(e)}};function Io(t){var{children:e,options:n,id:i,mapContainerStyle:a,mapContainerClassName:s,center:r,onClick:c,onDblClick:p,onDrag:m,onDragEnd:g,onDragStart:x,onMouseMove:u,onMouseOut:f,onMouseOver:d,onMouseDown:h,onMouseUp:b,onRightClick:L,onCenterChanged:C,onLoad:k,onUnmount:v}=t,[y,E]=o.useState(null),w=o.useRef(null),[P,S]=o.useState(null),[N,D]=o.useState(null),[_,A]=o.useState(null),[T,I]=o.useState(null),[$,Y]=o.useState(null),[Z,G]=o.useState(null),[Q,ie]=o.useState(null),[ne,W]=o.useState(null),[O,j]=o.useState(null),[F,q]=o.useState(null),[z,K]=o.useState(null),[U,B]=o.useState(null);return o.useEffect(()=>{n&&y!==null&&y.setOptions(n)},[y,n]),o.useEffect(()=>{y!==null&&typeof r<"u"&&y.setCenter(r)},[y,r]),o.useEffect(()=>{y&&p&&(N!==null&&google.maps.event.removeListener(N),D(google.maps.event.addListener(y,"dblclick",p)))},[p]),o.useEffect(()=>{y&&g&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(y,"dragend",g)))},[g]),o.useEffect(()=>{y&&x&&(T!==null&&google.maps.event.removeListener(T),I(google.maps.event.addListener(y,"dragstart",x)))},[x]),o.useEffect(()=>{y&&h&&($!==null&&google.maps.event.removeListener($),Y(google.maps.event.addListener(y,"mousedown",h)))},[h]),o.useEffect(()=>{y&&u&&(Z!==null&&google.maps.event.removeListener(Z),G(google.maps.event.addListener(y,"mousemove",u)))},[u]),o.useEffect(()=>{y&&f&&(Q!==null&&google.maps.event.removeListener(Q),ie(google.maps.event.addListener(y,"mouseout",f)))},[f]),o.useEffect(()=>{y&&d&&(ne!==null&&google.maps.event.removeListener(ne),W(google.maps.event.addListener(y,"mouseover",d)))},[d]),o.useEffect(()=>{y&&b&&(O!==null&&google.maps.event.removeListener(O),j(google.maps.event.addListener(y,"mouseup",b)))},[b]),o.useEffect(()=>{y&&L&&(F!==null&&google.maps.event.removeListener(F),q(google.maps.event.addListener(y,"rightclick",L)))},[L]),o.useEffect(()=>{y&&c&&(z!==null&&google.maps.event.removeListener(z),K(google.maps.event.addListener(y,"click",c)))},[c]),o.useEffect(()=>{y&&m&&(U!==null&&google.maps.event.removeListener(U),B(google.maps.event.addListener(y,"drag",m)))},[m]),o.useEffect(()=>{y&&C&&(P!==null&&google.maps.event.removeListener(P),S(google.maps.event.addListener(y,"center_changed",C)))},[c]),o.useEffect(()=>{var se=w.current===null?null:new google.maps.Map(w.current,n);return E(se),se!==null&&k&&k(se),()=>{se!==null&&v&&v(se)}},[]),l.jsx("div",{id:i,ref:w,style:a,className:s,children:l.jsx(J.Provider,{value:y,children:y!==null?e:null})})}o.memo(Io);class No extends o.PureComponent{constructor(){super(...arguments),M(this,"state",{map:null}),M(this,"registeredEvents",[]),M(this,"mapRef",null),M(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),M(this,"panTo",e=>{var n=this.getInstance();n&&n.panTo(e)}),M(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),M(this,"getRef",e=>{this.mapRef=e})}componentDidMount(){var e=this.getInstance();this.registeredEvents=ee({updaterMap:In,eventMap:Dn,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{map:e}},this.setMapCallback)}componentDidUpdate(e){this.state.map!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:In,eventMap:Dn,prevProps:e,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),te(this.registeredEvents))}render(){return l.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:l.jsx(J.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function Nn(t,e,n,i,a,s,r){try{var c=t[s](r),p=c.value}catch(m){return void n(m)}c.done?e(p):Promise.resolve(p).then(i,a)}function Oa(t){return function(){var e=this,n=arguments;return new Promise(function(i,a){var s=t.apply(e,n);function r(p){Nn(s,i,a,r,c,"next",p)}function c(p){Nn(s,i,a,r,c,"throw",p)}r(void 0)})}}function _a(t){var{googleMapsApiKey:e,googleMapsClientId:n,version:i="weekly",language:a,region:s,libraries:r,channel:c,mapIds:p,authReferrerPolicy:m}=t,g=[];return de(e&&n||!(e&&n),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),e?g.push("key=".concat(e)):n&&g.push("client=".concat(n)),i&&g.push("v=".concat(i)),a&&g.push("language=".concat(a)),s&&g.push("region=".concat(s)),r&&r.length&&g.push("libraries=".concat(r.sort().join(","))),c&&g.push("channel=".concat(c)),p&&p.length&&g.push("map_ids=".concat(p.join(","))),m&&g.push("auth_referrer_policy=".concat(m)),g.push("loading=async"),g.push("callback=initMap"),"https://maps.googleapis.com/maps/api/js?".concat(g.join("&"))}var Ne=typeof document<"u";function Da(t){var{url:e,id:n,nonce:i}=t;return Ne?new Promise(function(s,r){var c=document.getElementById(n),p=window;if(c){var m=c.getAttribute("data-state");if(c.src===e&&m!=="error"){if(m==="ready")return s(n);var g=p.initMap,x=c.onerror;p.initMap=function(){g&&g(),s(n)},c.onerror=function(f){x&&x(f),r(f)};return}else c.remove()}var u=document.createElement("script");u.type="text/javascript",u.src=e,u.id=n,u.async=!0,u.nonce=i||"",u.onerror=function(d){u.setAttribute("data-state","error"),r(d)},p.initMap=function(){u.setAttribute("data-state","ready"),s(n)},document.head.appendChild(u)}).catch(a=>{throw console.error("injectScript error: ",a),a}):Promise.reject(new Error("document is undefined"))}function Rn(t){var e=t.href;return e&&(e.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||e.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:t.tagName.toLowerCase()==="style"&&t.styleSheet&&t.styleSheet.cssText&&t.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(t.styleSheet.cssText="",!0):t.tagName.toLowerCase()==="style"&&t.innerHTML&&t.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(t.innerHTML="",!0):t.tagName.toLowerCase()==="style"&&!t.styleSheet&&!t.innerHTML}function rn(){var t=document.getElementsByTagName("head")[0];if(t){var e=t.insertBefore.bind(t);t.insertBefore=function(a,s){return Rn(a)||Reflect.apply(e,t,[a,s]),a};var n=t.appendChild.bind(t);t.appendChild=function(a){return Rn(a)||Reflect.apply(n,t,[a]),a}}}var ot=!1;function Ia(){return l.jsx("div",{children:"Loading..."})}var mt={id:"script-loader",version:"weekly"};class Ro extends o.PureComponent{constructor(){super(...arguments),M(this,"check",null),M(this,"state",{loaded:!1}),M(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),M(this,"isCleaningUp",Oa(function*(){function e(n){if(!ot)n();else if(Ne)var i=window.setInterval(function(){ot||(window.clearInterval(i),n())},1)}return new Promise(e)})),M(this,"cleanup",()=>{ot=!0;var e=document.getElementById(this.props.id);e&&e.parentNode&&e.parentNode.removeChild(e),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(i){return typeof i.src=="string"&&i.src.includes("maps.googleapis")}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(i){return i.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(i){return i.innerText!==void 0&&i.innerText.length>0&&i.innerText.includes(".gm-")}).forEach(function(i){i.parentNode&&i.parentNode.removeChild(i)})}),M(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&rn(),de(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var e={id:this.props.id,nonce:this.props.nonce,url:_a(this.props)};Da(e).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(n=>{this.props.onError&&this.props.onError(n),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})}),M(this,"getRef",e=>{this.check=e})}componentDidMount(){if(Ne){if(window.google&&window.google.maps&&!ot){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(n){console.error("Error at injecting script after cleaning up: ",n)})}}componentDidUpdate(e){this.props.libraries!==e.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),Ne&&e.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(Ne){this.cleanup();var e=()=>{this.check||(delete window.google,ot=!1)};window.setTimeout(e,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return l.jsxs(l.Fragment,{children:[l.jsx("div",{ref:this.getRef}),this.state.loaded?this.props.children:this.props.loadingElement||l.jsx(Ia,{})]})}}M(Ro,"defaultProps",mt);function Ao(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.includes(i))continue;n[i]=t[i]}return n}function ln(t,e){if(t==null)return{};var n,i,a=Ao(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],e.includes(n)||{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}var An;function To(t){var{id:e=mt.id,version:n=mt.version,nonce:i,googleMapsApiKey:a,googleMapsClientId:s,language:r,region:c,libraries:p,preventGoogleFontsLoading:m,channel:g,mapIds:x,authReferrerPolicy:u}=t,f=o.useRef(!1),[d,h]=o.useState(!1),[b,L]=o.useState(void 0);o.useEffect(function(){return f.current=!0,()=>{f.current=!1}},[]),o.useEffect(function(){Ne&&m&&rn()},[m]),o.useEffect(function(){d&&de(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[d]);var C=_a({version:n,googleMapsApiKey:a,googleMapsClientId:s,language:r,region:c,libraries:p,channel:g,mapIds:x,authReferrerPolicy:u});o.useEffect(function(){if(!Ne)return;function y(){f.current&&(h(!0),An=C)}if(window.google&&window.google.maps&&An===C){y();return}Da({id:e,url:C,nonce:i}).then(y).catch(function(w){f.current&&L(w),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(a||"-",") or Client ID (").concat(s||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(w)})},[e,C,i]);var k=o.useRef(void 0);return o.useEffect(function(){k.current&&p!==k.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),k.current=p},[p]),{isLoaded:d,loadError:b,url:C}}var Fo=["loadingElement","onLoad","onError","onUnmount","children"],Uo=l.jsx(Ia,{});function zo(t){var{loadingElement:e,onLoad:n,onError:i,onUnmount:a,children:s}=t,r=ln(t,Fo),{isLoaded:c,loadError:p}=To(r);return o.useEffect(function(){c&&typeof n=="function"&&n()},[c,n]),o.useEffect(function(){p&&typeof i=="function"&&i(p)},[p,i]),o.useEffect(function(){return()=>{a&&a()}},[a]),c?s:e||Uo}o.memo(zo);function Bo(t,e,n,i){function a(s){return s instanceof n?s:new n(function(r){r(s)})}return new(n||(n=Promise))(function(s,r){function c(g){try{m(i.next(g))}catch(x){r(x)}}function p(g){try{m(i.throw(g))}catch(x){r(x)}}function m(g){g.done?s(g.value):a(g.value).then(c,p)}m((i=i.apply(t,[])).next())})}function $o(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Wo=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var i,a,s;if(Array.isArray(e)){if(i=e.length,i!=n.length)return!1;for(a=i;a--!==0;)if(!t(e[a],n[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),i=s.length,i!==Object.keys(n).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[a]))return!1;for(a=i;a--!==0;){var r=s[a];if(!t(e[r],n[r]))return!1}return!0}return e!==e&&n!==n},qo=$o(Wo),Tn="__googleMapsScriptId",Ye;(function(t){t[t.INITIALIZED=0]="INITIALIZED",t[t.LOADING=1]="LOADING",t[t.SUCCESS=2]="SUCCESS",t[t.FAILURE=3]="FAILURE"})(Ye||(Ye={}));class Be{constructor(e){var{apiKey:n,authReferrerPolicy:i,channel:a,client:s,id:r=Tn,language:c,libraries:p=[],mapIds:m,nonce:g,region:x,retries:u=3,url:f="https://maps.googleapis.com/maps/api/js",version:d}=e;if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=n,this.authReferrerPolicy=i,this.channel=a,this.client=s,this.id=r||Tn,this.language=c,this.libraries=p,this.mapIds=m,this.nonce=g,this.region=x,this.retries=u,this.url=f,this.version=d,Be.instance){if(!qo(this.options,Be.instance.options))throw new Error("Loader must not be called again with different options. ".concat(JSON.stringify(this.options)," !== ").concat(JSON.stringify(Be.instance.options)));return Be.instance}Be.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?Ye.FAILURE:this.done?Ye.SUCCESS:this.loading?Ye.LOADING:Ye.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){var e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+="&key=".concat(this.apiKey)),this.channel&&(e+="&channel=".concat(this.channel)),this.client&&(e+="&client=".concat(this.client)),this.libraries.length>0&&(e+="&libraries=".concat(this.libraries.join(","))),this.language&&(e+="&language=".concat(this.language)),this.region&&(e+="&region=".concat(this.region)),this.version&&(e+="&v=".concat(this.version)),this.mapIds&&(e+="&map_ids=".concat(this.mapIds.join(","))),this.authReferrerPolicy&&(e+="&auth_referrer_policy=".concat(this.authReferrerPolicy)),e}deleteScript(){var e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,n)=>{this.loadCallback(i=>{i?n(i.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,n;if(document.getElementById(this.id)){this.callback();return}var i={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(i).forEach(s=>!i[s]&&delete i[s]),!((n=(e=window?.google)===null||e===void 0?void 0:e.maps)===null||n===void 0)&&n.importLibrary||(s=>{var r,c,p,m="The Google Maps JavaScript API",g="google",x="importLibrary",u="__ib__",f=document,d=window;d=d[g]||(d[g]={});var h=d.maps||(d.maps={}),b=new Set,L=new URLSearchParams,C=()=>r||(r=new Promise((k,v)=>Bo(this,void 0,void 0,function*(){var y;yield c=f.createElement("script"),c.id=this.id,L.set("libraries",[...b]+"");for(p in s)L.set(p.replace(/[A-Z]/g,E=>"_"+E[0].toLowerCase()),s[p]);L.set("callback",g+".maps."+u),c.src=this.url+"?"+L,h[u]=k,c.onerror=()=>r=v(Error(m+" could not load.")),c.nonce=this.nonce||((y=f.querySelector("script[nonce]"))===null||y===void 0?void 0:y.nonce)||"",f.head.append(c)})));h[x]?console.warn(m+" only loads once. Ignoring:",s):h[x]=function(k){for(var v=arguments.length,y=new Array(v>1?v-1:0),E=1;E<v;E++)y[E-1]=arguments[E];return b.add(k)&&C().then(()=>h[x](k,...y))}})(i);var a=this.libraries.map(s=>this.importLibrary(s));a.length||a.push(this.importLibrary("core")),Promise.all(a).then(()=>this.callback(),s=>{var r=new ErrorEvent("error",{error:s});this.loadErrorCallback(r)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){var n=this.errors.length*Math.pow(2,this.errors.length);console.error("Failed to load Google Maps script, retrying in ".concat(n," ms.")),setTimeout(()=>{this.deleteScript(),this.setScript()},n)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}var Vo=["maps"];function Ho(t){var{id:e=mt.id,version:n=mt.version,nonce:i,googleMapsApiKey:a,language:s,region:r,libraries:c=Vo,preventGoogleFontsLoading:p,mapIds:m,authReferrerPolicy:g}=t,x=o.useRef(!1),[u,f]=o.useState(!1),[d,h]=o.useState(void 0);o.useEffect(function(){return x.current=!0,()=>{x.current=!1}},[]);var b=o.useMemo(()=>new Be({id:e,apiKey:a,version:n,libraries:c,language:s||"en",region:r||"US",mapIds:m||[],nonce:i||"",authReferrerPolicy:g||"origin"}),[e,a,n,c,s,r,m,i,g]);o.useEffect(function(){u||b.load().then(()=>{x.current&&f(!0)}).catch(k=>{h(k)})},[]),o.useEffect(()=>{Ne&&p&&rn()},[p]);var L=o.useRef();return o.useEffect(()=>{L.current&&c!==L.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),L.current=c},[c]),{isLoaded:u,loadError:d}}function Fn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Mt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Fn(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fn(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var Un={},zn={options(t,e){t.setOptions(e)}};function Zo(t){var{options:e,onLoad:n,onUnmount:i}=t,a=o.useContext(J),[s,r]=o.useState(null);return o.useEffect(()=>{s!==null&&s.setMap(a)},[a]),o.useEffect(()=>{e&&s!==null&&s.setOptions(e)},[s,e]),o.useEffect(()=>{var c=new google.maps.TrafficLayer(Mt(Mt({},e),{},{map:a}));return r(c),n&&n(c),()=>{s!==null&&(i&&i(s),s.setMap(null))}},[]),null}o.memo(Zo);class Go extends o.PureComponent{constructor(){super(...arguments),M(this,"state",{trafficLayer:null}),M(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),M(this,"registeredEvents",[])}componentDidMount(){var e=new google.maps.TrafficLayer(Mt(Mt({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:zn,eventMap:Un,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{trafficLayer:e}},this.setTrafficLayerCallback)}componentDidUpdate(e){this.state.trafficLayer!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:zn,eventMap:Un,prevProps:e,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),te(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}M(Go,"contextType",J);function Ko(t){var{onLoad:e,onUnmount:n}=t,i=o.useContext(J),[a,s]=o.useState(null);return o.useEffect(()=>{a!==null&&a.setMap(i)},[i]),o.useEffect(()=>{var r=new google.maps.BicyclingLayer;return s(r),r.setMap(i),e&&e(r),()=>{r!==null&&(n&&n(r),r.setMap(null))}},[]),null}o.memo(Ko);class Yo extends o.PureComponent{constructor(){super(...arguments),M(this,"state",{bicyclingLayer:null}),M(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var e=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:e}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}M(Yo,"contextType",J);function Xo(t){var{onLoad:e,onUnmount:n}=t,i=o.useContext(J),[a,s]=o.useState(null);return o.useEffect(()=>{a!==null&&a.setMap(i)},[i]),o.useEffect(()=>{var r=new google.maps.TransitLayer;return s(r),r.setMap(i),e&&e(r),()=>{a!==null&&(n&&n(a),a.setMap(null))}},[]),null}o.memo(Xo);class Jo extends o.PureComponent{constructor(){super(...arguments),M(this,"state",{transitLayer:null}),M(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var e=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:e}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}M(Jo,"contextType",J);function Bn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Pt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Bn(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bn(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var $n={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},Wn={drawingMode(t,e){t.setDrawingMode(e)},options(t,e){t.setOptions(e)}};function Qo(t){var{options:e,drawingMode:n,onCircleComplete:i,onMarkerComplete:a,onOverlayComplete:s,onPolygonComplete:r,onPolylineComplete:c,onRectangleComplete:p,onLoad:m,onUnmount:g}=t,x=o.useContext(J),[u,f]=o.useState(null),[d,h]=o.useState(null),[b,L]=o.useState(null),[C,k]=o.useState(null),[v,y]=o.useState(null),[E,w]=o.useState(null),[P,S]=o.useState(null);return o.useEffect(()=>{u!==null&&u.setMap(x)},[x]),o.useEffect(()=>{e&&u!==null&&u.setOptions(e)},[u,e]),o.useEffect(()=>{u!==null&&u.setDrawingMode(n??null)},[u,n]),o.useEffect(()=>{u&&i&&(d!==null&&google.maps.event.removeListener(d),h(google.maps.event.addListener(u,"circlecomplete",i)))},[u,i]),o.useEffect(()=>{u&&a&&(b!==null&&google.maps.event.removeListener(b),L(google.maps.event.addListener(u,"markercomplete",a)))},[u,a]),o.useEffect(()=>{u&&s&&(C!==null&&google.maps.event.removeListener(C),k(google.maps.event.addListener(u,"overlaycomplete",s)))},[u,s]),o.useEffect(()=>{u&&r&&(v!==null&&google.maps.event.removeListener(v),y(google.maps.event.addListener(u,"polygoncomplete",r)))},[u,r]),o.useEffect(()=>{u&&c&&(E!==null&&google.maps.event.removeListener(E),w(google.maps.event.addListener(u,"polylinecomplete",c)))},[u,c]),o.useEffect(()=>{u&&p&&(P!==null&&google.maps.event.removeListener(P),S(google.maps.event.addListener(u,"rectanglecomplete",p)))},[u,p]),o.useEffect(()=>{de(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var N=new google.maps.drawing.DrawingManager(Pt(Pt({},e),{},{map:x}));return n&&N.setDrawingMode(n),i&&h(google.maps.event.addListener(N,"circlecomplete",i)),a&&L(google.maps.event.addListener(N,"markercomplete",a)),s&&k(google.maps.event.addListener(N,"overlaycomplete",s)),r&&y(google.maps.event.addListener(N,"polygoncomplete",r)),c&&w(google.maps.event.addListener(N,"polylinecomplete",c)),p&&S(google.maps.event.addListener(N,"rectanglecomplete",p)),f(N),m&&m(N),()=>{u!==null&&(d&&google.maps.event.removeListener(d),b&&google.maps.event.removeListener(b),C&&google.maps.event.removeListener(C),v&&google.maps.event.removeListener(v),E&&google.maps.event.removeListener(E),P&&google.maps.event.removeListener(P),g&&g(u),u.setMap(null))}},[]),null}o.memo(Qo);class er extends o.PureComponent{constructor(e){super(e),M(this,"registeredEvents",[]),M(this,"state",{drawingManager:null}),M(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),de(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var e=new google.maps.drawing.DrawingManager(Pt(Pt({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:Wn,eventMap:$n,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{drawingManager:e}},this.setDrawingManagerCallback)}componentDidUpdate(e){this.state.drawingManager!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Wn,eventMap:$n,prevProps:e,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),te(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}M(er,"contextType",J);function qn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Qe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?qn(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qn(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var Vn={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},Hn={animation(t,e){t.setAnimation(e)},clickable(t,e){t.setClickable(e)},cursor(t,e){t.setCursor(e)},draggable(t,e){t.setDraggable(e)},icon(t,e){t.setIcon(e)},label(t,e){t.setLabel(e)},map(t,e){t.setMap(e)},opacity(t,e){t.setOpacity(e)},options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},shape(t,e){t.setShape(e)},title(t,e){t.setTitle(e)},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},Ot={};function tr(t){var{position:e,options:n,clusterer:i,noClustererRedraw:a,children:s,draggable:r,visible:c,animation:p,clickable:m,cursor:g,icon:x,label:u,opacity:f,shape:d,title:h,zIndex:b,onClick:L,onDblClick:C,onDrag:k,onDragEnd:v,onDragStart:y,onMouseOut:E,onMouseOver:w,onMouseUp:P,onMouseDown:S,onRightClick:N,onClickableChanged:D,onCursorChanged:_,onAnimationChanged:A,onDraggableChanged:T,onFlatChanged:I,onIconChanged:$,onPositionChanged:Y,onShapeChanged:Z,onTitleChanged:G,onVisibleChanged:Q,onZindexChanged:ie,onLoad:ne,onUnmount:W}=t,O=o.useContext(J),[j,F]=o.useState(null),[q,z]=o.useState(null),[K,U]=o.useState(null),[B,se]=o.useState(null),[xe,ke]=o.useState(null),[oe,at]=o.useState(null),[be,We]=o.useState(null),[Ee,Ae]=o.useState(null),[qe,ft]=o.useState(null),[Ve,R]=o.useState(null),[H,le]=o.useState(null),[ce,fe]=o.useState(null),[we,Ce]=o.useState(null),[Se,He]=o.useState(null),[Me,Te]=o.useState(null),[Pe,Ze]=o.useState(null),[Oe,Ge]=o.useState(null),[Ke,un]=o.useState(null),[mn,fn]=o.useState(null),[gt,gn]=o.useState(null),[ht,hn]=o.useState(null),[vt,vn]=o.useState(null);o.useEffect(()=>{j!==null&&j.setMap(O)},[O]),o.useEffect(()=>{typeof n<"u"&&j!==null&&j.setOptions(n)},[j,n]),o.useEffect(()=>{typeof r<"u"&&j!==null&&j.setDraggable(r)},[j,r]),o.useEffect(()=>{e&&j!==null&&j.setPosition(e)},[j,e]),o.useEffect(()=>{typeof c<"u"&&j!==null&&j.setVisible(c)},[j,c]),o.useEffect(()=>{j?.setAnimation(p)},[j,p]),o.useEffect(()=>{j&&m!==void 0&&j.setClickable(m)},[j,m]),o.useEffect(()=>{j&&g!==void 0&&j.setCursor(g)},[j,g]),o.useEffect(()=>{j&&x!==void 0&&j.setIcon(x)},[j,x]),o.useEffect(()=>{j&&u!==void 0&&j.setLabel(u)},[j,u]),o.useEffect(()=>{j&&f!==void 0&&j.setOpacity(f)},[j,f]),o.useEffect(()=>{j&&d!==void 0&&j.setShape(d)},[j,d]),o.useEffect(()=>{j&&h!==void 0&&j.setTitle(h)},[j,h]),o.useEffect(()=>{j&&b!==void 0&&j.setZIndex(b)},[j,b]),o.useEffect(()=>{j&&C&&(q!==null&&google.maps.event.removeListener(q),z(google.maps.event.addListener(j,"dblclick",C)))},[C]),o.useEffect(()=>{j&&v&&(K!==null&&google.maps.event.removeListener(K),U(google.maps.event.addListener(j,"dragend",v)))},[v]),o.useEffect(()=>{j&&y&&(B!==null&&google.maps.event.removeListener(B),se(google.maps.event.addListener(j,"dragstart",y)))},[y]),o.useEffect(()=>{j&&S&&(xe!==null&&google.maps.event.removeListener(xe),ke(google.maps.event.addListener(j,"mousedown",S)))},[S]),o.useEffect(()=>{j&&E&&(oe!==null&&google.maps.event.removeListener(oe),at(google.maps.event.addListener(j,"mouseout",E)))},[E]),o.useEffect(()=>{j&&w&&(be!==null&&google.maps.event.removeListener(be),We(google.maps.event.addListener(j,"mouseover",w)))},[w]),o.useEffect(()=>{j&&P&&(Ee!==null&&google.maps.event.removeListener(Ee),Ae(google.maps.event.addListener(j,"mouseup",P)))},[P]),o.useEffect(()=>{j&&N&&(qe!==null&&google.maps.event.removeListener(qe),ft(google.maps.event.addListener(j,"rightclick",N)))},[N]),o.useEffect(()=>{j&&L&&(Ve!==null&&google.maps.event.removeListener(Ve),R(google.maps.event.addListener(j,"click",L)))},[L]),o.useEffect(()=>{j&&k&&(H!==null&&google.maps.event.removeListener(H),le(google.maps.event.addListener(j,"drag",k)))},[k]),o.useEffect(()=>{j&&D&&(ce!==null&&google.maps.event.removeListener(ce),fe(google.maps.event.addListener(j,"clickable_changed",D)))},[D]),o.useEffect(()=>{j&&_&&(we!==null&&google.maps.event.removeListener(we),Ce(google.maps.event.addListener(j,"cursor_changed",_)))},[_]),o.useEffect(()=>{j&&A&&(Se!==null&&google.maps.event.removeListener(Se),He(google.maps.event.addListener(j,"animation_changed",A)))},[A]),o.useEffect(()=>{j&&T&&(Me!==null&&google.maps.event.removeListener(Me),Te(google.maps.event.addListener(j,"draggable_changed",T)))},[T]),o.useEffect(()=>{j&&I&&(Pe!==null&&google.maps.event.removeListener(Pe),Ze(google.maps.event.addListener(j,"flat_changed",I)))},[I]),o.useEffect(()=>{j&&$&&(Oe!==null&&google.maps.event.removeListener(Oe),Ge(google.maps.event.addListener(j,"icon_changed",$)))},[$]),o.useEffect(()=>{j&&Y&&(Ke!==null&&google.maps.event.removeListener(Ke),un(google.maps.event.addListener(j,"position_changed",Y)))},[Y]),o.useEffect(()=>{j&&Z&&(mn!==null&&google.maps.event.removeListener(mn),fn(google.maps.event.addListener(j,"shape_changed",Z)))},[Z]),o.useEffect(()=>{j&&G&&(gt!==null&&google.maps.event.removeListener(gt),gn(google.maps.event.addListener(j,"title_changed",G)))},[G]),o.useEffect(()=>{j&&Q&&(ht!==null&&google.maps.event.removeListener(ht),hn(google.maps.event.addListener(j,"visible_changed",Q)))},[Q]),o.useEffect(()=>{j&&ie&&(vt!==null&&google.maps.event.removeListener(vt),vn(google.maps.event.addListener(j,"zindex_changed",ie)))},[ie]),o.useEffect(()=>{var st=Qe(Qe(Qe({},n||Ot),i?Ot:{map:O}),{},{position:e}),X=new google.maps.Marker(st);return i?i.addMarker(X,!!a):X.setMap(O),e&&X.setPosition(e),typeof c<"u"&&X.setVisible(c),typeof r<"u"&&X.setDraggable(r),typeof m<"u"&&X.setClickable(m),typeof g=="string"&&X.setCursor(g),x&&X.setIcon(x),typeof u<"u"&&X.setLabel(u),typeof f<"u"&&X.setOpacity(f),d&&X.setShape(d),typeof h=="string"&&X.setTitle(h),typeof b=="number"&&X.setZIndex(b),C&&z(google.maps.event.addListener(X,"dblclick",C)),v&&U(google.maps.event.addListener(X,"dragend",v)),y&&se(google.maps.event.addListener(X,"dragstart",y)),S&&ke(google.maps.event.addListener(X,"mousedown",S)),E&&at(google.maps.event.addListener(X,"mouseout",E)),w&&We(google.maps.event.addListener(X,"mouseover",w)),P&&Ae(google.maps.event.addListener(X,"mouseup",P)),N&&ft(google.maps.event.addListener(X,"rightclick",N)),L&&R(google.maps.event.addListener(X,"click",L)),k&&le(google.maps.event.addListener(X,"drag",k)),D&&fe(google.maps.event.addListener(X,"clickable_changed",D)),_&&Ce(google.maps.event.addListener(X,"cursor_changed",_)),A&&He(google.maps.event.addListener(X,"animation_changed",A)),T&&Te(google.maps.event.addListener(X,"draggable_changed",T)),I&&Ze(google.maps.event.addListener(X,"flat_changed",I)),$&&Ge(google.maps.event.addListener(X,"icon_changed",$)),Y&&un(google.maps.event.addListener(X,"position_changed",Y)),Z&&fn(google.maps.event.addListener(X,"shape_changed",Z)),G&&gn(google.maps.event.addListener(X,"title_changed",G)),Q&&hn(google.maps.event.addListener(X,"visible_changed",Q)),ie&&vn(google.maps.event.addListener(X,"zindex_changed",ie)),F(X),ne&&ne(X),()=>{q!==null&&google.maps.event.removeListener(q),K!==null&&google.maps.event.removeListener(K),B!==null&&google.maps.event.removeListener(B),xe!==null&&google.maps.event.removeListener(xe),oe!==null&&google.maps.event.removeListener(oe),be!==null&&google.maps.event.removeListener(be),Ee!==null&&google.maps.event.removeListener(Ee),qe!==null&&google.maps.event.removeListener(qe),Ve!==null&&google.maps.event.removeListener(Ve),ce!==null&&google.maps.event.removeListener(ce),we!==null&&google.maps.event.removeListener(we),Se!==null&&google.maps.event.removeListener(Se),Me!==null&&google.maps.event.removeListener(Me),Pe!==null&&google.maps.event.removeListener(Pe),Oe!==null&&google.maps.event.removeListener(Oe),Ke!==null&&google.maps.event.removeListener(Ke),gt!==null&&google.maps.event.removeListener(gt),ht!==null&&google.maps.event.removeListener(ht),vt!==null&&google.maps.event.removeListener(vt),W&&W(X),i?i.removeMarker(X,!!a):X&&X.setMap(null)}},[]);var qa=o.useMemo(()=>s?o.Children.map(s,st=>{if(!o.isValidElement(st))return st;var X=st;return o.cloneElement(X,{anchor:j})}):null,[s,j]);return l.jsx(l.Fragment,{children:qa})||null}o.memo(tr);class Na extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[])}componentDidMount(){var e=this;return Oa(function*(){var n=Qe(Qe(Qe({},e.props.options||Ot),e.props.clusterer?Ot:{map:e.context}),{},{position:e.props.position});e.marker=new google.maps.Marker(n),e.props.clusterer?e.props.clusterer.addMarker(e.marker,!!e.props.noClustererRedraw):e.marker.setMap(e.context),e.registeredEvents=ee({updaterMap:Hn,eventMap:Vn,prevProps:{},nextProps:e.props,instance:e.marker}),e.props.onLoad&&e.props.onLoad(e.marker)})()}componentDidUpdate(e){this.marker&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Hn,eventMap:Vn,prevProps:e,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),te(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var e=this.props.children?o.Children.map(this.props.children,n=>{if(!o.isValidElement(n))return n;var i=n;return o.cloneElement(i,{anchor:this.marker})}):null;return e||null}}M(Na,"contextType",J);var nr=function(){function t(e,n){e.getClusterer().extend(t,google.maps.OverlayView),this.cluster=e,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=n,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(e.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return t.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},t.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},t.prototype.onClick=function(e){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var n=this.cluster.getClusterer();if(google.maps.event.trigger(n,"click",this.cluster),google.maps.event.trigger(n,"clusterclick",this.cluster),n.getZoomOnClick()){var i=n.getMaxZoom(),a=this.cluster.getBounds(),s=n.getMap();s!==null&&"fitBounds"in s&&s.fitBounds(a),this.timeOut=window.setTimeout(function(){var r=n.getMap();if(r!==null){"fitBounds"in r&&r.fitBounds(a);var c=r.getZoom()||0;i!==null&&c>i&&r.setZoom(i+1)}},100)}e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}},t.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},t.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},t.prototype.onAdd=function(){var e;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(e=this.getPanes())===null||e===void 0||e.overlayMouseTarget.appendChild(this.div);var n=this.getMap();n!==null&&(this.boundsChangedListener=google.maps.event.addListener(n,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},t.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var e=this.getPosFromLatLng(this.center);this.div.style.top=e!==null?"".concat(e.y,"px"):"0",this.div.style.left=e!==null?"".concat(e.x,"px"):"0"}},t.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},t.prototype.show=function(){var e,n,i,a,s,r;if(this.div&&this.center){var c=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,p=this.backgroundPosition.split(" "),m=parseInt(((e=p[0])===null||e===void 0?void 0:e.replace(/^\s+|\s+$/g,""))||"0",10),g=parseInt(((n=p[1])===null||n===void 0?void 0:n.replace(/^\s+|\s+$/g,""))||"0",10),x=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(x!==null?"".concat(x.y,"px"):"0","; left: ").concat(x!==null?"".concat(x.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var u=document.createElement("img");u.alt=c,u.src=this.url,u.width=this.width,u.height=this.height,u.setAttribute("style","position: absolute; top: ".concat(g,"px; left: ").concat(m,"px")),this.cluster.getClusterer().enableRetinaIcons||(u.style.clip="rect(-".concat(g,"px, -").concat(m+this.width,"px, -").concat(g+this.height,", -").concat(m,")"));var f=document.createElement("div");f.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((i=this.sums)===null||i===void 0)&&i.text&&(f.innerText="".concat((a=this.sums)===null||a===void 0?void 0:a.text)),!((s=this.sums)===null||s===void 0)&&s.html&&(f.innerHTML="".concat((r=this.sums)===null||r===void 0?void 0:r.html)),this.div.innerHTML="",this.div.appendChild(u),this.div.appendChild(f),this.div.title=c,this.div.style.display=""}this.visible=!0},t.prototype.useStyle=function(e){this.sums=e;var n=this.cluster.getClusterer().getStyles(),i=n[Math.min(n.length-1,Math.max(0,e.index-1))];i&&(this.url=i.url,this.height=i.height,this.width=i.width,i.className&&(this.className="".concat(this.clusterClassName," ").concat(i.className)),this.anchorText=i.anchorText||[0,0],this.anchorIcon=i.anchorIcon||[this.height/2,this.width/2],this.textColor=i.textColor||"black",this.textSize=i.textSize||11,this.textDecoration=i.textDecoration||"none",this.fontWeight=i.fontWeight||"bold",this.fontStyle=i.fontStyle||"normal",this.fontFamily=i.fontFamily||"Arial,sans-serif",this.backgroundPosition=i.backgroundPosition||"0 0")},t.prototype.setCenter=function(e){this.center=e},t.prototype.getPosFromLatLng=function(e){var n=this.getProjection().fromLatLngToDivPixel(e);return n!==null&&(n.x-=this.anchorIcon[1],n.y-=this.anchorIcon[0]),n},t}(),ir=function(){function t(e){this.markerClusterer=e,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new nr(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return t.prototype.getSize=function(){return this.markers.length},t.prototype.getMarkers=function(){return this.markers},t.prototype.getCenter=function(){return this.center},t.prototype.getMap=function(){return this.map},t.prototype.getClusterer=function(){return this.markerClusterer},t.prototype.getBounds=function(){for(var e=new google.maps.LatLngBounds(this.center,this.center),n=this.getMarkers(),i=0,a=n;i<a.length;i++){var s=a[i],r=s.getPosition();r&&e.extend(r)}return e},t.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},t.prototype.addMarker=function(e){var n;if(this.isMarkerAlreadyAdded(e))return!1;if(this.center){if(this.averageCenter){var i=e.getPosition();if(i){var a=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(a-1)+i.lat())/a,(this.center.lng()*(a-1)+i.lng())/a),this.calculateBounds()}}}else{var i=e.getPosition();i&&(this.center=i,this.calculateBounds())}e.isAdded=!0,this.markers.push(e);var s=this.markers.length,r=this.markerClusterer.getMaxZoom(),c=(n=this.map)===null||n===void 0?void 0:n.getZoom();if(r!==null&&typeof c<"u"&&c>r)e.getMap()!==this.map&&e.setMap(this.map);else if(s<this.minClusterSize)e.getMap()!==this.map&&e.setMap(this.map);else if(s===this.minClusterSize)for(var p=0,m=this.markers;p<m.length;p++){var g=m[p];g.setMap(null)}else e.setMap(null);return!0},t.prototype.isMarkerInClusterBounds=function(e){if(this.bounds!==null){var n=e.getPosition();if(n)return this.bounds.contains(n)}return!1},t.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},t.prototype.updateIcon=function(){var e,n=this.markers.length,i=this.markerClusterer.getMaxZoom(),a=(e=this.map)===null||e===void 0?void 0:e.getZoom();if(i!==null&&typeof a<"u"&&a>i){this.clusterIcon.hide();return}if(n<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},t.prototype.isMarkerAlreadyAdded=function(e){if(this.markers.includes)return this.markers.includes(e);for(var n=0;n<this.markers.length;n++)if(e===this.markers[n])return!0;return!1},t}();function ar(t,e){var n=t.length,i=n.toString().length,a=Math.min(i,e);return{text:n.toString(),index:a,title:""}}var sr=2e3,or=500,rr="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",lr="png",cr=[53,56,66,78,90],pr="cluster",Ra=function(){function t(e,n,i){n===void 0&&(n=[]),i===void 0&&(i={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(t,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=i.gridSize||60,this.minClusterSize=i.minimumClusterSize||2,this.maxZoom=i.maxZoom||null,this.styles=i.styles||[],this.title=i.title||"",this.zoomOnClick=!0,i.zoomOnClick!==void 0&&(this.zoomOnClick=i.zoomOnClick),this.averageCenter=!1,i.averageCenter!==void 0&&(this.averageCenter=i.averageCenter),this.ignoreHidden=!1,i.ignoreHidden!==void 0&&(this.ignoreHidden=i.ignoreHidden),this.enableRetinaIcons=!1,i.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=i.enableRetinaIcons),this.imagePath=i.imagePath||rr,this.imageExtension=i.imageExtension||lr,this.imageSizes=i.imageSizes||cr,this.calculator=i.calculator||ar,this.batchSize=i.batchSize||sr,this.batchSizeIE=i.batchSizeIE||or,this.clusterClass=i.clusterClass||pr,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(n,!0),this.setMap(e)}return t.prototype.onZoomChanged=function(){var e,n;this.resetViewport(!1),(((e=this.getMap())===null||e===void 0?void 0:e.getZoom())===(this.get("minZoom")||0)||((n=this.getMap())===null||n===void 0?void 0:n.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},t.prototype.onIdle=function(){this.redraw()},t.prototype.onAdd=function(){var e=this.getMap();this.activeMap=e,this.ready=!0,this.repaint(),e!==null&&(this.listeners=[google.maps.event.addListener(e,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(e,"idle",this.onIdle)])},t.prototype.onRemove=function(){for(var e=0,n=this.markers;e<n.length;e++){var i=n[e];i.getMap()!==this.activeMap&&i.setMap(this.activeMap)}for(var a=0,s=this.clusters;a<s.length;a++){var r=s[a];r.remove()}this.clusters=[];for(var c=0,p=this.listeners;c<p.length;c++){var m=p[c];google.maps.event.removeListener(m)}this.listeners=[],this.activeMap=null,this.ready=!1},t.prototype.draw=function(){},t.prototype.getMap=function(){return null},t.prototype.getPanes=function(){return null},t.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},t.prototype.setMap=function(){},t.prototype.addListener=function(){return{remove:function(){}}},t.prototype.bindTo=function(){},t.prototype.get=function(){},t.prototype.notify=function(){},t.prototype.set=function(){},t.prototype.setValues=function(){},t.prototype.unbind=function(){},t.prototype.unbindAll=function(){},t.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var e=0;e<this.imageSizes.length;e++)this.styles.push({url:"".concat(this.imagePath+(e+1),".").concat(this.imageExtension),height:this.imageSizes[e]||0,width:this.imageSizes[e]||0})},t.prototype.fitMapToMarkers=function(){for(var e=this.getMarkers(),n=new google.maps.LatLngBounds,i=0,a=e;i<a.length;i++){var s=a[i],r=s.getPosition();r&&n.extend(r)}var c=this.getMap();c!==null&&"fitBounds"in c&&c.fitBounds(n)},t.prototype.getGridSize=function(){return this.gridSize},t.prototype.setGridSize=function(e){this.gridSize=e},t.prototype.getMinimumClusterSize=function(){return this.minClusterSize},t.prototype.setMinimumClusterSize=function(e){this.minClusterSize=e},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.setMaxZoom=function(e){this.maxZoom=e},t.prototype.getStyles=function(){return this.styles},t.prototype.setStyles=function(e){this.styles=e},t.prototype.getTitle=function(){return this.title},t.prototype.setTitle=function(e){this.title=e},t.prototype.getZoomOnClick=function(){return this.zoomOnClick},t.prototype.setZoomOnClick=function(e){this.zoomOnClick=e},t.prototype.getAverageCenter=function(){return this.averageCenter},t.prototype.setAverageCenter=function(e){this.averageCenter=e},t.prototype.getIgnoreHidden=function(){return this.ignoreHidden},t.prototype.setIgnoreHidden=function(e){this.ignoreHidden=e},t.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},t.prototype.setEnableRetinaIcons=function(e){this.enableRetinaIcons=e},t.prototype.getImageExtension=function(){return this.imageExtension},t.prototype.setImageExtension=function(e){this.imageExtension=e},t.prototype.getImagePath=function(){return this.imagePath},t.prototype.setImagePath=function(e){this.imagePath=e},t.prototype.getImageSizes=function(){return this.imageSizes},t.prototype.setImageSizes=function(e){this.imageSizes=e},t.prototype.getCalculator=function(){return this.calculator},t.prototype.setCalculator=function(e){this.calculator=e},t.prototype.getBatchSizeIE=function(){return this.batchSizeIE},t.prototype.setBatchSizeIE=function(e){this.batchSizeIE=e},t.prototype.getClusterClass=function(){return this.clusterClass},t.prototype.setClusterClass=function(e){this.clusterClass=e},t.prototype.getMarkers=function(){return this.markers},t.prototype.getTotalMarkers=function(){return this.markers.length},t.prototype.getClusters=function(){return this.clusters},t.prototype.getTotalClusters=function(){return this.clusters.length},t.prototype.addMarker=function(e,n){this.pushMarkerTo(e),n||this.redraw()},t.prototype.addMarkers=function(e,n){for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=e[i];a&&this.pushMarkerTo(a)}n||this.redraw()},t.prototype.pushMarkerTo=function(e){var n=this;e.getDraggable()&&google.maps.event.addListener(e,"dragend",function(){n.ready&&(e.isAdded=!1,n.repaint())}),e.isAdded=!1,this.markers.push(e)},t.prototype.removeMarker_=function(e){var n=-1;if(this.markers.indexOf)n=this.markers.indexOf(e);else for(var i=0;i<this.markers.length;i++)if(e===this.markers[i]){n=i;break}return n===-1?!1:(e.setMap(null),this.markers.splice(n,1),!0)},t.prototype.removeMarker=function(e,n){var i=this.removeMarker_(e);return!n&&i&&this.repaint(),i},t.prototype.removeMarkers=function(e,n){for(var i=!1,a=0,s=e;a<s.length;a++){var r=s[a];i=i||this.removeMarker_(r)}return!n&&i&&this.repaint(),i},t.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},t.prototype.repaint=function(){var e=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var i=0,a=e;i<a.length;i++){var s=a[i];s.remove()}},0)},t.prototype.getExtendedBounds=function(e){var n=this.getProjection(),i=n.fromLatLngToDivPixel(new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()));i!==null&&(i.x+=this.gridSize,i.y-=this.gridSize);var a=n.fromLatLngToDivPixel(new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()));if(a!==null&&(a.x-=this.gridSize,a.y+=this.gridSize),i!==null){var s=n.fromDivPixelToLatLng(i);s!==null&&e.extend(s)}if(a!==null){var r=n.fromDivPixelToLatLng(a);r!==null&&e.extend(r)}return e},t.prototype.redraw=function(){this.createClusters(0)},t.prototype.resetViewport=function(e){for(var n=0,i=this.clusters;n<i.length;n++){var a=i[n];a.remove()}this.clusters=[];for(var s=0,r=this.markers;s<r.length;s++){var c=r[s];c.isAdded=!1,e&&c.setMap(null)}},t.prototype.distanceBetweenPoints=function(e,n){var i=6371,a=(n.lat()-e.lat())*Math.PI/180,s=(n.lng()-e.lng())*Math.PI/180,r=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(n.lat()*Math.PI/180)*Math.sin(s/2)*Math.sin(s/2);return i*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))},t.prototype.isMarkerInBounds=function(e,n){var i=e.getPosition();return i?n.contains(i):!1},t.prototype.addToClosestCluster=function(e){for(var n,i=4e4,a=null,s=0,r=this.clusters;s<r.length;s++){var c=r[s];n=c;var p=n.getCenter(),m=e.getPosition();if(p&&m){var g=this.distanceBetweenPoints(p,m);g<i&&(i=g,a=n)}}a&&a.isMarkerInClusterBounds(e)?a.addMarker(e):(n=new ir(this),n.addMarker(e),this.clusters.push(n))},t.prototype.createClusters=function(e){var n=this;if(this.ready){e===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var i=this.getMap(),a=i!==null&&("getBounds"in i)?i.getBounds():null,s=i?.getZoom()||0,r=s>3?new google.maps.LatLngBounds(a?.getSouthWest(),a?.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),c=this.getExtendedBounds(r),p=Math.min(e+this.batchSize,this.markers.length),m=e;m<p;m++){var g=this.markers[m];g&&!g.isAdded&&this.isMarkerInBounds(g,c)&&(!this.ignoreHidden||this.ignoreHidden&&g.getVisible())&&this.addToClosestCluster(g)}if(p<this.markers.length)this.timerRefStatic=window.setTimeout(function(){n.createClusters(p)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var x=0,u=this.clusters;x<u.length;x++){var f=u[x];f.updateIcon()}}}},t.prototype.extend=function(e,n){return function(a){for(var s in a.prototype){var r=s;this.prototype[r]=a.prototype[r]}return this}.apply(e,[n])},t}();function Zn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function dr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Zn(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zn(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var ye={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},ae={averageCenter(t,e){t.setAverageCenter(e)},batchSizeIE(t,e){t.setBatchSizeIE(e)},calculator(t,e){t.setCalculator(e)},clusterClass(t,e){t.setClusterClass(e)},enableRetinaIcons(t,e){t.setEnableRetinaIcons(e)},gridSize(t,e){t.setGridSize(e)},ignoreHidden(t,e){t.setIgnoreHidden(e)},imageExtension(t,e){t.setImageExtension(e)},imagePath(t,e){t.setImagePath(e)},imageSizes(t,e){t.setImageSizes(e)},maxZoom(t,e){t.setMaxZoom(e)},minimumClusterSize(t,e){t.setMinimumClusterSize(e)},styles(t,e){t.setStyles(e)},title(t,e){t.setTitle(e)},zoomOnClick(t,e){t.setZoomOnClick(e)}},ur={};function mr(t){var{children:e,options:n,averageCenter:i,batchSizeIE:a,calculator:s,clusterClass:r,enableRetinaIcons:c,gridSize:p,ignoreHidden:m,imageExtension:g,imagePath:x,imageSizes:u,maxZoom:f,minimumClusterSize:d,styles:h,title:b,zoomOnClick:L,onClick:C,onClusteringBegin:k,onClusteringEnd:v,onMouseOver:y,onMouseOut:E,onLoad:w,onUnmount:P}=t,[S,N]=o.useState(null),D=o.useContext(J),[_,A]=o.useState(null),[T,I]=o.useState(null),[$,Y]=o.useState(null),[Z,G]=o.useState(null),[Q,ie]=o.useState(null);return o.useEffect(()=>{S&&E&&(Z!==null&&google.maps.event.removeListener(Z),G(google.maps.event.addListener(S,ye.onMouseOut,E)))},[E]),o.useEffect(()=>{S&&y&&(Q!==null&&google.maps.event.removeListener(Q),ie(google.maps.event.addListener(S,ye.onMouseOver,y)))},[y]),o.useEffect(()=>{S&&C&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(S,ye.onClick,C)))},[C]),o.useEffect(()=>{S&&k&&(T!==null&&google.maps.event.removeListener(T),I(google.maps.event.addListener(S,ye.onClusteringBegin,k)))},[k]),o.useEffect(()=>{S&&v&&($!==null&&google.maps.event.removeListener($),I(google.maps.event.addListener(S,ye.onClusteringEnd,v)))},[v]),o.useEffect(()=>{typeof i<"u"&&S!==null&&ae.averageCenter(S,i)},[S,i]),o.useEffect(()=>{typeof a<"u"&&S!==null&&ae.batchSizeIE(S,a)},[S,a]),o.useEffect(()=>{typeof s<"u"&&S!==null&&ae.calculator(S,s)},[S,s]),o.useEffect(()=>{typeof r<"u"&&S!==null&&ae.clusterClass(S,r)},[S,r]),o.useEffect(()=>{typeof c<"u"&&S!==null&&ae.enableRetinaIcons(S,c)},[S,c]),o.useEffect(()=>{typeof p<"u"&&S!==null&&ae.gridSize(S,p)},[S,p]),o.useEffect(()=>{typeof m<"u"&&S!==null&&ae.ignoreHidden(S,m)},[S,m]),o.useEffect(()=>{typeof g<"u"&&S!==null&&ae.imageExtension(S,g)},[S,g]),o.useEffect(()=>{typeof x<"u"&&S!==null&&ae.imagePath(S,x)},[S,x]),o.useEffect(()=>{typeof u<"u"&&S!==null&&ae.imageSizes(S,u)},[S,u]),o.useEffect(()=>{typeof f<"u"&&S!==null&&ae.maxZoom(S,f)},[S,f]),o.useEffect(()=>{typeof d<"u"&&S!==null&&ae.minimumClusterSize(S,d)},[S,d]),o.useEffect(()=>{typeof h<"u"&&S!==null&&ae.styles(S,h)},[S,h]),o.useEffect(()=>{typeof b<"u"&&S!==null&&ae.title(S,b)},[S,b]),o.useEffect(()=>{typeof L<"u"&&S!==null&&ae.zoomOnClick(S,L)},[S,L]),o.useEffect(()=>{if(D){var ne=dr({},n||ur),W=new Ra(D,[],ne);return i&&ae.averageCenter(W,i),a&&ae.batchSizeIE(W,a),s&&ae.calculator(W,s),r&&ae.clusterClass(W,r),c&&ae.enableRetinaIcons(W,c),p&&ae.gridSize(W,p),m&&ae.ignoreHidden(W,m),g&&ae.imageExtension(W,g),x&&ae.imagePath(W,x),u&&ae.imageSizes(W,u),f&&ae.maxZoom(W,f),d&&ae.minimumClusterSize(W,d),h&&ae.styles(W,h),b&&ae.title(W,b),L&&ae.zoomOnClick(W,L),E&&G(google.maps.event.addListener(W,ye.onMouseOut,E)),y&&ie(google.maps.event.addListener(W,ye.onMouseOver,y)),C&&A(google.maps.event.addListener(W,ye.onClick,C)),k&&I(google.maps.event.addListener(W,ye.onClusteringBegin,k)),v&&Y(google.maps.event.addListener(W,ye.onClusteringEnd,v)),N(W),w&&w(W),()=>{Z!==null&&google.maps.event.removeListener(Z),Q!==null&&google.maps.event.removeListener(Q),_!==null&&google.maps.event.removeListener(_),T!==null&&google.maps.event.removeListener(T),$!==null&&google.maps.event.removeListener($),P&&P(W)}}},[]),S!==null&&e(S)||null}o.memo(mr);class fr extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{markerClusterer:null}),M(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var e=new Ra(this.context,[],this.props.options);this.registeredEvents=ee({updaterMap:ae,eventMap:ye,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({markerClusterer:e}),this.setClustererCallback)}}componentDidUpdate(e){this.state.markerClusterer&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:ae,eventMap:ye,prevProps:e,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),te(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}M(fr,"contextType",J);function Gn(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}var Aa=function(){function t(e){e===void 0&&(e={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(t,google.maps.OverlayView),this.content=e.content||"",this.disableAutoPan=e.disableAutoPan||!1,this.maxWidth=e.maxWidth||0,this.pixelOffset=e.pixelOffset||new google.maps.Size(0,0),this.position=e.position||new google.maps.LatLng(0,0),this.zIndex=e.zIndex||null,this.boxClass=e.boxClass||"infoBox",this.boxStyle=e.boxStyle||{},this.closeBoxMargin=e.closeBoxMargin||"2px",this.closeBoxURL=e.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",e.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=e.infoBoxClearance||new google.maps.Size(1,1),typeof e.visible>"u"&&(typeof e.isHidden>"u"?e.visible=!0:e.visible=!e.isHidden),this.isHidden=!e.visible,this.alignBottom=e.alignBottom||!1,this.pane=e.pane||"floatPane",this.enableEventPropagation=e.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return t.prototype.createInfoBoxDiv=function(){var e=this,n=function(g){g.returnValue=!1,g.preventDefault&&g.preventDefault(),e.enableEventPropagation||Gn(g)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var i=this.getPanes();if(i!==null&&i[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var a=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-a.left-a.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var s=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],r=0,c=s;r<c.length;r++){var p=c[r];this.eventListeners.push(google.maps.event.addListener(this.div,p,Gn))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){e.div&&(e.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",n),google.maps.event.trigger(this,"domready")}},t.prototype.getCloseBoxImg=function(){var e="";return this.closeBoxURL!==""&&(e='<img alt=""',e+=' aria-hidden="true"',e+=" src='"+this.closeBoxURL+"'",e+=" align=right",e+=" style='",e+=" position: relative;",e+=" cursor: pointer;",e+=" margin: "+this.closeBoxMargin+";",e+="'>"),e},t.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},t.prototype.closeClickHandler=function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},t.prototype.getCloseClickHandler=function(){return this.closeClickHandler},t.prototype.panBox=function(e){if(this.div&&!e){var n=this.getMap();if(n instanceof google.maps.Map){var i=0,a=0,s=n.getBounds();s&&!s.contains(this.position)&&n.setCenter(this.position);var r=n.getDiv(),c=r.offsetWidth,p=r.offsetHeight,m=this.pixelOffset.width,g=this.pixelOffset.height,x=this.div.offsetWidth,u=this.div.offsetHeight,f=this.infoBoxClearance.width,d=this.infoBoxClearance.height,h=this.getProjection(),b=h.fromLatLngToContainerPixel(this.position);b!==null&&(b.x<-m+f?i=b.x+m-f:b.x+x+m+f>c&&(i=b.x+x+m+f-c),this.alignBottom?b.y<-g+d+u?a=b.y+g-d-u:b.y+g+d>p&&(a=b.y+g+d-p):b.y<-g+d?a=b.y+g-d:b.y+u+g+d>p&&(a=b.y+u+g+d-p)),i===0&&a===0||n.panBy(i,a)}}},t.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var e=this.boxStyle;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this.div.style[n]=e[n]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var i=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+i*100+')"',this.div.style.filter="alpha(opacity="+i*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},t.prototype.getBoxWidths=function(){var e={top:0,bottom:0,left:0,right:0};if(!this.div)return e;if(document.defaultView){var n=this.div.ownerDocument,i=n&&n.defaultView?n.defaultView.getComputedStyle(this.div,""):null;i&&(e.top=parseInt(i.borderTopWidth||"",10)||0,e.bottom=parseInt(i.borderBottomWidth||"",10)||0,e.left=parseInt(i.borderLeftWidth||"",10)||0,e.right=parseInt(i.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var a=this.div.currentStyle;a&&(e.top=parseInt(a.borderTopWidth||"",10)||0,e.bottom=parseInt(a.borderBottomWidth||"",10)||0,e.left=parseInt(a.borderLeftWidth||"",10)||0,e.right=parseInt(a.borderRightWidth||"",10)||0)}return e},t.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},t.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var e=this.getProjection(),n=e.fromLatLngToDivPixel(this.position);n!==null&&(this.div.style.left=n.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(n.y+this.pixelOffset.height)+"px":this.div.style.top=n.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},t.prototype.setOptions=function(e){e===void 0&&(e={}),typeof e.boxClass<"u"&&(this.boxClass=e.boxClass,this.setBoxStyle()),typeof e.boxStyle<"u"&&(this.boxStyle=e.boxStyle,this.setBoxStyle()),typeof e.content<"u"&&this.setContent(e.content),typeof e.disableAutoPan<"u"&&(this.disableAutoPan=e.disableAutoPan),typeof e.maxWidth<"u"&&(this.maxWidth=e.maxWidth),typeof e.pixelOffset<"u"&&(this.pixelOffset=e.pixelOffset),typeof e.alignBottom<"u"&&(this.alignBottom=e.alignBottom),typeof e.position<"u"&&this.setPosition(e.position),typeof e.zIndex<"u"&&this.setZIndex(e.zIndex),typeof e.closeBoxMargin<"u"&&(this.closeBoxMargin=e.closeBoxMargin),typeof e.closeBoxURL<"u"&&(this.closeBoxURL=e.closeBoxURL),typeof e.infoBoxClearance<"u"&&(this.infoBoxClearance=e.infoBoxClearance),typeof e.isHidden<"u"&&(this.isHidden=e.isHidden),typeof e.visible<"u"&&(this.isHidden=!e.visible),typeof e.enableEventPropagation<"u"&&(this.enableEventPropagation=e.enableEventPropagation),this.div&&this.draw()},t.prototype.setContent=function(e){this.content=e,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof e=="string"?this.div.innerHTML=this.getCloseBoxImg()+e:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(e))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},t.prototype.setPosition=function(e){this.position=e,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},t.prototype.setVisible=function(e){this.isHidden=!e,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},t.prototype.setZIndex=function(e){this.zIndex=e,this.div&&(this.div.style.zIndex=e+""),google.maps.event.trigger(this,"zindex_changed")},t.prototype.getContent=function(){return this.content},t.prototype.getPosition=function(){return this.position},t.prototype.getZIndex=function(){return this.zIndex},t.prototype.getVisible=function(){var e=this.getMap();return typeof e>"u"||e===null?!1:!this.isHidden},t.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},t.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},t.prototype.open=function(e,n){var i=this;n&&(this.position=n.getPosition(),this.moveListener=google.maps.event.addListener(n,"position_changed",function(){var a=n.getPosition();i.setPosition(a)}),this.mapListener=google.maps.event.addListener(n,"map_changed",function(){i.setMap(n.map)})),this.setMap(e),this.div&&this.panBox()},t.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var e=0,n=this.eventListeners;e<n.length;e++){var i=n[e];google.maps.event.removeListener(i)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},t.prototype.extend=function(e,n){return function(a){for(var s in a.prototype)Object.prototype.hasOwnProperty.call(this,s)||(this.prototype[s]=a.prototype[s]);return this}.apply(e,[n])},t}(),gr=["position"],hr=["position"];function Kn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function _t(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Kn(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Kn(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var Yn={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},Xn={options(t,e){t.setOptions(e)},position(t,e){e instanceof google.maps.LatLng?t.setPosition(e):t.setPosition(new google.maps.LatLng(e.lat,e.lng))},visible(t,e){t.setVisible(e)},zIndex(t,e){t.setZIndex(e)}},vr={};function xr(t){var{children:e,anchor:n,options:i,position:a,zIndex:s,onCloseClick:r,onDomReady:c,onContentChanged:p,onPositionChanged:m,onZindexChanged:g,onLoad:x,onUnmount:u}=t,f=o.useContext(J),[d,h]=o.useState(null),[b,L]=o.useState(null),[C,k]=o.useState(null),[v,y]=o.useState(null),[E,w]=o.useState(null),[P,S]=o.useState(null),N=o.useRef(null);return o.useEffect(()=>{f&&d!==null&&(d.close(),n?d.open(f,n):d.getPosition()&&d.open(f))},[f,d,n]),o.useEffect(()=>{i&&d!==null&&d.setOptions(i)},[d,i]),o.useEffect(()=>{if(a&&d!==null){var D=a instanceof google.maps.LatLng?a:new google.maps.LatLng(a.lat,a.lng);d.setPosition(D)}},[a]),o.useEffect(()=>{typeof s=="number"&&d!==null&&d.setZIndex(s)},[s]),o.useEffect(()=>{d&&r&&(b!==null&&google.maps.event.removeListener(b),L(google.maps.event.addListener(d,"closeclick",r)))},[r]),o.useEffect(()=>{d&&c&&(C!==null&&google.maps.event.removeListener(C),k(google.maps.event.addListener(d,"domready",c)))},[c]),o.useEffect(()=>{d&&p&&(v!==null&&google.maps.event.removeListener(v),y(google.maps.event.addListener(d,"content_changed",p)))},[p]),o.useEffect(()=>{d&&m&&(E!==null&&google.maps.event.removeListener(E),w(google.maps.event.addListener(d,"position_changed",m)))},[m]),o.useEffect(()=>{d&&g&&(P!==null&&google.maps.event.removeListener(P),S(google.maps.event.addListener(d,"zindex_changed",g)))},[g]),o.useEffect(()=>{if(f){var D=i||vr,{position:_}=D,A=ln(D,gr),T;_&&!(_ instanceof google.maps.LatLng)&&(T=new google.maps.LatLng(_.lat,_.lng));var I=new Aa(_t(_t({},A),T?{position:T}:{}));N.current=document.createElement("div"),h(I),r&&L(google.maps.event.addListener(I,"closeclick",r)),c&&k(google.maps.event.addListener(I,"domready",c)),p&&y(google.maps.event.addListener(I,"content_changed",p)),m&&w(google.maps.event.addListener(I,"position_changed",m)),g&&S(google.maps.event.addListener(I,"zindex_changed",g)),I.setContent(N.current),n?I.open(f,n):I.getPosition()?I.open(f):de(!1,"You must provide either an anchor or a position prop for <InfoBox>."),x&&x(I)}return()=>{d!==null&&(b&&google.maps.event.removeListener(b),v&&google.maps.event.removeListener(v),C&&google.maps.event.removeListener(C),E&&google.maps.event.removeListener(E),P&&google.maps.event.removeListener(P),u&&u(d),d.close())}},[]),N.current?nt.createPortal(o.Children.only(e),N.current):null}o.memo(xr);class yr extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"containerElement",null),M(this,"state",{infoBox:null}),M(this,"open",(e,n)=>{n?this.context!==null&&e.open(this.context,n):e.getPosition()?this.context!==null&&e.open(this.context):de(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),M(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var e=this.props.options||{},{position:n}=e,i=ln(e,hr),a;n&&!(n instanceof google.maps.LatLng)&&(a=new google.maps.LatLng(n.lat,n.lng));var s=new Aa(_t(_t({},i),a?{position:a}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=ee({updaterMap:Xn,eventMap:Yn,prevProps:{},nextProps:this.props,instance:s}),this.setState({infoBox:s},this.setInfoBoxCallback)}componentDidUpdate(e){var{infoBox:n}=this.state;n!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Xn,eventMap:Yn,prevProps:e,nextProps:this.props,instance:n}))}componentWillUnmount(){var{onUnmount:e}=this.props,{infoBox:n}=this.state;n!==null&&(e&&e(n),te(this.registeredEvents),n.close())}render(){return this.containerElement?nt.createPortal(o.Children.only(this.props.children),this.containerElement):null}}M(yr,"contextType",J);var $t,Jn;function br(){return Jn||(Jn=1,$t=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var i,a,s;if(Array.isArray(e)){if(i=e.length,i!=n.length)return!1;for(a=i;a--!==0;)if(!t(e[a],n[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),i=s.length,i!==Object.keys(n).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[a]))return!1;for(a=i;a--!==0;){var r=s[a];if(!t(e[r],n[r]))return!1}return!0}return e!==e&&n!==n}),$t}var wr=br(),Qn=Pa(wr),ei=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Wt=1,rt=8;class cn{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[n,i]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");var a=i>>4;if(a!==Wt)throw new Error("Got v".concat(a," data when expected v").concat(Wt,"."));var s=ei[i&15];if(!s)throw new Error("Unrecognized array type.");var[r]=new Uint16Array(e,2,1),[c]=new Uint32Array(e,4,1);return new cn(c,r,s,e)}constructor(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,a=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;var s=ei.indexOf(this.ArrayType),r=e*2*this.ArrayType.BYTES_PER_ELEMENT,c=e*this.IndexArrayType.BYTES_PER_ELEMENT,p=(8-c%8)%8;if(s<0)throw new Error("Unexpected typed array class: ".concat(i,"."));a&&a instanceof ArrayBuffer?(this.data=a,this.ids=new this.IndexArrayType(this.data,rt,e),this.coords=new this.ArrayType(this.data,rt+c+p,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(rt+r+c+p),this.ids=new this.IndexArrayType(this.data,rt,e),this.coords=new this.ArrayType(this.data,rt+c+p,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(Wt<<4)+s]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){var i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=n,i}finish(){var e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return nn(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,i,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:s,coords:r,nodeSize:c}=this,p=[0,s.length-1,0],m=[];p.length;){var g=p.pop()||0,x=p.pop()||0,u=p.pop()||0;if(x-u<=c){for(var f=u;f<=x;f++){var d=r[2*f],h=r[2*f+1];d>=e&&d<=i&&h>=n&&h<=a&&m.push(s[f])}continue}var b=u+x>>1,L=r[2*b],C=r[2*b+1];L>=e&&L<=i&&C>=n&&C<=a&&m.push(s[b]),(g===0?e<=L:n<=C)&&(p.push(u),p.push(b-1),p.push(1-g)),(g===0?i>=L:a>=C)&&(p.push(b+1),p.push(x),p.push(1-g))}return m}within(e,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:a,coords:s,nodeSize:r}=this,c=[0,a.length-1,0],p=[],m=i*i;c.length;){var g=c.pop()||0,x=c.pop()||0,u=c.pop()||0;if(x-u<=r){for(var f=u;f<=x;f++)ti(s[2*f],s[2*f+1],e,n)<=m&&p.push(a[f]);continue}var d=u+x>>1,h=s[2*d],b=s[2*d+1];ti(h,b,e,n)<=m&&p.push(a[d]),(g===0?e-i<=h:n-i<=b)&&(c.push(u),c.push(d-1),c.push(1-g)),(g===0?e+i>=h:n+i>=b)&&(c.push(d+1),c.push(x),c.push(1-g))}return p}}function nn(t,e,n,i,a,s){if(!(a-i<=n)){var r=i+a>>1;Ta(t,e,r,i,a,s),nn(t,e,n,i,r-1,1-s),nn(t,e,n,r+1,a,1-s)}}function Ta(t,e,n,i,a,s){for(;a>i;){if(a-i>600){var r=a-i+1,c=n-i+1,p=Math.log(r),m=.5*Math.exp(2*p/3),g=.5*Math.sqrt(p*m*(r-m)/r)*(c-r/2<0?-1:1),x=Math.max(i,Math.floor(n-c*m/r+g)),u=Math.min(a,Math.floor(n+(r-c)*m/r+g));Ta(t,e,n,x,u,s)}var f=e[2*n+s],d=i,h=a;for(lt(t,e,i,n),e[2*a+s]>f&&lt(t,e,i,a);d<h;){for(lt(t,e,d,h),d++,h--;e[2*d+s]<f;)d++;for(;e[2*h+s]>f;)h--}e[2*i+s]===f?lt(t,e,i,h):(h++,lt(t,e,h,a)),h<=n&&(i=h+1),n<=h&&(a=h-1)}}function lt(t,e,n,i){qt(t,n,i),qt(e,2*n,2*i),qt(e,2*n+1,2*i+1)}function qt(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function ti(t,e,n,i){var a=t-n,s=e-i;return a*a+s*s}var Lr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},ni=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),Fe=2,De=3,Vt=4,_e=5,Fa=6;class Er{constructor(e){this.options=Object.assign(Object.create(Lr),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){var{log:n,minZoom:i,maxZoom:a}=this.options;n&&console.time("total time");var s="prepare ".concat(e.length," points");n&&console.time(s),this.points=e;for(var r=[],c=0;c<e.length;c++){var p=e[c];if(p.geometry){var[m,g]=p.geometry.coordinates,x=ni(yt(m)),u=ni(bt(g));r.push(x,u,1/0,c,-1,1),this.options.reduce&&r.push(0)}}var f=this.trees[a+1]=this._createTree(r);n&&console.timeEnd(s);for(var d=a;d>=i;d--){var h=+Date.now();f=this.trees[d]=this._createTree(this._cluster(f,d)),n&&console.log("z%d: %d clusters in %dms",d,f.numItems,+Date.now()-h)}return n&&console.timeEnd("total time"),this}getClusters(e,n){var i=((e[0]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[1])),s=e[2]===180?180:((e[2]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)i=-180,s=180;else if(i>s){var c=this.getClusters([i,a,180,r],n),p=this.getClusters([-180,a,s,r],n);return c.concat(p)}var m=this.trees[this._limitZoom(n)],g=m.range(yt(i),bt(r),yt(s),bt(a)),x=m.data,u=[];for(var f of g){var d=this.stride*f;u.push(x[d+_e]>1?ii(x,d,this.clusterProps):this.points[x[d+De]])}return u}getChildren(e){var n=this._getOriginId(e),i=this._getOriginZoom(e),a="No cluster with the specified id.",s=this.trees[i];if(!s)throw new Error(a);var r=s.data;if(n*this.stride>=r.length)throw new Error(a);var c=this.options.radius/(this.options.extent*Math.pow(2,i-1)),p=r[n*this.stride],m=r[n*this.stride+1],g=s.within(p,m,c),x=[];for(var u of g){var f=u*this.stride;r[f+Vt]===e&&x.push(r[f+_e]>1?ii(r,f,this.clusterProps):this.points[r[f+De]])}if(x.length===0)throw new Error(a);return x}getLeaves(e,n,i){n=n||10,i=i||0;var a=[];return this._appendLeaves(a,e,n,i,0),a}getTile(e,n,i){var a=this.trees[this._limitZoom(e)],s=Math.pow(2,e),{extent:r,radius:c}=this.options,p=c/r,m=(i-p)/s,g=(i+1+p)/s,x={features:[]};return this._addTileFeatures(a.range((n-p)/s,m,(n+1+p)/s,g),a.data,n,i,s,x),n===0&&this._addTileFeatures(a.range(1-p/s,m,1,g),a.data,s,i,s,x),n===s-1&&this._addTileFeatures(a.range(0,m,p/s,g),a.data,-1,i,s,x),x.features.length?x:null}getClusterExpansionZoom(e){for(var n=this._getOriginZoom(e)-1;n<=this.options.maxZoom;){var i=this.getChildren(e);if(n++,i.length!==1)break;e=i[0].properties.cluster_id}return n}_appendLeaves(e,n,i,a,s){var r=this.getChildren(n);for(var c of r){var p=c.properties;if(p&&p.cluster?s+p.point_count<=a?s+=p.point_count:s=this._appendLeaves(e,p.cluster_id,i,a,s):s<a?s++:e.push(c),e.length===i)break}return s}_createTree(e){for(var n=new cn(e.length/this.stride|0,this.options.nodeSize,Float32Array),i=0;i<e.length;i+=this.stride)n.add(e[i],e[i+1]);return n.finish(),n.data=e,n}_addTileFeatures(e,n,i,a,s,r){for(var c of e){var p=c*this.stride,m=n[p+_e]>1,g=void 0,x=void 0,u=void 0;if(m)g=Ua(n,p,this.clusterProps),x=n[p],u=n[p+1];else{var f=this.points[n[p+De]];g=f.properties;var[d,h]=f.geometry.coordinates;x=yt(d),u=bt(h)}var b={type:1,geometry:[[Math.round(this.options.extent*(x*s-i)),Math.round(this.options.extent*(u*s-a))]],tags:g},L=void 0;m||this.options.generateId?L=n[p+De]:L=this.points[n[p+De]].id,L!==void 0&&(b.id=L),r.features.push(b)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,n){for(var{radius:i,extent:a,reduce:s,minPoints:r}=this.options,c=i/(a*Math.pow(2,n)),p=e.data,m=[],g=this.stride,x=0;x<p.length;x+=g)if(!(p[x+Fe]<=n)){p[x+Fe]=n;var u=p[x],f=p[x+1],d=e.within(p[x],p[x+1],c),h=p[x+_e],b=h;for(var L of d){var C=L*g;p[C+Fe]>n&&(b+=p[C+_e])}if(b>h&&b>=r){var k=u*h,v=f*h,y=void 0,E=-1,w=((x/g|0)<<5)+(n+1)+this.points.length;for(var P of d){var S=P*g;if(!(p[S+Fe]<=n)){p[S+Fe]=n;var N=p[S+_e];k+=p[S]*N,v+=p[S+1]*N,p[S+Vt]=w,s&&(y||(y=this._map(p,x,!0),E=this.clusterProps.length,this.clusterProps.push(y)),s(y,this._map(p,S)))}}p[x+Vt]=w,m.push(k/b,v/b,1/0,w,-1,b),s&&m.push(E)}else{for(var D=0;D<g;D++)m.push(p[x+D]);if(b>1)for(var _ of d){var A=_*g;if(!(p[A+Fe]<=n)){p[A+Fe]=n;for(var T=0;T<g;T++)m.push(p[A+T])}}}}return m}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,n,i){if(e[n+_e]>1){var a=this.clusterProps[e[n+Fa]];return i?Object.assign({},a):a}var s=this.points[e[n+De]].properties,r=this.options.map(s);return i&&r===s?Object.assign({},r):r}}function ii(t,e,n){return{type:"Feature",id:t[e+De],properties:Ua(t,e,n),geometry:{type:"Point",coordinates:[Cr(t[e]),jr(t[e+1])]}}}function Ua(t,e,n){var i=t[e+_e],a=i>=1e4?"".concat(Math.round(i/1e3),"k"):i>=1e3?"".concat(Math.round(i/100)/10,"k"):i,s=t[e+Fa],r=s===-1?{}:Object.assign({},n[s]);return Object.assign(r,{cluster:!0,cluster_id:t[e+De],point_count:i,point_count_abbreviated:a})}function yt(t){return t/360+.5}function bt(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function Cr(t){return(t-.5)*360}function jr(t){var e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function kr(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(t);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(t,i[a])&&(n[i[a]]=t[i[a]]);return n}class ve{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,n){this.isAdvancedMarker(e)?e.map=n:e.setMap(n)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class an{constructor(e){var{markers:n,position:i}=e;this.markers=n,i&&(i instanceof google.maps.LatLng?this._position=i:this._position=new google.maps.LatLng(i))}get bounds(){if(!(this.markers.length===0&&!this._position)){var e=new google.maps.LatLngBounds(this._position,this._position);for(var n of this.markers)e.extend(ve.getPosition(n));return e}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>ve.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(ve.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class Sr{constructor(e){var{maxZoom:n=16}=e;this.maxZoom=n}noop(e){var{markers:n}=e;return Mr(n)}}var Mr=t=>{var e=t.map(n=>new an({position:ve.getPosition(n),markers:[n]}));return e};class Pr extends Sr{constructor(e){var{maxZoom:n,radius:i=60}=e,a=kr(e,["maxZoom","radius"]);super({maxZoom:n}),this.state={zoom:-1},this.superCluster=new Er(Object.assign({maxZoom:this.maxZoom,radius:i},a))}calculate(e){var n=!1,i={zoom:e.map.getZoom()};if(!Qn(e.markers,this.markers)){n=!0,this.markers=[...e.markers];var a=this.markers.map(s=>{var r=ve.getPosition(s),c=[r.lng(),r.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:c},properties:{marker:s}}});this.superCluster.load(a)}return n||(this.state.zoom<=this.maxZoom||i.zoom<=this.maxZoom)&&(n=!Qn(this.state,i)),this.state=i,n&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:n}}cluster(e){var{map:n}=e;return this.superCluster.getClusters([-180,-90,180,90],Math.round(n.getZoom())).map(i=>this.transformCluster(i))}transformCluster(e){var{geometry:{coordinates:[n,i]},properties:a}=e;if(a.cluster)return new an({markers:this.superCluster.getLeaves(a.cluster_id,1/0).map(r=>r.properties.marker),position:{lat:i,lng:n}});var s=a.marker;return new an({markers:[s],position:ve.getPosition(s)})}}class Or{constructor(e,n){this.markers={sum:e.length};var i=n.map(s=>s.count),a=i.reduce((s,r)=>s+r,0);this.clusters={count:n.length,markers:{mean:a/n.length,sum:a,min:Math.min(...i),max:Math.max(...i)}}}}class _r{render(e,n,i){var{count:a,position:s}=e,r=a>Math.max(10,n.clusters.markers.mean)?"#ff0000":"#0000ff",c='<svg fill="'.concat(r,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(a,`</text>
</svg>`),p="Cluster of ".concat(a," markers"),m=Number(google.maps.Marker.MAX_ZINDEX)+a;if(ve.isAdvancedMarkerAvailable(i)){var g=new DOMParser,x=g.parseFromString(c,"image/svg+xml").documentElement;x.setAttribute("transform","translate(0 25)");var u={map:i,position:s,zIndex:m,title:p,content:x};return new google.maps.marker.AdvancedMarkerElement(u)}var f={position:s,zIndex:m,title:p,icon:{url:"data:image/svg+xml;base64,".concat(btoa(c)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(f)}}function Dr(t,e){for(var n in e.prototype)t.prototype[n]=e.prototype[n]}class pn{constructor(){Dr(pn,google.maps.OverlayView)}}var ct;(function(t){t.CLUSTERING_BEGIN="clusteringbegin",t.CLUSTERING_END="clusteringend",t.CLUSTER_CLICK="click"})(ct||(ct={}));var Ir=(t,e,n)=>{n.fitBounds(e.bounds)};class Nr extends pn{constructor(e){var{map:n,markers:i=[],algorithmOptions:a={},algorithm:s=new Pr(a),renderer:r=new _r,onClusterClick:c=Ir}=e;super(),this.markers=[...i],this.clusters=[],this.algorithm=s,this.renderer=r,this.onClusterClick=c,n&&this.setMap(n)}addMarker(e,n){this.markers.includes(e)||(this.markers.push(e),n||this.render())}addMarkers(e,n){e.forEach(i=>{this.addMarker(i,!0)}),n||this.render()}removeMarker(e,n){var i=this.markers.indexOf(e);return i===-1?!1:(ve.setMap(e,null),this.markers.splice(i,1),n||this.render(),!0)}removeMarkers(e,n){var i=!1;return e.forEach(a=>{i=this.removeMarker(a,!0)||i}),i&&!n&&this.render(),i}clearMarkers(e){this.markers.length=0,e||this.render()}render(){var e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,ct.CLUSTERING_BEGIN,this);var{clusters:n,changed:i}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(i||i==null){var a=new Set;for(var s of n)s.markers.length==1&&a.add(s.markers[0]);var r=[];for(var c of this.clusters)c.marker!=null&&(c.markers.length==1?a.has(c.marker)||ve.setMap(c.marker,null):r.push(c.marker));this.clusters=n,this.renderClusters(),requestAnimationFrame(()=>r.forEach(p=>ve.setMap(p,null)))}google.maps.event.trigger(this,ct.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>ve.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){var e=new Or(this.markers,this.clusters),n=this.getMap();this.clusters.forEach(i=>{i.markers.length===1?i.marker=i.markers[0]:(i.marker=this.renderer.render(i,e,n),i.markers.forEach(a=>ve.setMap(a,null)),this.onClusterClick&&i.marker.addListener("click",a=>{google.maps.event.trigger(this,ct.CLUSTER_CLICK,i),this.onClusterClick(a,i,n)})),ve.setMap(i.marker,n)})}}function ai(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function si(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ai(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ai(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Rr(t){var e=So(),[n,i]=o.useState(null);return o.useEffect(()=>{if(e&&n===null){var a=new Nr(si(si({},t),{},{map:e}));i(a)}},[e]),n}function Ar(t){var{children:e,options:n}=t,i=Rr(n);return i!==null?e(i):null}o.memo(Ar);var oi={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},ri={options(t,e){t.setOptions(e)},position(t,e){t.setPosition(e)},zIndex(t,e){t.setZIndex(e)}};function Tr(t){var{children:e,anchor:n,options:i,position:a,zIndex:s,onCloseClick:r,onDomReady:c,onContentChanged:p,onPositionChanged:m,onZindexChanged:g,onLoad:x,onUnmount:u}=t,f=o.useContext(J),[d,h]=o.useState(null),[b,L]=o.useState(null),[C,k]=o.useState(null),[v,y]=o.useState(null),[E,w]=o.useState(null),[P,S]=o.useState(null),N=o.useRef(null);return o.useEffect(()=>{d!==null&&(d.close(),n?d.open(f,n):d.getPosition()&&d.open(f))},[f,d,n]),o.useEffect(()=>{i&&d!==null&&d.setOptions(i)},[d,i]),o.useEffect(()=>{a&&d!==null&&d.setPosition(a)},[a]),o.useEffect(()=>{typeof s=="number"&&d!==null&&d.setZIndex(s)},[s]),o.useEffect(()=>{d&&r&&(b!==null&&google.maps.event.removeListener(b),L(google.maps.event.addListener(d,"closeclick",r)))},[r]),o.useEffect(()=>{d&&c&&(C!==null&&google.maps.event.removeListener(C),k(google.maps.event.addListener(d,"domready",c)))},[c]),o.useEffect(()=>{d&&p&&(v!==null&&google.maps.event.removeListener(v),y(google.maps.event.addListener(d,"content_changed",p)))},[p]),o.useEffect(()=>{d&&m&&(E!==null&&google.maps.event.removeListener(E),w(google.maps.event.addListener(d,"position_changed",m)))},[m]),o.useEffect(()=>{d&&g&&(P!==null&&google.maps.event.removeListener(P),S(google.maps.event.addListener(d,"zindex_changed",g)))},[g]),o.useEffect(()=>{var D=new google.maps.InfoWindow(i);return h(D),N.current=document.createElement("div"),r&&L(google.maps.event.addListener(D,"closeclick",r)),c&&k(google.maps.event.addListener(D,"domready",c)),p&&y(google.maps.event.addListener(D,"content_changed",p)),m&&w(google.maps.event.addListener(D,"position_changed",m)),g&&S(google.maps.event.addListener(D,"zindex_changed",g)),D.setContent(N.current),a&&D.setPosition(a),s&&D.setZIndex(s),n?D.open(f,n):D.getPosition()?D.open(f):de(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),x&&x(D),()=>{b&&google.maps.event.removeListener(b),v&&google.maps.event.removeListener(v),C&&google.maps.event.removeListener(C),E&&google.maps.event.removeListener(E),P&&google.maps.event.removeListener(P),u&&u(D),D.close()}},[]),N.current?nt.createPortal(o.Children.only(e),N.current):null}o.memo(Tr);class Fr extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"containerElement",null),M(this,"state",{infoWindow:null}),M(this,"open",(e,n)=>{n?e.open(this.context,n):e.getPosition()?e.open(this.context):de(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),M(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var e=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=ee({updaterMap:ri,eventMap:oi,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({infoWindow:e}),this.setInfoWindowCallback)}componentDidUpdate(e){this.state.infoWindow!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:ri,eventMap:oi,prevProps:e,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&(te(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?nt.createPortal(o.Children.only(this.props.children),this.containerElement):null}}M(Fr,"contextType",J);function li(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Dt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?li(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):li(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var ci={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},pi={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},visible(t,e){t.setVisible(e)}},Ur={};function zr(t){var{options:e,draggable:n,editable:i,visible:a,path:s,onDblClick:r,onDragEnd:c,onDragStart:p,onMouseDown:m,onMouseMove:g,onMouseOut:x,onMouseOver:u,onMouseUp:f,onRightClick:d,onClick:h,onDrag:b,onLoad:L,onUnmount:C}=t,k=o.useContext(J),[v,y]=o.useState(null),[E,w]=o.useState(null),[P,S]=o.useState(null),[N,D]=o.useState(null),[_,A]=o.useState(null),[T,I]=o.useState(null),[$,Y]=o.useState(null),[Z,G]=o.useState(null),[Q,ie]=o.useState(null),[ne,W]=o.useState(null),[O,j]=o.useState(null),[F,q]=o.useState(null);return o.useEffect(()=>{v!==null&&v.setMap(k)},[k]),o.useEffect(()=>{typeof e<"u"&&v!==null&&v.setOptions(e)},[v,e]),o.useEffect(()=>{typeof n<"u"&&v!==null&&v.setDraggable(n)},[v,n]),o.useEffect(()=>{typeof i<"u"&&v!==null&&v.setEditable(i)},[v,i]),o.useEffect(()=>{typeof a<"u"&&v!==null&&v.setVisible(a)},[v,a]),o.useEffect(()=>{typeof s<"u"&&v!==null&&v.setPath(s)},[v,s]),o.useEffect(()=>{v&&r&&(E!==null&&google.maps.event.removeListener(E),w(google.maps.event.addListener(v,"dblclick",r)))},[r]),o.useEffect(()=>{v&&c&&(P!==null&&google.maps.event.removeListener(P),S(google.maps.event.addListener(v,"dragend",c)))},[c]),o.useEffect(()=>{v&&p&&(N!==null&&google.maps.event.removeListener(N),D(google.maps.event.addListener(v,"dragstart",p)))},[p]),o.useEffect(()=>{v&&m&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(v,"mousedown",m)))},[m]),o.useEffect(()=>{v&&g&&(T!==null&&google.maps.event.removeListener(T),I(google.maps.event.addListener(v,"mousemove",g)))},[g]),o.useEffect(()=>{v&&x&&($!==null&&google.maps.event.removeListener($),Y(google.maps.event.addListener(v,"mouseout",x)))},[x]),o.useEffect(()=>{v&&u&&(Z!==null&&google.maps.event.removeListener(Z),G(google.maps.event.addListener(v,"mouseover",u)))},[u]),o.useEffect(()=>{v&&f&&(Q!==null&&google.maps.event.removeListener(Q),ie(google.maps.event.addListener(v,"mouseup",f)))},[f]),o.useEffect(()=>{v&&d&&(ne!==null&&google.maps.event.removeListener(ne),W(google.maps.event.addListener(v,"rightclick",d)))},[d]),o.useEffect(()=>{v&&h&&(O!==null&&google.maps.event.removeListener(O),j(google.maps.event.addListener(v,"click",h)))},[h]),o.useEffect(()=>{v&&b&&(F!==null&&google.maps.event.removeListener(F),q(google.maps.event.addListener(v,"drag",b)))},[b]),o.useEffect(()=>{var z=new google.maps.Polyline(Dt(Dt({},e||Ur),{},{map:k}));return s&&z.setPath(s),typeof a<"u"&&z.setVisible(a),typeof i<"u"&&z.setEditable(i),typeof n<"u"&&z.setDraggable(n),r&&w(google.maps.event.addListener(z,"dblclick",r)),c&&S(google.maps.event.addListener(z,"dragend",c)),p&&D(google.maps.event.addListener(z,"dragstart",p)),m&&A(google.maps.event.addListener(z,"mousedown",m)),g&&I(google.maps.event.addListener(z,"mousemove",g)),x&&Y(google.maps.event.addListener(z,"mouseout",x)),u&&G(google.maps.event.addListener(z,"mouseover",u)),f&&ie(google.maps.event.addListener(z,"mouseup",f)),d&&W(google.maps.event.addListener(z,"rightclick",d)),h&&j(google.maps.event.addListener(z,"click",h)),b&&q(google.maps.event.addListener(z,"drag",b)),y(z),L&&L(z),()=>{E!==null&&google.maps.event.removeListener(E),P!==null&&google.maps.event.removeListener(P),N!==null&&google.maps.event.removeListener(N),_!==null&&google.maps.event.removeListener(_),T!==null&&google.maps.event.removeListener(T),$!==null&&google.maps.event.removeListener($),Z!==null&&google.maps.event.removeListener(Z),Q!==null&&google.maps.event.removeListener(Q),ne!==null&&google.maps.event.removeListener(ne),O!==null&&google.maps.event.removeListener(O),C&&C(z),z.setMap(null)}},[]),null}o.memo(zr);class Br extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{polyline:null}),M(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var e=new google.maps.Polyline(Dt(Dt({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:pi,eventMap:ci,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{polyline:e}},this.setPolylineCallback)}componentDidUpdate(e){this.state.polyline!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:pi,eventMap:ci,prevProps:e,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),te(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}M(Br,"contextType",J);function di(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function ui(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?di(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):di(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var mi={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},fi={draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},path(t,e){t.setPath(e)},paths(t,e){t.setPaths(e)},visible(t,e){t.setVisible(e)}};function $r(t){var{options:e,draggable:n,editable:i,visible:a,path:s,paths:r,onDblClick:c,onDragEnd:p,onDragStart:m,onMouseDown:g,onMouseMove:x,onMouseOut:u,onMouseOver:f,onMouseUp:d,onRightClick:h,onClick:b,onDrag:L,onLoad:C,onUnmount:k,onEdit:v}=t,y=o.useContext(J),[E,w]=o.useState(null),[P,S]=o.useState(null),[N,D]=o.useState(null),[_,A]=o.useState(null),[T,I]=o.useState(null),[$,Y]=o.useState(null),[Z,G]=o.useState(null),[Q,ie]=o.useState(null),[ne,W]=o.useState(null),[O,j]=o.useState(null),[F,q]=o.useState(null),[z,K]=o.useState(null);return o.useEffect(()=>{E!==null&&E.setMap(y)},[y]),o.useEffect(()=>{typeof e<"u"&&E!==null&&E.setOptions(e)},[E,e]),o.useEffect(()=>{typeof n<"u"&&E!==null&&E.setDraggable(n)},[E,n]),o.useEffect(()=>{typeof i<"u"&&E!==null&&E.setEditable(i)},[E,i]),o.useEffect(()=>{typeof a<"u"&&E!==null&&E.setVisible(a)},[E,a]),o.useEffect(()=>{typeof s<"u"&&E!==null&&E.setPath(s)},[E,s]),o.useEffect(()=>{typeof r<"u"&&E!==null&&E.setPaths(r)},[E,r]),o.useEffect(()=>{E&&typeof c=="function"&&(P!==null&&google.maps.event.removeListener(P),S(google.maps.event.addListener(E,"dblclick",c)))},[c]),o.useEffect(()=>{E&&(google.maps.event.addListener(E.getPath(),"insert_at",()=>{v?.(E)}),google.maps.event.addListener(E.getPath(),"set_at",()=>{v?.(E)}),google.maps.event.addListener(E.getPath(),"remove_at",()=>{v?.(E)}))},[E,v]),o.useEffect(()=>{E&&typeof p=="function"&&(N!==null&&google.maps.event.removeListener(N),D(google.maps.event.addListener(E,"dragend",p)))},[p]),o.useEffect(()=>{E&&typeof m=="function"&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(E,"dragstart",m)))},[m]),o.useEffect(()=>{E&&typeof g=="function"&&(T!==null&&google.maps.event.removeListener(T),I(google.maps.event.addListener(E,"mousedown",g)))},[g]),o.useEffect(()=>{E&&typeof x=="function"&&($!==null&&google.maps.event.removeListener($),Y(google.maps.event.addListener(E,"mousemove",x)))},[x]),o.useEffect(()=>{E&&typeof u=="function"&&(Z!==null&&google.maps.event.removeListener(Z),G(google.maps.event.addListener(E,"mouseout",u)))},[u]),o.useEffect(()=>{E&&typeof f=="function"&&(Q!==null&&google.maps.event.removeListener(Q),ie(google.maps.event.addListener(E,"mouseover",f)))},[f]),o.useEffect(()=>{E&&typeof d=="function"&&(ne!==null&&google.maps.event.removeListener(ne),W(google.maps.event.addListener(E,"mouseup",d)))},[d]),o.useEffect(()=>{E&&typeof h=="function"&&(O!==null&&google.maps.event.removeListener(O),j(google.maps.event.addListener(E,"rightclick",h)))},[h]),o.useEffect(()=>{E&&typeof b=="function"&&(F!==null&&google.maps.event.removeListener(F),q(google.maps.event.addListener(E,"click",b)))},[b]),o.useEffect(()=>{E&&typeof L=="function"&&(z!==null&&google.maps.event.removeListener(z),K(google.maps.event.addListener(E,"drag",L)))},[L]),o.useEffect(()=>{var U=new google.maps.Polygon(ui(ui({},e),{},{map:y}));return s&&U.setPath(s),r&&U.setPaths(r),typeof a<"u"&&U.setVisible(a),typeof i<"u"&&U.setEditable(i),typeof n<"u"&&U.setDraggable(n),c&&S(google.maps.event.addListener(U,"dblclick",c)),p&&D(google.maps.event.addListener(U,"dragend",p)),m&&A(google.maps.event.addListener(U,"dragstart",m)),g&&I(google.maps.event.addListener(U,"mousedown",g)),x&&Y(google.maps.event.addListener(U,"mousemove",x)),u&&G(google.maps.event.addListener(U,"mouseout",u)),f&&ie(google.maps.event.addListener(U,"mouseover",f)),d&&W(google.maps.event.addListener(U,"mouseup",d)),h&&j(google.maps.event.addListener(U,"rightclick",h)),b&&q(google.maps.event.addListener(U,"click",b)),L&&K(google.maps.event.addListener(U,"drag",L)),w(U),C&&C(U),()=>{P!==null&&google.maps.event.removeListener(P),N!==null&&google.maps.event.removeListener(N),_!==null&&google.maps.event.removeListener(_),T!==null&&google.maps.event.removeListener(T),$!==null&&google.maps.event.removeListener($),Z!==null&&google.maps.event.removeListener(Z),Q!==null&&google.maps.event.removeListener(Q),ne!==null&&google.maps.event.removeListener(ne),O!==null&&google.maps.event.removeListener(O),F!==null&&google.maps.event.removeListener(F),k&&k(U),U.setMap(null)}},[]),null}o.memo($r);class Wr extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[])}componentDidMount(){var e=this.props.options||{};this.polygon=new google.maps.Polygon(e),this.polygon.setMap(this.context),this.registeredEvents=ee({updaterMap:fi,eventMap:mi,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(e){this.polygon&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:fi,eventMap:mi,prevProps:e,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),te(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}M(Wr,"contextType",J);function gi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function It(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?gi(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gi(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var hi={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},vi={bounds(t,e){t.setBounds(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},visible(t,e){t.setVisible(e)}};function qr(t){var{options:e,bounds:n,draggable:i,editable:a,visible:s,onDblClick:r,onDragEnd:c,onDragStart:p,onMouseDown:m,onMouseMove:g,onMouseOut:x,onMouseOver:u,onMouseUp:f,onRightClick:d,onClick:h,onDrag:b,onBoundsChanged:L,onLoad:C,onUnmount:k}=t,v=o.useContext(J),[y,E]=o.useState(null),[w,P]=o.useState(null),[S,N]=o.useState(null),[D,_]=o.useState(null),[A,T]=o.useState(null),[I,$]=o.useState(null),[Y,Z]=o.useState(null),[G,Q]=o.useState(null),[ie,ne]=o.useState(null),[W,O]=o.useState(null),[j,F]=o.useState(null),[q,z]=o.useState(null),[K,U]=o.useState(null);return o.useEffect(()=>{y!==null&&y.setMap(v)},[v]),o.useEffect(()=>{typeof e<"u"&&y!==null&&y.setOptions(e)},[y,e]),o.useEffect(()=>{typeof i<"u"&&y!==null&&y.setDraggable(i)},[y,i]),o.useEffect(()=>{typeof a<"u"&&y!==null&&y.setEditable(a)},[y,a]),o.useEffect(()=>{typeof s<"u"&&y!==null&&y.setVisible(s)},[y,s]),o.useEffect(()=>{typeof n<"u"&&y!==null&&y.setBounds(n)},[y,n]),o.useEffect(()=>{y&&r&&(w!==null&&google.maps.event.removeListener(w),P(google.maps.event.addListener(y,"dblclick",r)))},[r]),o.useEffect(()=>{y&&c&&(S!==null&&google.maps.event.removeListener(S),N(google.maps.event.addListener(y,"dragend",c)))},[c]),o.useEffect(()=>{y&&p&&(D!==null&&google.maps.event.removeListener(D),_(google.maps.event.addListener(y,"dragstart",p)))},[p]),o.useEffect(()=>{y&&m&&(A!==null&&google.maps.event.removeListener(A),T(google.maps.event.addListener(y,"mousedown",m)))},[m]),o.useEffect(()=>{y&&g&&(I!==null&&google.maps.event.removeListener(I),$(google.maps.event.addListener(y,"mousemove",g)))},[g]),o.useEffect(()=>{y&&x&&(Y!==null&&google.maps.event.removeListener(Y),Z(google.maps.event.addListener(y,"mouseout",x)))},[x]),o.useEffect(()=>{y&&u&&(G!==null&&google.maps.event.removeListener(G),Q(google.maps.event.addListener(y,"mouseover",u)))},[u]),o.useEffect(()=>{y&&f&&(ie!==null&&google.maps.event.removeListener(ie),ne(google.maps.event.addListener(y,"mouseup",f)))},[f]),o.useEffect(()=>{y&&d&&(W!==null&&google.maps.event.removeListener(W),O(google.maps.event.addListener(y,"rightclick",d)))},[d]),o.useEffect(()=>{y&&h&&(j!==null&&google.maps.event.removeListener(j),F(google.maps.event.addListener(y,"click",h)))},[h]),o.useEffect(()=>{y&&b&&(q!==null&&google.maps.event.removeListener(q),z(google.maps.event.addListener(y,"drag",b)))},[b]),o.useEffect(()=>{y&&L&&(K!==null&&google.maps.event.removeListener(K),U(google.maps.event.addListener(y,"bounds_changed",L)))},[L]),o.useEffect(()=>{var B=new google.maps.Rectangle(It(It({},e),{},{map:v}));return typeof s<"u"&&B.setVisible(s),typeof a<"u"&&B.setEditable(a),typeof i<"u"&&B.setDraggable(i),typeof n<"u"&&B.setBounds(n),r&&P(google.maps.event.addListener(B,"dblclick",r)),c&&N(google.maps.event.addListener(B,"dragend",c)),p&&_(google.maps.event.addListener(B,"dragstart",p)),m&&T(google.maps.event.addListener(B,"mousedown",m)),g&&$(google.maps.event.addListener(B,"mousemove",g)),x&&Z(google.maps.event.addListener(B,"mouseout",x)),u&&Q(google.maps.event.addListener(B,"mouseover",u)),f&&ne(google.maps.event.addListener(B,"mouseup",f)),d&&O(google.maps.event.addListener(B,"rightclick",d)),h&&F(google.maps.event.addListener(B,"click",h)),b&&z(google.maps.event.addListener(B,"drag",b)),L&&U(google.maps.event.addListener(B,"bounds_changed",L)),E(B),C&&C(B),()=>{w!==null&&google.maps.event.removeListener(w),S!==null&&google.maps.event.removeListener(S),D!==null&&google.maps.event.removeListener(D),A!==null&&google.maps.event.removeListener(A),I!==null&&google.maps.event.removeListener(I),Y!==null&&google.maps.event.removeListener(Y),G!==null&&google.maps.event.removeListener(G),ie!==null&&google.maps.event.removeListener(ie),W!==null&&google.maps.event.removeListener(W),j!==null&&google.maps.event.removeListener(j),q!==null&&google.maps.event.removeListener(q),K!==null&&google.maps.event.removeListener(K),k&&k(B),B.setMap(null)}},[]),null}o.memo(qr);class Vr extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{rectangle:null}),M(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var e=new google.maps.Rectangle(It(It({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:vi,eventMap:hi,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{rectangle:e}},this.setRectangleCallback)}componentDidUpdate(e){this.state.rectangle!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:vi,eventMap:hi,prevProps:e,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),te(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}}M(Vr,"contextType",J);function xi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Nt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xi(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xi(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var yi={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},bi={center(t,e){t.setCenter(e)},draggable(t,e){t.setDraggable(e)},editable(t,e){t.setEditable(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},radius(t,e){t.setRadius(e)},visible(t,e){t.setVisible(e)}},Hr={};function Zr(t){var{options:e,center:n,radius:i,draggable:a,editable:s,visible:r,onDblClick:c,onDragEnd:p,onDragStart:m,onMouseDown:g,onMouseMove:x,onMouseOut:u,onMouseOver:f,onMouseUp:d,onRightClick:h,onClick:b,onDrag:L,onCenterChanged:C,onRadiusChanged:k,onLoad:v,onUnmount:y}=t,E=o.useContext(J),[w,P]=o.useState(null),[S,N]=o.useState(null),[D,_]=o.useState(null),[A,T]=o.useState(null),[I,$]=o.useState(null),[Y,Z]=o.useState(null),[G,Q]=o.useState(null),[ie,ne]=o.useState(null),[W,O]=o.useState(null),[j,F]=o.useState(null),[q,z]=o.useState(null),[K,U]=o.useState(null),[B,se]=o.useState(null),[xe,ke]=o.useState(null);return o.useEffect(()=>{w!==null&&w.setMap(E)},[E]),o.useEffect(()=>{typeof e<"u"&&w!==null&&w.setOptions(e)},[w,e]),o.useEffect(()=>{typeof a<"u"&&w!==null&&w.setDraggable(a)},[w,a]),o.useEffect(()=>{typeof s<"u"&&w!==null&&w.setEditable(s)},[w,s]),o.useEffect(()=>{typeof r<"u"&&w!==null&&w.setVisible(r)},[w,r]),o.useEffect(()=>{typeof i=="number"&&w!==null&&w.setRadius(i)},[w,i]),o.useEffect(()=>{typeof n<"u"&&w!==null&&w.setCenter(n)},[w,n]),o.useEffect(()=>{w&&c&&(S!==null&&google.maps.event.removeListener(S),N(google.maps.event.addListener(w,"dblclick",c)))},[c]),o.useEffect(()=>{w&&p&&(D!==null&&google.maps.event.removeListener(D),_(google.maps.event.addListener(w,"dragend",p)))},[p]),o.useEffect(()=>{w&&m&&(A!==null&&google.maps.event.removeListener(A),T(google.maps.event.addListener(w,"dragstart",m)))},[m]),o.useEffect(()=>{w&&g&&(I!==null&&google.maps.event.removeListener(I),$(google.maps.event.addListener(w,"mousedown",g)))},[g]),o.useEffect(()=>{w&&x&&(Y!==null&&google.maps.event.removeListener(Y),Z(google.maps.event.addListener(w,"mousemove",x)))},[x]),o.useEffect(()=>{w&&u&&(G!==null&&google.maps.event.removeListener(G),Q(google.maps.event.addListener(w,"mouseout",u)))},[u]),o.useEffect(()=>{w&&f&&(ie!==null&&google.maps.event.removeListener(ie),ne(google.maps.event.addListener(w,"mouseover",f)))},[f]),o.useEffect(()=>{w&&d&&(W!==null&&google.maps.event.removeListener(W),O(google.maps.event.addListener(w,"mouseup",d)))},[d]),o.useEffect(()=>{w&&h&&(j!==null&&google.maps.event.removeListener(j),F(google.maps.event.addListener(w,"rightclick",h)))},[h]),o.useEffect(()=>{w&&b&&(q!==null&&google.maps.event.removeListener(q),z(google.maps.event.addListener(w,"click",b)))},[b]),o.useEffect(()=>{w&&L&&(K!==null&&google.maps.event.removeListener(K),U(google.maps.event.addListener(w,"drag",L)))},[L]),o.useEffect(()=>{w&&C&&(B!==null&&google.maps.event.removeListener(B),se(google.maps.event.addListener(w,"center_changed",C)))},[b]),o.useEffect(()=>{w&&k&&(xe!==null&&google.maps.event.removeListener(xe),ke(google.maps.event.addListener(w,"radius_changed",k)))},[k]),o.useEffect(()=>{var oe=new google.maps.Circle(Nt(Nt({},e||Hr),{},{map:E}));return typeof i=="number"&&oe.setRadius(i),typeof n<"u"&&oe.setCenter(n),typeof i=="number"&&oe.setRadius(i),typeof r<"u"&&oe.setVisible(r),typeof s<"u"&&oe.setEditable(s),typeof a<"u"&&oe.setDraggable(a),c&&N(google.maps.event.addListener(oe,"dblclick",c)),p&&_(google.maps.event.addListener(oe,"dragend",p)),m&&T(google.maps.event.addListener(oe,"dragstart",m)),g&&$(google.maps.event.addListener(oe,"mousedown",g)),x&&Z(google.maps.event.addListener(oe,"mousemove",x)),u&&Q(google.maps.event.addListener(oe,"mouseout",u)),f&&ne(google.maps.event.addListener(oe,"mouseover",f)),d&&O(google.maps.event.addListener(oe,"mouseup",d)),h&&F(google.maps.event.addListener(oe,"rightclick",h)),b&&z(google.maps.event.addListener(oe,"click",b)),L&&U(google.maps.event.addListener(oe,"drag",L)),C&&se(google.maps.event.addListener(oe,"center_changed",C)),k&&ke(google.maps.event.addListener(oe,"radius_changed",k)),P(oe),v&&v(oe),()=>{S!==null&&google.maps.event.removeListener(S),D!==null&&google.maps.event.removeListener(D),A!==null&&google.maps.event.removeListener(A),I!==null&&google.maps.event.removeListener(I),Y!==null&&google.maps.event.removeListener(Y),G!==null&&google.maps.event.removeListener(G),ie!==null&&google.maps.event.removeListener(ie),W!==null&&google.maps.event.removeListener(W),j!==null&&google.maps.event.removeListener(j),q!==null&&google.maps.event.removeListener(q),B!==null&&google.maps.event.removeListener(B),xe!==null&&google.maps.event.removeListener(xe),y&&y(oe),oe.setMap(null)}},[]),null}o.memo(Zr);class Gr extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{circle:null}),M(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var e=new google.maps.Circle(Nt(Nt({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:bi,eventMap:yi,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{circle:e}},this.setCircleCallback)}componentDidUpdate(e){this.state.circle!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:bi,eventMap:yi,prevProps:e,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var e;this.props.onUnmount&&this.props.onUnmount(this.state.circle),te(this.registeredEvents),(e=this.state.circle)===null||e===void 0||e.setMap(null)}}render(){return null}}M(Gr,"contextType",J);function wi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Rt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?wi(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wi(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var Li={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},Ei={add(t,e){t.add(e)},addgeojson(t,e,n){t.addGeoJson(e,n)},contains(t,e){t.contains(e)},foreach(t,e){t.forEach(e)},loadgeojson(t,e,n,i){t.loadGeoJson(e,n,i)},overridestyle(t,e,n){t.overrideStyle(e,n)},remove(t,e){t.remove(e)},revertstyle(t,e){t.revertStyle(e)},controlposition(t,e){t.setControlPosition(e)},controls(t,e){t.setControls(e)},drawingmode(t,e){t.setDrawingMode(e)},map(t,e){t.setMap(e)},style(t,e){t.setStyle(e)},togeojson(t,e){t.toGeoJson(e)}};function Kr(t){var{options:e,onClick:n,onDblClick:i,onMouseDown:a,onMouseMove:s,onMouseOut:r,onMouseOver:c,onMouseUp:p,onRightClick:m,onAddFeature:g,onRemoveFeature:x,onRemoveProperty:u,onSetGeometry:f,onSetProperty:d,onLoad:h,onUnmount:b}=t,L=o.useContext(J),[C,k]=o.useState(null),[v,y]=o.useState(null),[E,w]=o.useState(null),[P,S]=o.useState(null),[N,D]=o.useState(null),[_,A]=o.useState(null),[T,I]=o.useState(null),[$,Y]=o.useState(null),[Z,G]=o.useState(null),[Q,ie]=o.useState(null),[ne,W]=o.useState(null),[O,j]=o.useState(null),[F,q]=o.useState(null),[z,K]=o.useState(null);return o.useEffect(()=>{C!==null&&C.setMap(L)},[L]),o.useEffect(()=>{C&&i&&(v!==null&&google.maps.event.removeListener(v),y(google.maps.event.addListener(C,"dblclick",i)))},[i]),o.useEffect(()=>{C&&a&&(E!==null&&google.maps.event.removeListener(E),w(google.maps.event.addListener(C,"mousedown",a)))},[a]),o.useEffect(()=>{C&&s&&(P!==null&&google.maps.event.removeListener(P),S(google.maps.event.addListener(C,"mousemove",s)))},[s]),o.useEffect(()=>{C&&r&&(N!==null&&google.maps.event.removeListener(N),D(google.maps.event.addListener(C,"mouseout",r)))},[r]),o.useEffect(()=>{C&&c&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(C,"mouseover",c)))},[c]),o.useEffect(()=>{C&&p&&(T!==null&&google.maps.event.removeListener(T),I(google.maps.event.addListener(C,"mouseup",p)))},[p]),o.useEffect(()=>{C&&m&&($!==null&&google.maps.event.removeListener($),Y(google.maps.event.addListener(C,"rightclick",m)))},[m]),o.useEffect(()=>{C&&n&&(Z!==null&&google.maps.event.removeListener(Z),G(google.maps.event.addListener(C,"click",n)))},[n]),o.useEffect(()=>{C&&g&&(Q!==null&&google.maps.event.removeListener(Q),ie(google.maps.event.addListener(C,"addfeature",g)))},[g]),o.useEffect(()=>{C&&x&&(ne!==null&&google.maps.event.removeListener(ne),W(google.maps.event.addListener(C,"removefeature",x)))},[x]),o.useEffect(()=>{C&&u&&(O!==null&&google.maps.event.removeListener(O),j(google.maps.event.addListener(C,"removeproperty",u)))},[u]),o.useEffect(()=>{C&&f&&(F!==null&&google.maps.event.removeListener(F),q(google.maps.event.addListener(C,"setgeometry",f)))},[f]),o.useEffect(()=>{C&&d&&(z!==null&&google.maps.event.removeListener(z),K(google.maps.event.addListener(C,"setproperty",d)))},[d]),o.useEffect(()=>{if(L!==null){var U=new google.maps.Data(Rt(Rt({},e),{},{map:L}));i&&y(google.maps.event.addListener(U,"dblclick",i)),a&&w(google.maps.event.addListener(U,"mousedown",a)),s&&S(google.maps.event.addListener(U,"mousemove",s)),r&&D(google.maps.event.addListener(U,"mouseout",r)),c&&A(google.maps.event.addListener(U,"mouseover",c)),p&&I(google.maps.event.addListener(U,"mouseup",p)),m&&Y(google.maps.event.addListener(U,"rightclick",m)),n&&G(google.maps.event.addListener(U,"click",n)),g&&ie(google.maps.event.addListener(U,"addfeature",g)),x&&W(google.maps.event.addListener(U,"removefeature",x)),u&&j(google.maps.event.addListener(U,"removeproperty",u)),f&&q(google.maps.event.addListener(U,"setgeometry",f)),d&&K(google.maps.event.addListener(U,"setproperty",d)),k(U),h&&h(U)}return()=>{C&&(v!==null&&google.maps.event.removeListener(v),E!==null&&google.maps.event.removeListener(E),P!==null&&google.maps.event.removeListener(P),N!==null&&google.maps.event.removeListener(N),_!==null&&google.maps.event.removeListener(_),T!==null&&google.maps.event.removeListener(T),$!==null&&google.maps.event.removeListener($),Z!==null&&google.maps.event.removeListener(Z),Q!==null&&google.maps.event.removeListener(Q),ne!==null&&google.maps.event.removeListener(ne),O!==null&&google.maps.event.removeListener(O),F!==null&&google.maps.event.removeListener(F),z!==null&&google.maps.event.removeListener(z),b&&b(C),C.setMap(null))}},[]),null}o.memo(Kr);class Yr extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{data:null}),M(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var e=new google.maps.Data(Rt(Rt({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:Ei,eventMap:Li,prevProps:{},nextProps:this.props,instance:e}),this.setState(()=>({data:e}),this.setDataCallback)}}componentDidUpdate(e){this.state.data!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Ei,eventMap:Li,prevProps:e,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),te(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}M(Yr,"contextType",J);function Ci(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function ji(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ci(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ci(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var ki={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},Si={options(t,e){t.setOptions(e)},url(t,e){t.setUrl(e)},zIndex(t,e){t.setZIndex(e)}};class Xr extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{kmlLayer:null}),M(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var e=new google.maps.KmlLayer(ji(ji({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:Si,eventMap:ki,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{kmlLayer:e}},this.setKmlLayerCallback)}componentDidUpdate(e){this.state.kmlLayer!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Si,eventMap:ki,prevProps:e,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),te(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}M(Xr,"contextType",J);function za(t,e){return typeof e=="function"?e(t.offsetWidth,t.offsetHeight):{x:0,y:0}}function Jr(t,e){return new e(t.lat,t.lng)}function Qr(t,e){return new e(new google.maps.LatLng(t.ne.lat,t.ne.lng),new google.maps.LatLng(t.sw.lat,t.sw.lng))}function el(t,e,n){return t instanceof e?t:n(t,e)}function tl(t,e,n){return t instanceof e?t:n(t,e)}function nl(t,e,n){var i=t&&t.fromLatLngToDivPixel(n.getNorthEast()),a=t&&t.fromLatLngToDivPixel(n.getSouthWest());return i&&a?{left:"".concat(a.x+e.x,"px"),top:"".concat(i.y+e.y,"px"),width:"".concat(i.x-a.x-e.x,"px"),height:"".concat(a.y-i.y-e.y,"px")}:{left:"-9999px",top:"-9999px"}}function il(t,e,n){var i=t&&t.fromLatLngToDivPixel(n);if(i){var{x:a,y:s}=i;return{left:"".concat(a+e.x,"px"),top:"".concat(s+e.y,"px")}}return{left:"-9999px",top:"-9999px"}}function Ba(t,e,n,i){return n!==void 0?nl(t,e,tl(n,google.maps.LatLngBounds,Qr)):il(t,e,el(i,google.maps.LatLng,Jr))}function al(t,e){return t.left===e.left&&t.top===e.top&&t.width===e.height&&t.height===e.height}function Mi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function sl(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Mi(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mi(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function ol(t,e,n,i,a){class s extends google.maps.OverlayView{constructor(c,p,m,g){super(),this.container=c,this.pane=p,this.position=m,this.bounds=g}onAdd(){var c,p=(c=this.getPanes())===null||c===void 0?void 0:c[this.pane];p?.appendChild(this.container)}draw(){var c=this.getProjection(),p=sl({},this.container?za(this.container,a):{x:0,y:0}),m=Ba(c,p,this.bounds,this.position);for(var[g,x]of Object.entries(m))this.container.style[g]=x}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new s(t,e,n,i)}function Pi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function rl(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Pi(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pi(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Oi(t){if(!t)return"";var e=t instanceof google.maps.LatLng?t:new google.maps.LatLng(t.lat,t.lng);return e+""}function _i(t){if(!t)return"";var e=t instanceof google.maps.LatLngBounds?t:new google.maps.LatLngBounds(new google.maps.LatLng(t.south,t.east),new google.maps.LatLng(t.north,t.west));return e+""}function ll(t){var{position:e,bounds:n,mapPaneName:i,zIndex:a,onLoad:s,onUnmount:r,getPixelPositionOffset:c,children:p}=t,m=o.useContext(J),g=o.useMemo(()=>{var u=document.createElement("div");return u.style.position="absolute",u},[]),x=o.useMemo(()=>ol(g,i,e,n,c),[g,i,e,n]);return o.useEffect(()=>(s?.(x),x?.setMap(m),()=>{r?.(x),x?.setMap(null)}),[m,x]),o.useEffect(()=>{g.style.zIndex="".concat(a)},[a,g]),nt.createPortal(p,g)}o.memo(ll);class it extends o.PureComponent{constructor(e){super(e),M(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),M(this,"updatePane",()=>{var i=this.props.mapPaneName,a=this.overlayView.getPanes();de(!!i,"OverlayView requires props.mapPaneName but got %s",i),a?this.setState({paneEl:a[i]}):this.setState({paneEl:null})}),M(this,"onAdd",()=>{var i,a;this.updatePane(),(i=(a=this.props).onLoad)===null||i===void 0||i.call(a,this.overlayView)}),M(this,"onPositionElement",()=>{var i=this.overlayView.getProjection(),a=rl({x:0,y:0},this.containerRef.current?za(this.containerRef.current,this.props.getPixelPositionOffset):{}),s=Ba(i,a,this.props.bounds,this.props.position);if(!al(s,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var r,c,p,m;this.setState({containerStyle:{top:(r=s.top)!==null&&r!==void 0?r:0,left:(c=s.left)!==null&&c!==void 0?c:0,width:(p=s.width)!==null&&p!==void 0?p:0,height:(m=s.height)!==null&&m!==void 0?m:0,position:"absolute"}})}}),M(this,"draw",()=>{this.onPositionElement()}),M(this,"onRemove",()=>{var i,a;this.setState(()=>({paneEl:null})),(i=(a=this.props).onUnmount)===null||i===void 0||i.call(a,this.overlayView)}),this.containerRef=o.createRef();var n=new google.maps.OverlayView;n.onAdd=this.onAdd,n.draw=this.draw,n.onRemove=this.onRemove,this.overlayView=n}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(e){var n=Oi(e.position),i=Oi(this.props.position),a=_i(e.bounds),s=_i(this.props.bounds);(n!==i||a!==s)&&this.overlayView.draw(),e.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var e=this.state.paneEl;return e?nt.createPortal(l.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:o.Children.only(this.props.children)}),e):null}}M(it,"FLOAT_PANE","floatPane");M(it,"MAP_PANE","mapPane");M(it,"MARKER_LAYER","markerLayer");M(it,"OVERLAY_LAYER","overlayLayer");M(it,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");M(it,"contextType",J);function cl(){}function Di(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function Ii(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Di(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Di(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var Ni={onDblClick:"dblclick",onClick:"click"},Ri={opacity(t,e){t.setOpacity(e)}};function pl(t){var{url:e,bounds:n,options:i,visible:a}=t,s=o.useContext(J),r=new google.maps.LatLngBounds(new google.maps.LatLng(n.south,n.west),new google.maps.LatLng(n.north,n.east)),c=o.useMemo(()=>new google.maps.GroundOverlay(e,r,i),[]);return o.useEffect(()=>{c!==null&&c.setMap(s)},[s]),o.useEffect(()=>{typeof e<"u"&&c!==null&&(c.set("url",e),c.setMap(s))},[c,e]),o.useEffect(()=>{typeof a<"u"&&c!==null&&c.setOpacity(a?1:0)},[c,a]),o.useEffect(()=>{var p=new google.maps.LatLngBounds(new google.maps.LatLng(n.south,n.west),new google.maps.LatLng(n.north,n.east));typeof n<"u"&&c!==null&&(c.set("bounds",p),c.setMap(s))},[c,n]),null}o.memo(pl);class $a extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{groundOverlay:null}),M(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){de(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var e=new google.maps.GroundOverlay(this.props.url,this.props.bounds,Ii(Ii({},this.props.options),{},{map:this.context}));this.registeredEvents=ee({updaterMap:Ri,eventMap:Ni,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{groundOverlay:e}},this.setGroundOverlayCallback)}componentDidUpdate(e){this.state.groundOverlay!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Ri,eventMap:Ni,prevProps:e,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}M($a,"defaultProps",{onLoad:cl});M($a,"contextType",J);function Ai(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,i)}return n}function At(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ai(Object(n),!0).forEach(function(i){M(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ai(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var Ti={},Fi={data(t,e){t.setData(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)}};function dl(t){var{data:e,onLoad:n,onUnmount:i,options:a}=t,s=o.useContext(J),[r,c]=o.useState(null);return o.useEffect(()=>{google.maps.visualization||de(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),o.useEffect(()=>{de(!!e,"data property is required in HeatmapLayer %s",e)},[e]),o.useEffect(()=>{r!==null&&r.setMap(s)},[s]),o.useEffect(()=>{a&&r!==null&&r.setOptions(a)},[r,a]),o.useEffect(()=>{var p=new google.maps.visualization.HeatmapLayer(At(At({},a),{},{data:e,map:s}));return c(p),n&&n(p),()=>{r!==null&&(i&&i(r),r.setMap(null))}},[]),null}o.memo(dl);class ul extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{heatmapLayer:null}),M(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){de(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),de(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var e=new google.maps.visualization.HeatmapLayer(At(At({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=ee({updaterMap:Fi,eventMap:Ti,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{heatmapLayer:e}},this.setHeatmapLayerCallback)}componentDidUpdate(e){te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Fi,eventMap:Ti,prevProps:e,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),te(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}M(ul,"contextType",J);var Ui={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},zi={register(t,e,n){t.registerPanoProvider(e,n)},links(t,e){t.setLinks(e)},motionTracking(t,e){t.setMotionTracking(e)},options(t,e){t.setOptions(e)},pano(t,e){t.setPano(e)},position(t,e){t.setPosition(e)},pov(t,e){t.setPov(e)},visible(t,e){t.setVisible(e)},zoom(t,e){t.setZoom(e)}};class ml extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{streetViewPanorama:null}),M(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var e,n,i=(e=(n=this.context)===null||n===void 0?void 0:n.getStreetView())!==null&&e!==void 0?e:null;this.registeredEvents=ee({updaterMap:zi,eventMap:Ui,prevProps:{},nextProps:this.props,instance:i}),this.setState(()=>({streetViewPanorama:i}),this.setStreetViewPanoramaCallback)}componentDidUpdate(e){this.state.streetViewPanorama!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:zi,eventMap:Ui,prevProps:e,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),te(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}M(ml,"contextType",J);class fl extends o.PureComponent{constructor(){super(...arguments),M(this,"state",{streetViewService:null}),M(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var e=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:e}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}M(fl,"contextType",J);var Bi={onDirectionsChanged:"directions_changed"},$i={directions(t,e){t.setDirections(e)},map(t,e){t.setMap(e)},options(t,e){t.setOptions(e)},panel(t,e){t.setPanel(e)},routeIndex(t,e){t.setRouteIndex(e)}};class gl extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"state",{directionsRenderer:null}),M(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var e=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=ee({updaterMap:$i,eventMap:Bi,prevProps:{},nextProps:this.props,instance:e}),this.setState(function(){return{directionsRenderer:e}},this.setDirectionsRendererCallback)}componentDidUpdate(e){this.state.directionsRenderer!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:$i,eventMap:Bi,prevProps:e,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),te(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}M(gl,"contextType",J);var Wi={onPlacesChanged:"places_changed"},qi={bounds(t,e){t.setBounds(e)}};class hl extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"containerElement",o.createRef()),M(this,"state",{searchBox:null}),M(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(de(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var e=this.containerElement.current.querySelector("input");if(e!==null){var n=new google.maps.places.SearchBox(e,this.props.options);this.registeredEvents=ee({updaterMap:qi,eventMap:Wi,prevProps:{},nextProps:this.props,instance:n}),this.setState(function(){return{searchBox:n}},this.setSearchBoxCallback)}}}componentDidUpdate(e){this.state.searchBox!==null&&(te(this.registeredEvents),this.registeredEvents=ee({updaterMap:qi,eventMap:Wi,prevProps:e,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),te(this.registeredEvents))}render(){return l.jsx("div",{ref:this.containerElement,children:o.Children.only(this.props.children)})}}M(hl,"contextType",J);var Vi={onPlaceChanged:"place_changed"},Hi={bounds(t,e){t.setBounds(e)},restrictions(t,e){t.setComponentRestrictions(e)},fields(t,e){t.setFields(e)},options(t,e){t.setOptions(e)},types(t,e){t.setTypes(e)}};class Wa extends o.PureComponent{constructor(){super(...arguments),M(this,"registeredEvents",[]),M(this,"containerElement",o.createRef()),M(this,"state",{autocomplete:null}),M(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var e;de(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var n=(e=this.containerElement.current)===null||e===void 0?void 0:e.querySelector("input");if(n){var i=new google.maps.places.Autocomplete(n,this.props.options);this.registeredEvents=ee({updaterMap:Hi,eventMap:Vi,prevProps:{},nextProps:this.props,instance:i}),this.setState(()=>({autocomplete:i}),this.setAutocompleteCallback)}}componentDidUpdate(e){te(this.registeredEvents),this.registeredEvents=ee({updaterMap:Hi,eventMap:Vi,prevProps:e,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&te(this.registeredEvents)}render(){return l.jsx("div",{ref:this.containerElement,className:this.props.className,children:o.Children.only(this.props.children)})}}M(Wa,"defaultProps",{className:""});M(Wa,"contextType",J);const vl=["places"],dn=({location:t,onLocationChange:e,height:n="100%",className:i})=>{const{isLoaded:a}=Ho({id:"google-map-script",googleMapsApiKey:"AIzaSyAfp-MrsswDkw8NAgm5CYvpcKAG_Ia8c2w",libraries:vl,version:"weekly"}),[s,r]=Ie.useState(null),[c,p]=Ie.useState(null),m=Ie.useRef(null);return Ie.useEffect(()=>{if(a&&m.current&&!c){const g=new window.google.maps.places.SearchBox(m.current);p(g),g.addListener("places_changed",()=>{const x=g.getPlaces();if(!x||x.length===0)return;const u=x[0];!u.geometry||!u.geometry.location||(e({lat:u.geometry.location.lat(),lng:u.geometry.location.lng(),name:u.name||u.formatted_address||""}),s&&(s.panTo(u.geometry.location),s.setZoom(15)))})}return()=>{c&&window.google.maps.event.clearInstanceListeners(c)}},[a,c,s,e]),a?l.jsxs("div",{className:i,children:[l.jsx("div",{className:"relative",children:l.jsx("input",{ref:m,type:"text",placeholder:"Search for a location...",className:"ios-input w-full mb-2",defaultValue:t.name})}),l.jsx("div",{style:{height:n,width:"100%"},className:"rounded-apple overflow-hidden",children:l.jsx(No,{mapContainerStyle:{width:"100%",height:"100%"},center:t.lat&&t.lng?t:{lat:0,lng:0},zoom:t.lat&&t.lng?15:1,onClick:g=>{g.latLng&&e({lat:g.latLng.lat(),lng:g.latLng.lng(),name:t.name||`${g.latLng.lat()}, ${g.latLng.lng()}`})},onLoad:r,options:{mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1},children:t.lat&&t.lng&&l.jsx(Na,{position:t})})})]}):l.jsx("div",{className:"h-64 bg-apple-gray-100 rounded-apple flex items-center justify-center",children:l.jsx(Za,{className:"w-8 h-8 text-apple-gray-400 animate-spin"})})},xl=({eventId:t,onUploadComplete:e,onError:n})=>{const{user:i}=Tt(),[a,s]=o.useState([]),[r,c]=o.useState({mode:"grid",sortBy:"date"}),[p,m]=o.useState(""),[g,x]=o.useState(null),[u,f]=o.useState({}),[d,h]=o.useState(null),[b,L]=o.useState(""),[C,k]=o.useState(0),[v]=o.useState(10*1024*1024*1024),[y,E]=o.useState({eventName:"",venueName:"",location:{lat:0,lng:0,name:""},promoterName:"",date:new Date().toISOString().split("T")[0]}),[w,P]=o.useState(!1),[S,N]=o.useState([]),[D,_]=o.useState(null);o.useEffect(()=>{(async()=>{if(i)try{const{data:j,error:F}=await Je.getUserStorageUsage(i.id);!F&&j&&k(j.total_size)}catch(j){console.error("Error fetching storage usage:",j)}})()},[i]);const A=()=>y.eventName.trim()?y.venueName.trim()?y.promoterName.trim()?y.date?!0:(n?.("Date is required"),!1):(n?.("Promoter name is required"),!1):(n?.("Venue name is required"),!1):(n?.("Event name is required"),!1),T=o.useCallback(async O=>{const j=O.reduce((F,q)=>F+q.size,0);if(C+j>v){n?.("Upload would exceed your 10GB storage limit");return}N(O),P(!0)},[C,v,n]),I=async()=>{if(!A())return;const O={...u},j=[];S.forEach(F=>{const z=(F.webkitRelativePath||F.name).split("/");z.pop();let K=O;z.forEach(B=>{K[B]||(K[B]={name:B,files:[],subfolders:{}}),K=K[B].subfolders});const U={id:Math.random().toString(36).substring(7),file:F,progress:0,status:"pending",folderPath:z.length?z.join("/"):null};j.push(U)}),f(O),s(F=>[...F,...j]);for(const F of j)try{s(U=>U.map(B=>B.id===F.id?{...B,status:"uploading",progress:10}:B));const q=setInterval(()=>{s(U=>U.map(B=>B.id===F.id&&B.status==="uploading"&&B.progress<90?{...B,progress:B.progress+10}:B))},200),z={title:F.file.name,event_details:{name:y.eventName,date:y.date,promoter:y.promoterName},venue:{name:y.venueName},location:y.location.name?y.location:void 0,date_taken:y.date},K=await Je.uploadPhoto(F.file,t,F.folderPath,z);if(clearInterval(q),K.success){const U={...F,status:"complete",progress:100,photoId:K.photoId,photoDetails:K.photoMetadata};s(B=>B.map(se=>se.id===F.id?U:se)),e?.(K.photoId),k(B=>B+F.file.size)}else throw new Error(K.error)}catch(q){s(z=>z.map(K=>K.id===F.id?{...K,status:"error",error:q.message}:K)),n?.(q.message)}P(!1),N([])},{getRootProps:$,getInputProps:Y,isDragActive:Z}=Ma({onDrop:T,accept:{"image/jpeg":[".jpg",".jpeg"],"image/png":[".png"],"image/webp":[".webp"],"image/x-dcraw":[".raw"],"image/x-canon-cr2":[".cr2"],"image/x-nikon-nef":[".nef"],"image/x-sony-arw":[".arw"],"image/x-panasonic-rw2":[".rw2"]},maxSize:104857600,disabled:w,noClick:w,noKeyboard:w}),G=async(O,j)=>{try{await Je.renameFolder(O,j),s(q=>q.map(z=>{if(z.folderPath?.startsWith(O)){const K=z.folderPath.replace(O,j);return{...z,folderPath:K}}return z}));const F=(q,z,K)=>{if(z.length===0)return q;const[U,...B]=z,se={...q};return B.length===0?se[U]&&(se[K]={...se[U],name:K},delete se[U]):se[U]&&(se[U]={...se[U],subfolders:F(se[U].subfolders,B,K)}),se};f(q=>F(q,O.split("/"),j)),h(null),L("")}catch{n?.("Failed to rename folder")}},Q=a.filter(O=>p?O.file.name.toLowerCase().includes(p.toLowerCase()):g?O.folderPath===g:!0).sort((O,j)=>{switch(r.sortBy){case"name":return O.file.name.localeCompare(j.file.name);case"size":return j.file.size-O.file.size;case"date":default:return j.file.lastModified-O.file.lastModified}}),ie=O=>{const j=a.find(F=>F.id===O);j&&j.status==="complete"&&k(F=>F-j.file.size),s(F=>F.filter(q=>q.id!==O))},ne=(O,j="")=>Object.entries(O).map(([F,q])=>l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between p-2 bg-apple-gray-50 rounded-apple",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(Ya,{className:"w-4 h-4 text-apple-gray-400 mr-2"}),d===j+F?l.jsx("input",{type:"text",value:b,onChange:z=>L(z.target.value),onBlur:()=>{b&&b!==q.name?G(j+F,b):(h(null),L(""))},onKeyPress:z=>{z.key==="Enter"&&b&&b!==q.name&&G(j+F,b)},className:"px-2 py-1 rounded-apple text-sm",autoFocus:!0}):l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"text-sm font-medium",children:q.name}),l.jsx("button",{onClick:()=>{h(j+F),L(q.name)},className:"ml-2 text-apple-gray-400 hover:text-apple-gray-600",children:l.jsx(Xa,{className:"w-3 h-3"})})]})]}),l.jsxs("span",{className:"text-xs text-apple-gray-500",children:[q.files.length," files"]})]}),l.jsx("div",{className:"ml-4",children:ne(q.subfolders,j+F+"/")})]},j+F)),W=O=>O.photoDetails?l.jsx("div",{className:"mt-4 space-y-4",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium mb-2",children:"Photo Information"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[l.jsx(Re,{className:"w-4 h-4 text-apple-gray-500 mr-2"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium",children:"Date Taken"}),l.jsx("div",{className:"text-xs text-apple-gray-500",children:new Date(O.photoDetails.date_taken||O.photoDetails.created_at).toLocaleDateString()})]})]}),l.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[l.jsx(Ht,{className:"w-4 h-4 text-apple-gray-500 mr-2"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium",children:"Location"}),l.jsx("div",{className:"text-xs text-apple-gray-500",children:O.photoDetails.location?.name||"Unknown"})]})]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-medium mb-2",children:"Face Detection"}),l.jsx("div",{className:"space-y-2",children:O.photoDetails.matched_users?.length?O.photoDetails.matched_users.map((j,F)=>l.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[l.jsx(et,{className:"w-4 h-4 text-apple-gray-500 mr-2"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium",children:j.fullName}),l.jsxs("div",{className:"text-xs text-apple-gray-500",children:[Math.round(j.confidence),"% match"]})]})]},F)):l.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[l.jsx(pt,{className:"w-4 h-4 text-apple-gray-500 mr-2"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium",children:"No Matches Found"}),l.jsx("div",{className:"text-xs text-apple-gray-500",children:"No registered faces were detected"})]})]})})]})]})}):null;return l.jsxs("div",{className:"w-full",children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm font-medium text-apple-gray-700",children:"Storage Usage"}),l.jsxs("span",{className:"text-sm text-apple-gray-500",children:[(C/1024/1024/1024).toFixed(2),"GB of 10GB"]})]}),l.jsx("div",{className:"h-2 bg-apple-gray-100 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-apple-blue-500 transition-all duration-300",style:{width:`${C/v*100}%`}})})]}),l.jsx(Xe,{children:w&&l.jsxs(ge.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-8 p-6 bg-white rounded-apple-xl border border-apple-gray-200",children:[l.jsx("h3",{className:"text-lg font-medium text-apple-gray-900 mb-4",children:"Photo Details"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"ios-label flex items-center",children:[l.jsx(Re,{className:"w-4 h-4 mr-2"}),"Event Name*"]}),l.jsx("input",{type:"text",value:y.eventName,onChange:O=>E({...y,eventName:O.target.value}),className:"ios-input",placeholder:"Enter event name",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"ios-label flex items-center",children:[l.jsx(Yi,{className:"w-4 h-4 mr-2"}),"Venue Name*"]}),l.jsx("input",{type:"text",value:y.venueName,onChange:O=>E({...y,venueName:O.target.value}),className:"ios-input",placeholder:"Enter venue name",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"ios-label flex items-center",children:[l.jsx(et,{className:"w-4 h-4 mr-2"}),"Promoter Name*"]}),l.jsx("input",{type:"text",value:y.promoterName,onChange:O=>E({...y,promoterName:O.target.value}),className:"ios-input",placeholder:"Enter promoter name",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"ios-label flex items-center",children:[l.jsx(Re,{className:"w-4 h-4 mr-2"}),"Date*"]}),l.jsx("input",{type:"date",value:y.date,onChange:O=>E({...y,date:O.target.value}),className:"ios-input",required:!0})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsxs("label",{className:"ios-label flex items-center",children:[l.jsx(Ht,{className:"w-4 h-4 mr-2"}),"Location (optional)"]}),l.jsx(dn,{location:y.location,onLocationChange:O=>E({...y,location:O}),height:"300px",className:"rounded-apple overflow-hidden"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-4 mt-6",children:[l.jsx("button",{onClick:()=>{P(!1),N([])},className:"ios-button-secondary",children:"Cancel"}),l.jsx("button",{onClick:I,className:"ios-button-primary",children:"Continue Upload"})]})]})}),l.jsxs("div",{...$(),className:me("mt-4 p-10 border-2 border-dashed rounded-apple-xl text-center transition-colors duration-300",Z?"border-apple-blue-500 bg-apple-blue-50":"border-apple-gray-200 bg-apple-gray-50",a.length>0&&"mb-8"),children:[l.jsx("input",{...Y(),multiple:!0,type:"file",accept:"image/*",className:"hidden","aria-label":"Upload files"}),l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-white flex items-center justify-center",children:l.jsx(Et,{className:"w-8 h-8 text-apple-gray-500"})}),l.jsx("p",{className:"text-apple-gray-500 mb-2",children:Z?"Drop the photos or folders here":"Drag and drop photos or folders here, or click to select"}),l.jsx("p",{className:"text-apple-gray-400 text-sm",children:"Supported formats: JPG, PNG, WebP, RAW (CR2, NEF, ARW, RW2) ‚Ä¢ Max 100MB per file"})]}),a.length>0&&l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:()=>c(O=>({...O,mode:"grid"})),className:me("p-2 rounded-apple",r.mode==="grid"?"bg-apple-blue-500 text-white":"bg-apple-gray-100 text-apple-gray-600"),children:l.jsx(Ga,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>c(O=>({...O,mode:"list"})),className:me("p-2 rounded-apple",r.mode==="list"?"bg-apple-blue-500 text-white":"bg-apple-gray-100 text-apple-gray-600"),children:l.jsx(Ka,{className:"w-4 h-4"})}),l.jsx("div",{className:"h-6 w-px bg-apple-gray-200 mx-2"}),l.jsxs("div",{className:"relative",children:[l.jsx(Xi,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-apple-gray-400"}),l.jsx("input",{type:"text",placeholder:"Search uploads...",value:p,onChange:O=>m(O.target.value),className:"pl-9 pr-4 py-2 rounded-apple bg-apple-gray-100 text-sm focus:outline-none focus:ring-2 focus:ring-apple-blue-500"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("button",{className:"ios-button-secondary flex items-center",children:[l.jsx(Ji,{className:"w-4 h-4 mr-2"}),"Filter"]}),l.jsxs("select",{value:r.sortBy,onChange:O=>c(j=>({...j,sortBy:O.target.value})),className:"ios-input py-2 pl-4 pr-10",children:[l.jsx("option",{value:"date",children:"Sort by Date"}),l.jsx("option",{value:"name",children:"Sort by Name"}),l.jsx("option",{value:"size",children:"Sort by Size"})]})]})]}),Object.keys(u).length>0&&l.jsxs("div",{className:"mb-8",children:[l.jsx("h3",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Folders"}),ne(u)]}),l.jsx(Xe,{children:a.length>0&&l.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:me("grid gap-4",r.mode==="grid"?"grid-cols-1 md:grid-cols-3":"grid-cols-1"),children:Q.map(O=>l.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:me("bg-white rounded-apple shadow-sm border border-apple-gray-200",r.mode==="list"&&"flex items-center"),children:[l.jsxs("div",{className:me("relative",r.mode==="grid"?"aspect-square":"w-20 h-20"),children:[O.file.type.startsWith("image/")&&l.jsx("img",{src:URL.createObjectURL(O.file),alt:O.file.name,className:"w-full h-full object-cover rounded-tl-apple rounded-tr-apple"}),l.jsxs("div",{className:me("absolute inset-0 bg-black/50 flex items-center justify-center",O.status==="complete"&&"bg-apple-green-500/50",O.status==="error"&&"bg-apple-red-500/50"),children:[O.status==="uploading"&&l.jsx("div",{className:"w-8 h-8 border-2 border-white/30 border-t-white rounded-full animate-spin"}),O.status==="complete"&&l.jsx(Gi,{className:"w-8 h-8 text-white"}),O.status==="error"&&l.jsx(pt,{className:"w-8 h-8 text-white"})]})]}),l.jsxs("div",{className:"p-4 flex-1",children:[l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-apple-gray-900 truncate",children:O.file.name}),l.jsxs("p",{className:"text-sm text-apple-gray-500",children:[O.folderPath&&l.jsxs("span",{className:"text-apple-gray-400",children:[O.folderPath," /"]})," ",(O.file.size/1024/1024).toFixed(2)," MB"]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[O.status==="complete"&&l.jsx("button",{onClick:()=>_(O),className:"text-apple-gray-400 hover:text-apple-gray-600",children:l.jsx(Qi,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>ie(O.id),className:"text-apple-gray-400 hover:text-apple-gray-600",children:l.jsx(Lt,{className:"w-4 h-4"})})]})]}),O.status!=="complete"&&l.jsxs("div",{className:"mt-2",children:[l.jsx("div",{className:"h-1 bg-apple-gray-100 rounded-full overflow-hidden",children:l.jsx("div",{className:me("h-full transition-all duration-300",O.status==="error"?"bg-apple-red-500":"bg-apple-blue-500"),style:{width:`${O.progress}%`}})}),O.error&&l.jsx("p",{className:"mt-1 text-sm text-apple-red-500",children:O.error})]}),O.status==="complete"&&O.photoDetails&&l.jsx("div",{className:"mt-4",children:l.jsx("div",{className:"flex items-center space-x-2",children:O.photoDetails.matched_users?.length?l.jsxs("div",{className:"bg-apple-green-500 text-white px-2 py-1 rounded-full text-sm flex items-center",children:[l.jsx(Zt,{className:"w-4 h-4 mr-1"}),O.photoDetails.matched_users.length," ",O.photoDetails.matched_users.length===1?"Match":"Matches"]}):l.jsxs("div",{className:"bg-apple-gray-200 text-apple-gray-600 px-2 py-1 rounded-full text-sm flex items-center",children:[l.jsx(Zt,{className:"w-4 h-4 mr-1"}),"No Matches"]})})})]})]},O.id))})}),l.jsx(Xe,{children:D&&D.photoDetails&&l.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/75 backdrop-blur-sm flex items-center justify-center p-4",onClick:()=>_(null),children:l.jsx(ge.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"relative max-w-2xl w-full bg-white rounded-apple-2xl overflow-hidden",onClick:O=>O.stopPropagation(),children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Photo Details"}),l.jsx("button",{onClick:()=>_(null),className:"text-apple-gray-400 hover:text-apple-gray-600",children:l.jsx(Lt,{className:"w-5 h-5"})})]}),l.jsx("div",{className:"aspect-video rounded-apple-xl overflow-hidden mb-6",children:l.jsx("img",{src:URL.createObjectURL(D.file),alt:D.file.name,className:"w-full h-full object-cover"})}),W(D)]})})})})]})},yl=({photo:t,onClose:e,onShare:n})=>{const[i,a]=Ie.useState(!1),[s,r]=Ie.useState(!1),[c,p]=Ie.useState({width:0,height:0}),m=h=>{const b=h.target;p({width:b.naturalWidth,height:b.naturalHeight}),r(!0)},g=async()=>{try{a(!0);const h=await Je.downloadPhoto(t.id),b=document.createElement("a");b.href=h,b.download=`photo-${t.id}.jpg`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(h)}catch(h){console.error("Error downloading photo:",h)}finally{a(!1)}},x=()=>{if(!t.event_details)return null;const h=[{icon:l.jsx(Re,{className:"w-4 h-4"}),label:"Event Date",value:new Date(t.event_details.date||t.date_taken||t.created_at).toLocaleDateString()},{icon:l.jsx(ns,{className:"w-4 h-4"}),label:"Event Name",value:t.event_details.name||"Untitled Event"},{icon:l.jsx(Yi,{className:"w-4 h-4"}),label:"Venue",value:t.venue?.name||"Unknown Venue"},{icon:l.jsx(is,{className:"w-4 h-4"}),label:"Promoter",value:t.event_details.promoter||"Unknown"}];return l.jsxs("div",{className:"mb-6",children:[l.jsx("h4",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Event Information"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:h.map((b,L)=>l.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[l.jsx("div",{className:"mr-2 text-apple-gray-500",children:b.icon}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-apple-gray-900",children:b.label}),l.jsx("div",{className:"text-xs text-apple-gray-500",children:b.value})]})]},L))})]})},u=()=>{const h=[{icon:l.jsx(Re,{className:"w-4 h-4"}),label:"Date Taken",value:new Date(t.date_taken||t.created_at).toLocaleDateString()},{icon:l.jsx(as,{className:"w-4 h-4"}),label:"File Type",value:t.fileType},{icon:l.jsx(ss,{className:"w-4 h-4"}),label:"File Size",value:`${(t.fileSize/1024/1024).toFixed(2)} MB`},{icon:l.jsx(aa,{className:"w-4 h-4"}),label:"Uploaded",value:new Date(t.created_at).toLocaleString()},{icon:l.jsx(sa,{className:"w-4 h-4"}),label:"Dimensions",value:`${c.width} √ó ${c.height}`},{icon:l.jsx(Et,{className:"w-4 h-4"}),label:"Uploaded By",value:t.uploadedBy||"Unknown"}];return t.location?.name&&h.push({icon:l.jsx(os,{className:"w-4 h-4"}),label:"Location",value:t.location.name}),t.tags?.length&&h.push({icon:l.jsx(oa,{className:"w-4 h-4"}),label:"Tags",value:t.tags.join(", ")}),l.jsxs("div",{className:"mb-6",children:[l.jsx("h4",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Photo Information"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:h.map((b,L)=>l.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[l.jsx("div",{className:"mr-2 text-apple-gray-500",children:b.icon}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-apple-gray-900",children:b.label}),l.jsx("div",{className:"text-xs text-apple-gray-500",children:b.value})]})]},L))}),t.location?.lat&&t.location?.lng&&l.jsxs("div",{className:"mt-4",children:[l.jsx("h4",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Location"}),l.jsx("div",{className:"h-48 rounded-apple overflow-hidden",children:l.jsx(dn,{location:{lat:t.location.lat,lng:t.location.lng,name:t.location.name||""},onLocationChange:()=>{},height:"100%",className:"w-full"})})]})]})},f=()=>{if(!t.faces?.length)return null;const h=t.faces[0];if(!h.attributes)return null;const b=h.attributes.emotions?.reduce((C,k)=>k.confidence>C.confidence?k:C),L=[{icon:l.jsx(Gt,{className:"w-4 h-4"}),label:"Expression",value:h.attributes.smile?.value?"Smiling":"Not Smiling",confidence:h.attributes.smile?.confidence},{icon:l.jsx(na,{className:"w-4 h-4"}),label:"Eyes",value:h.attributes.eyesOpen?.value?"Open":"Closed",confidence:h.attributes.eyesOpen?.confidence},{icon:l.jsx(Ja,{className:"w-4 h-4"}),label:"Eyewear",value:h.attributes.sunglasses?.value?"Sunglasses":h.attributes.eyeglasses?.value?"Glasses":"None",confidence:h.attributes.sunglasses?.value?h.attributes.sunglasses?.confidence:h.attributes.eyeglasses?.confidence},{icon:l.jsx(ia,{className:"w-4 h-4"}),label:"Age Range",value:`${h.attributes.age?.low}-${h.attributes.age?.high} years`,confidence:100},{icon:l.jsx(et,{className:"w-4 h-4"}),label:"Gender",value:h.attributes.gender?.value,confidence:h.attributes.gender?.confidence},{icon:l.jsx(Qa,{className:"w-4 h-4"}),label:"Emotion",value:b?.type||"Neutral",confidence:b?.confidence},{icon:l.jsx(es,{className:"w-4 h-4"}),label:"Facial Hair",value:h.attributes.beard?.value?"Beard":h.attributes.mustache?.value?"Mustache":"None",confidence:h.attributes.beard?.value?h.attributes.beard?.confidence:h.attributes.mustache?.confidence},{icon:l.jsx(ts,{className:"w-4 h-4"}),label:"Quality",value:`${Math.round(h.attributes.quality?.brightness||0)}% Brightness, ${Math.round(h.attributes.quality?.sharpness||0)}% Sharpness`,confidence:100}];return l.jsxs("div",{className:"mb-6",children:[l.jsx("h4",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Face Analysis"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:L.map((C,k)=>l.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[l.jsx("div",{className:"mr-2 text-apple-gray-500",children:C.icon}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-apple-gray-900",children:C.label}),l.jsxs("div",{className:"text-xs text-apple-gray-500",children:[C.value," (",Math.round(C.confidence||0),"% confidence)"]})]})]},k))})]})},d=()=>t.matched_users?.length?l.jsxs("div",{className:"mb-6",children:[l.jsx("h4",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Matched People"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:t.matched_users.map(h=>l.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-apple bg-apple-gray-50",children:[h.avatarUrl?l.jsx("img",{src:h.avatarUrl,alt:h.fullName,className:"w-8 h-8 rounded-full"}):l.jsx("div",{className:"w-8 h-8 rounded-full bg-apple-blue-100 text-apple-blue-500 flex items-center justify-center",children:l.jsx(et,{className:"w-4 h-4"})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium",children:h.fullName}),l.jsxs("div",{className:"text-xs text-apple-gray-500",children:[Math.round(h.confidence),"% match"]})]})]},h.userId))})]}):l.jsxs("div",{className:"mb-6 p-4 bg-apple-gray-50 rounded-apple text-center",children:[l.jsx(sn,{className:"w-8 h-8 text-apple-gray-400 mx-auto mb-2"}),l.jsx("p",{className:"text-apple-gray-600 font-medium",children:"No Matches Found"}),l.jsx("p",{className:"text-apple-gray-500 text-sm mt-1",children:"No registered faces were detected in this photo"})]});return l.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/75 backdrop-blur-sm flex items-center justify-center p-4",onClick:e,children:l.jsx(ge.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"relative w-full max-w-5xl bg-white rounded-apple-2xl overflow-hidden",onClick:h=>h.stopPropagation(),children:l.jsxs("div",{className:"flex flex-col md:flex-row h-[85vh]",children:[l.jsx("div",{className:"w-full md:w-3/5 h-full relative",children:l.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-apple-gray-100",children:l.jsxs("div",{className:"relative w-full h-full",children:[l.jsx("img",{src:t.url,alt:t.title||"Photo",className:me("absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2","max-w-[95%] max-h-[95%] w-auto h-auto object-contain",!s&&"opacity-0"),onLoad:m}),!s&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-apple-gray-900"})})]})})}),l.jsxs("div",{className:"w-full md:w-2/5 h-full flex flex-col",children:[l.jsxs("div",{className:"p-6 flex-1 overflow-y-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Photo Details"}),l.jsx("button",{onClick:e,className:"absolute top-2 right-2 p-2 rounded-full bg-apple-white hover:bg-apple-gray-100 text-apple-gray-500 transition-colors","aria-label":"Close modal",children:l.jsx(Lt,{className:"w-5 h-5"})})]}),(t.title||t.description)&&l.jsxs("div",{className:"mb-6",children:[t.title&&l.jsx("h3",{className:"text-lg font-medium mb-1",children:t.title}),t.description&&l.jsx("p",{className:"text-apple-gray-600 text-sm",children:t.description})]}),f(),x(),u(),d()]}),l.jsx("div",{className:"p-4 border-t border-apple-gray-200 bg-white",children:l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsxs("button",{onClick:g,disabled:i,className:"ios-button-secondary flex items-center",children:[l.jsx(ea,{className:"w-5 h-5 mr-2"}),"Download"]}),n&&l.jsxs("button",{onClick:()=>n(t.id),className:"ios-button-primary flex items-center",children:[l.jsx(ta,{className:"w-5 h-5 mr-2"}),"Share"]})]})})]})]})})})},bl=({photos:t,onDelete:e,onShare:n,onDownload:i})=>{const[a,s]=o.useState(null),[r,c]=o.useState({}),p=async m=>{if(i){try{c({...r,[m.id]:!0}),await i(m.id)}catch(g){console.error("Error downloading photo:",g)}finally{c({...r,[m.id]:!1})}return}try{c({...r,[m.id]:!0});const g=await Je.downloadPhoto(m.id),x=document.createElement("a");x.href=g,x.download=`photo-${m.id}.jpg`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(g)}catch(g){console.error("Error downloading photo:",g)}finally{c({...r,[m.id]:!1})}};return t.length===0?l.jsxs("div",{className:"text-center py-12 bg-apple-gray-50 rounded-apple-xl border-2 border-dashed border-apple-gray-200",children:[l.jsx(sn,{className:"w-12 h-12 text-apple-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-apple-gray-500 font-medium",children:"No photos found"}),l.jsx("p",{className:"text-apple-gray-400 text-sm mt-1",children:t.length===0?"No photos have been uploaded yet":"No matches found in any photos"})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:t.map(m=>l.jsxs(ge.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"relative group",children:[l.jsx("div",{className:"aspect-square rounded-apple-xl overflow-hidden",children:l.jsx("img",{src:m.url,alt:m.title||`Photo ${m.id}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"})}),m.faces&&l.jsxs("div",{className:me("absolute top-2 right-2 px-2 py-1 rounded-full text-sm flex items-center gap-1",m.matched_users?.length?"bg-apple-green-500 text-white":"bg-apple-gray-200 text-apple-gray-600"),children:[l.jsx(Zt,{className:"w-4 h-4"}),m.matched_users?.length||"No"," ",m.matched_users?.length===1?"Match":"Matches"]}),l.jsx("div",{className:"absolute inset-0 bg-black/50 rounded-apple-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:l.jsxs("div",{className:"absolute bottom-0 inset-x-0 p-4 flex justify-between items-center",children:[l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>p(m),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors duration-300",disabled:r[m.id],"aria-label":"Download photo",children:l.jsx(ea,{className:"w-5 h-5"})}),n&&l.jsx("button",{onClick:()=>n(m.id),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors duration-300","aria-label":"Share photo",children:l.jsx(ta,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>s(m),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors duration-300","aria-label":"View photo details",children:l.jsx(Qi,{className:"w-5 h-5"})})]}),e&&l.jsx("button",{onClick:()=>e(m.id),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors duration-300","aria-label":"Delete photo",children:l.jsx(rs,{className:"w-5 h-5"})})]})})]},m.id))}),l.jsx(Xe,{children:a&&l.jsx(yl,{photo:a,onClose:()=>s(null)})})]})},Zi=({eventId:t,mode:e="upload"})=>{const[n,i]=o.useState([]),[a,s]=o.useState(!0),[r,c]=o.useState(null),[p,m]=o.useState(!1),[g,x]=o.useState(""),[u,f]=o.useState({dateRange:{start:"",end:""},location:{lat:0,lng:0,name:""},tags:[],timeRange:{start:"",end:""}}),{user:d}=Tt();o.useEffect(()=>{if(!d)return;console.log("Setting up realtime subscription for photo matches...");const v=V.channel("photo-matches").on("postgres_changes",{event:"UPDATE",schema:"public",table:"photos",filter:e==="matches"?`matched_users::jsonb @> '[{"userId": "${d.id}"}]'`:`uploaded_by=eq.${d.id}`},y=>{console.log("Received realtime update:",y),h()}).subscribe();return()=>{console.log("Cleaning up realtime subscription"),v.unsubscribe()}},[d,e]);const h=async()=>{try{if(s(!0),c(null),!d)return;console.log("Fetching photos...");let v=V.from("photos").select("*");if(u.dateRange.start&&(v=v.gte("date_taken",u.dateRange.start)),u.dateRange.end&&(v=v.lte("date_taken",u.dateRange.end)),u.location.name&&(v=v.textSearch("location->>name",u.location.name)),u.tags.length>0&&(v=v.contains("tags",u.tags)),g&&(v=v.textSearch("search_vector",g)),e==="upload")console.log("Fetching uploaded photos"),v=v.eq("uploaded_by",d.id);else{console.log("Fetching matched photos"),console.log(`Looking for photos matching user ID: ${d.id}`);const P=JSON.stringify([{userId:d.id}]);console.log("Using filter payload:",P),v=v.filter("matched_users","cs",P)}v=v.order("created_at",{ascending:!1});const{data:y,error:E}=await v;if(E)throw E;console.log(`Fetched ${y?.length||0} photos`),y&&y.length>0&&console.log("First photo structure:",y[0]);const w=(y||[]).map(P=>({id:P.id,url:P.url||P.public_url,eventId:P.event_id||P.eventId,uploadedBy:P.uploaded_by||P.uploadedBy,created_at:P.created_at||P.createdAt||new Date().toISOString(),updated_at:P.updated_at||P.updatedAt,folderPath:P.folder_path||P.folderPath,folderName:P.folder_name||P.folderName,fileSize:P.file_size||P.fileSize,fileType:P.file_type||P.fileType,faces:P.faces||[],title:P.title,description:P.description,location:P.location,venue:P.venue,tags:P.tags,date_taken:P.date_taken||P.dateTaken,event_details:P.event_details||P.eventDetails,matched_users:P.matched_users||P.matchedUsers}));i(w)}catch(v){console.error("Error fetching photos:",v),c("Failed to load photos. Please try again.")}finally{s(!1)}};o.useEffect(()=>{d&&h()},[d,t,e,u,g]);const b=async v=>{await h()},L=async v=>{try{await Je.deletePhoto(v),i(n.filter(y=>y.id!==v))}catch(y){console.error("Error deleting photo:",y),c("Failed to delete photo. Please try again.")}},C=async v=>{console.log("Share photo:",v)},k=()=>{f({dateRange:{start:"",end:""},location:{lat:0,lng:0,name:""},tags:[],timeRange:{start:"",end:""}}),x("")};return a?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx(ls,{className:"w-8 h-8 text-apple-gray-400 animate-spin"})}):l.jsxs("div",{children:[r&&l.jsxs("div",{className:"mb-6 p-4 bg-red-50 text-red-600 rounded-apple flex items-center",children:[l.jsx(pt,{className:"w-5 h-5 mr-2"}),r]}),e==="upload"&&l.jsx(xl,{eventId:t,onUploadComplete:b,onError:v=>c(v)}),l.jsxs("div",{className:"mt-8 mb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"relative flex-1 max-w-lg",children:[l.jsx(Xi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-apple-gray-400 w-5 h-5"}),l.jsx("input",{type:"text",placeholder:"Search photos...",value:g,onChange:v=>x(v.target.value),className:"w-full pl-10 pr-4 py-2 ios-input"})]}),l.jsxs("button",{onClick:()=>m(!p),className:me("ios-button-secondary ml-4 flex items-center",p&&"bg-apple-blue-500 text-white hover:bg-apple-blue-600"),children:[l.jsx(Ji,{className:"w-4 h-4 mr-2"}),"Filters",l.jsx(ra,{className:me("w-4 h-4 ml-2 transition-transform duration-200",p&&"transform rotate-180")})]})]}),l.jsx(Xe,{children:p&&l.jsx(ge.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:l.jsxs("div",{className:"p-4 bg-white rounded-apple-xl border border-apple-gray-200 mb-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"ios-label flex items-center",children:[l.jsx(Re,{className:"w-4 h-4 mr-2"}),"Date Range"]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("input",{type:"date",value:u.dateRange.start,onChange:v=>f({...u,dateRange:{...u.dateRange,start:v.target.value}}),className:"ios-input"}),l.jsx("input",{type:"date",value:u.dateRange.end,onChange:v=>f({...u,dateRange:{...u.dateRange,end:v.target.value}}),className:"ios-input"})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"ios-label flex items-center",children:[l.jsx(Ht,{className:"w-4 h-4 mr-2"}),"Location"]}),l.jsx(dn,{location:u.location,onLocationChange:v=>f({...u,location:v}),height:"200px",className:"rounded-apple overflow-hidden"})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"ios-label flex items-center",children:[l.jsx(oa,{className:"w-4 h-4 mr-2"}),"Tags"]}),l.jsx("input",{type:"text",placeholder:"Add tags...",onKeyDown:v=>{v.key==="Enter"&&v.currentTarget.value&&(f({...u,tags:[...u.tags,v.currentTarget.value]}),v.currentTarget.value="")},className:"ios-input"}),u.tags.length>0&&l.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:u.tags.map((v,y)=>l.jsxs("span",{className:"bg-apple-blue-100 text-apple-blue-700 px-2 py-1 rounded-full text-sm flex items-center",children:[v,l.jsx("button",{onClick:()=>f({...u,tags:u.tags.filter((E,w)=>w!==y)}),className:"ml-1 hover:text-apple-blue-900",children:"√ó"})]},y))})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"ios-label flex items-center",children:[l.jsx(aa,{className:"w-4 h-4 mr-2"}),"Time Range"]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("input",{type:"time",value:u.timeRange.start,onChange:v=>f({...u,timeRange:{...u.timeRange,start:v.target.value}}),className:"ios-input"}),l.jsx("input",{type:"time",value:u.timeRange.end,onChange:v=>f({...u,timeRange:{...u.timeRange,end:v.target.value}}),className:"ios-input"})]})]})]}),l.jsx("div",{className:"flex justify-end mt-4",children:l.jsx("button",{onClick:k,className:"ios-button-secondary",children:"Clear Filters"})})]})})})]}),l.jsx(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:n.length>0?l.jsx(bl,{photos:n,onDelete:e==="upload"?L:void 0,onShare:C}):l.jsx("div",{className:"text-center py-12 bg-apple-gray-50 rounded-apple-xl border-2 border-dashed border-apple-gray-200",children:l.jsx("p",{className:"text-apple-gray-500",children:e==="upload"?"No photos uploaded yet":"No photos found with your face"})})})]})},jl=()=>{const{user:t,signOut:e}=Tt(),[n,i]=o.useState(!1),[a,s]=o.useState("home"),[r,c]=o.useState(!1),[p,m]=o.useState(!1),[g,x]=o.useState(null),[u,f]=o.useState(null);o.useEffect(()=>{(async()=>{if(t)try{const{data:C,error:k}=await V.from("face_data").select("face_data").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(k){if(!k.message.includes("JSON object requested, multiple (or no) rows returned"))throw k;c(!1),x(null),f(null);return}if(C){c(!0),f(C.face_data.attributes||null);const{data:{publicUrl:v}}=V.storage.from("face-data").getPublicUrl(C.face_data.image_path);x(v)}else c(!1),x(null),f(null)}catch(C){console.error("Error fetching face data:",C),c(!1),x(null),f(null)}})()},[t]);const d=()=>{c(!0),m(!1),t&&V.from("face_data").select("face_data").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(1).maybeSingle().then(({data:L,error:C})=>{if(!C&&L){f(L.face_data.attributes||null);const{data:{publicUrl:k}}=V.storage.from("face-data").getPublicUrl(L.face_data.image_path);x(k)}})},h=()=>{if(!u)return null;const L=u.emotions&&u.emotions.length>0?u.emotions.reduce((k,v)=>k.confidence>v.confidence?k:v):null,C=[{icon:l.jsx(Gt,{className:"w-4 h-4"}),label:"Smile",value:u.smile?.value?"Yes":"No",confidence:u.smile?.confidence||0},{icon:l.jsx(na,{className:"w-4 h-4"}),label:"Eyes Open",value:u.eyesOpen?.value?"Yes":"No",confidence:u.eyesOpen?.confidence||0},{icon:l.jsx(ia,{className:"w-4 h-4"}),label:"Age Range",value:`${u.age?.low||0}-${u.age?.high||0}`,confidence:100},{icon:l.jsx(Gt,{className:"w-4 h-4"}),label:"Emotion",value:L?L.type:"None",confidence:L?L.confidence:0},{icon:l.jsx(et,{className:"w-4 h-4"}),label:"Gender",value:u.gender?.value||"Unknown",confidence:u.gender?.confidence||0}];return l.jsxs("div",{className:"mt-4 space-y-2",children:[l.jsx("h4",{className:"text-sm font-medium text-apple-gray-700",children:"Face Attributes"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:C.map((k,v)=>l.jsxs("div",{className:"flex items-center p-2 bg-apple-gray-50 rounded-apple",children:[l.jsx("div",{className:"mr-2 text-apple-gray-500",children:k.icon}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm font-medium text-apple-gray-900",children:k.label}),l.jsxs("div",{className:"text-xs text-apple-gray-500",children:[k.value," (",Math.round(k.confidence),"% confidence)"]})]})]},v))})]})},b=()=>{switch(a){case"upload":return l.jsxs("div",{className:"bg-white rounded-apple-2xl shadow-apple p-8 border border-apple-gray-100",children:[l.jsx("div",{className:"flex items-center mb-6",children:l.jsxs("h2",{className:"text-xl font-semibold text-apple-gray-900 flex items-center",children:[l.jsx(Et,{className:"w-5 h-5 mr-2 text-apple-blue-500"}),"Upload Photos"]})}),l.jsx("p",{className:"text-apple-gray-600 mb-6 border-l-4 border-apple-blue-500 pl-4 py-2 bg-apple-blue-50 rounded-r-apple",children:"Upload photos to be indexed for facial recognition. Other users will be able to find photos they appear in."}),l.jsx(Zi,{mode:"upload"})]});case"photos":return l.jsxs("div",{className:"bg-white rounded-apple-2xl shadow-apple p-8 border border-apple-gray-100",children:[l.jsx("div",{className:"flex items-center justify-between mb-6",children:l.jsxs("h2",{className:"text-xl font-semibold text-apple-gray-900 flex items-center",children:[l.jsx(ds,{className:"w-5 h-5 mr-2 text-apple-blue-500"}),"My Photos"]})}),l.jsx("p",{className:"text-apple-gray-600 mb-6 border-l-4 border-apple-blue-500 pl-4 py-2 bg-apple-blue-50 rounded-r-apple",children:"Photos where you have been identified through facial recognition."}),l.jsx(Zi,{mode:"matches"})]});case"events":return l.jsxs("div",{className:"bg-white rounded-apple-2xl shadow-apple p-8 border border-apple-gray-100",children:[l.jsx("div",{className:"flex items-center justify-between mb-6",children:l.jsxs("h2",{className:"text-xl font-semibold text-apple-gray-900 flex items-center",children:[l.jsx(Re,{className:"w-5 h-5 mr-2 text-apple-blue-500"}),"Events"]})}),l.jsx("p",{className:"text-apple-gray-500",children:"No events found."})]});default:return l.jsxs(l.Fragment,{children:[l.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"lg:col-span-2 bg-white rounded-apple-2xl shadow-apple p-8 border border-apple-gray-100",children:[l.jsxs("div",{className:"flex items-center mb-6",children:[l.jsx("div",{className:"w-12 h-12 rounded-full bg-apple-blue-100 text-apple-blue-700 flex items-center justify-center mr-4 text-xl font-semibold",children:(t?.user_metadata?.full_name?.charAt(0)||t?.email?.charAt(0)||"U").toUpperCase()}),l.jsxs("div",{children:[l.jsxs("h1",{className:"text-2xl font-semibold text-apple-gray-900",children:["Welcome back",t?.user_metadata?.full_name?`, ${t.user_metadata.full_name}`:""]}),l.jsx("p",{className:"text-apple-gray-500",children:r?"Your face is registered":"Complete your profile by registering your face"})]})]}),l.jsx("p",{className:"text-apple-gray-600 mb-6 border-l-4 border-apple-blue-500 pl-4 py-2 bg-apple-blue-50 rounded-r-apple",children:r?"Your face has been registered. You can now use the facial recognition feature for quick authentication.":"Get started by registering your face to enable quick authentication and find your photos at events."}),g&&l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-sm font-medium text-apple-gray-700 mb-2",children:"Your Registered Face"}),l.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[l.jsx("div",{className:"relative w-full max-w-xs aspect-square rounded-apple-xl overflow-hidden border border-apple-gray-200",children:l.jsx("img",{src:g,alt:"Registered face",className:"w-full h-full object-contain"})}),h()]})]}),l.jsxs("button",{onClick:()=>m(!0),className:"ios-button-primary flex items-center",children:[l.jsx(Ki,{className:"w-5 h-5 mr-2"}),r?"Re-Register Face":"Register Your Face"]})]}),l.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"bg-white rounded-apple-2xl shadow-apple p-8 border border-apple-gray-100",children:[l.jsxs("h2",{className:"text-lg font-medium text-apple-gray-900 mb-6 flex items-center",children:[l.jsx(ps,{className:"w-5 h-5 mr-2 text-apple-blue-500"}),"Face Recognition Status"]}),l.jsxs("div",{className:"flex items-center p-4 bg-apple-gray-50 rounded-apple mb-4 border border-apple-gray-200",children:[l.jsx("div",{className:`w-3 h-3 rounded-full mr-3 ${r?"bg-apple-green-500":"bg-amber-500"}`}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-apple-gray-900",children:r?"Registered":"Not Registered"}),l.jsx("p",{className:"text-xs text-apple-gray-500 mt-1",children:r?"Last updated: Today":"Register to enhance security"})]})]}),l.jsxs("div",{className:"mt-6",children:[l.jsx("h3",{className:"text-sm font-medium text-apple-gray-900 mb-2",children:"Privacy information"}),l.jsxs("div",{className:"flex items-start text-xs text-apple-gray-600",children:[l.jsx(sn,{className:"w-4 h-4 mr-2 text-apple-gray-400 flex-shrink-0 mt-0.5"}),l.jsx("p",{children:"Your face data is encrypted and stored securely. We never share your biometric data with third parties."})]})]})]})]})}};return l.jsxs("div",{className:"min-h-screen bg-apple-gray-50 font-sans",children:[l.jsx("header",{className:"backdrop-navbar sticky top-0 z-40 pt-ios-safe",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between h-16 items-center",children:[l.jsx("div",{className:"font-bold text-xl",children:l.jsx("img",{src:"https://www.shmong.tv/wp-content/uploads/2023/05/main-logo.png",alt:"SHMONG.tv",className:"h-8"})}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>i(!n),className:"flex items-center space-x-2 text-sm text-apple-gray-700 bg-apple-gray-100 px-3 py-2 rounded-apple hover:bg-apple-gray-200 transition-all duration-300",children:[l.jsx("div",{className:"w-8 h-8 rounded-full bg-apple-blue-100 text-apple-blue-700 flex items-center justify-center",children:t?.email?.charAt(0).toUpperCase()}),l.jsx("span",{className:"hidden md:inline font-medium",children:t?.email}),l.jsx(ra,{className:"h-4 w-4 text-apple-gray-500"})]}),n&&l.jsxs(ge.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2},className:"absolute right-0 mt-2 w-56 bg-white rounded-apple-xl shadow-apple-lg py-2 z-10 border border-apple-gray-100",children:[l.jsxs("div",{className:"px-4 py-2 border-b border-apple-gray-100",children:[l.jsx("p",{className:"text-sm font-medium text-apple-gray-900",children:t?.user_metadata?.full_name||"User"}),l.jsx("p",{className:"text-xs text-apple-gray-500 truncate",children:t?.email})]}),l.jsxs("button",{onClick:()=>e(),className:"flex items-center w-full text-left px-4 py-2 text-sm text-apple-red-500 hover:bg-apple-gray-50",children:[l.jsx(cs,{className:"w-4 h-4 mr-2"}),"Sign out"]})]})]})]})})}),l.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-ios-safe",children:[l.jsx("div",{className:"flex overflow-x-auto mb-8 pb-2 no-scrollbar",children:l.jsx("nav",{className:"flex space-x-2 mx-auto bg-apple-gray-200 p-1 rounded-full",children:[{id:"home",name:"Home",icon:l.jsx(et,{className:"w-4 h-4"})},{id:"upload",name:"Upload",icon:l.jsx(Et,{className:"w-4 h-4"})},{id:"photos",name:"My Photos",icon:l.jsx(sa,{className:"w-4 h-4"})},{id:"events",name:"Events",icon:l.jsx(Re,{className:"w-4 h-4"})}].map(L=>l.jsxs("button",{onClick:()=>s(L.id),className:me("flex items-center px-4 py-2 text-sm font-medium rounded-full whitespace-nowrap transition-all duration-300",a===L.id?"bg-white text-apple-gray-900 shadow-apple-button":"text-apple-gray-600 hover:text-apple-gray-900"),children:[L.icon,l.jsx("span",{className:"ml-2",children:L.name})]},L.id))})}),l.jsx("div",{className:me("grid gap-8",a==="home"?"grid-cols-1 lg:grid-cols-3":"grid-cols-1"),children:b()})]}),l.jsx(Xe,{children:p&&l.jsx(Es,{onSuccess:d,onClose:()=>m(!1)})})]})};export{jl as Dashboard,jl as default};
//# sourceMappingURL=Dashboard-kjILCAtD.js.map
